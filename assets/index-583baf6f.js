(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function zm(t,e){const n=Object.create(null),i=t.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const nt={},Io=[],ni=()=>{},gR=()=>!1,vR=/^on[^a-z]/,Fh=t=>vR.test(t),jm=t=>t.startsWith("onUpdate:"),Ct=Object.assign,Hm=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},yR=Object.prototype.hasOwnProperty,Fe=(t,e)=>yR.call(t,e),ve=Array.isArray,To=t=>Bh(t)==="[object Map]",sE=t=>Bh(t)==="[object Set]",Se=t=>typeof t=="function",bt=t=>typeof t=="string",Km=t=>typeof t=="symbol",ct=t=>t!==null&&typeof t=="object",oE=t=>ct(t)&&Se(t.then)&&Se(t.catch),aE=Object.prototype.toString,Bh=t=>aE.call(t),_R=t=>Bh(t).slice(8,-1),lE=t=>Bh(t)==="[object Object]",Wm=t=>bt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Eu=zm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),$h=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},wR=/-(\w)/g,xi=$h(t=>t.replace(wR,(e,n)=>n?n.toUpperCase():"")),bR=/\B([A-Z])/g,js=$h(t=>t.replace(bR,"-$1").toLowerCase()),qh=$h(t=>t.charAt(0).toUpperCase()+t.slice(1)),tf=$h(t=>t?`on${qh(t)}`:""),yl=(t,e)=>!Object.is(t,e),nf=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},qu=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},ER=t=>{const e=parseFloat(t);return isNaN(e)?t:e},IR=t=>{const e=bt(t)?Number(t):NaN;return isNaN(e)?t:e};let Py;const op=()=>Py||(Py=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Gm(t){if(ve(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=bt(i)?kR(i):Gm(i);if(r)for(const s in r)e[s]=r[s]}return e}else{if(bt(t))return t;if(ct(t))return t}}const TR=/;(?![^(]*\))/g,SR=/:([^]+)/,CR=/\/\*[^]*?\*\//g;function kR(t){const e={};return t.replace(CR,"").split(TR).forEach(n=>{if(n){const i=n.split(SR);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Uh(t){let e="";if(bt(t))e=t;else if(ve(t))for(let n=0;n<t.length;n++){const i=Uh(t[n]);i&&(e+=i+" ")}else if(ct(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const xR="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AR=zm(xR);function cE(t){return!!t||t===""}const el=t=>bt(t)?t:t==null?"":ve(t)||ct(t)&&(t.toString===aE||!Se(t.toString))?JSON.stringify(t,uE,2):String(t),uE=(t,e)=>e&&e.__v_isRef?uE(t,e.value):To(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:sE(e)?{[`Set(${e.size})`]:[...e.values()]}:ct(e)&&!ve(e)&&!lE(e)?String(e):e;let kn;class hE{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=kn,!e&&kn&&(this.index=(kn.scopes||(kn.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=kn;try{return kn=this,e()}finally{kn=n}}}on(){kn=this}off(){kn=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function RR(t){return new hE(t)}function NR(t,e=kn){e&&e.active&&e.effects.push(t)}function dE(){return kn}function DR(t){kn&&kn.cleanups.push(t)}const Qm=t=>{const e=new Set(t);return e.w=0,e.n=0,e},fE=t=>(t.w&Ir)>0,pE=t=>(t.n&Ir)>0,OR=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Ir},PR=t=>{const{deps:e}=t;if(e.length){let n=0;for(let i=0;i<e.length;i++){const r=e[i];fE(r)&&!pE(r)?r.delete(t):e[n++]=r,r.w&=~Ir,r.n&=~Ir}e.length=n}},ap=new WeakMap;let ja=0,Ir=1;const lp=30;let Yn;const gs=Symbol(""),cp=Symbol("");class Ym{constructor(e,n=null,i){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,NR(this,i)}run(){if(!this.active)return this.fn();let e=Yn,n=vr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Yn,Yn=this,vr=!0,Ir=1<<++ja,ja<=lp?OR(this):My(this),this.fn()}finally{ja<=lp&&PR(this),Ir=1<<--ja,Yn=this.parent,vr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Yn===this?this.deferStop=!0:this.active&&(My(this),this.onStop&&this.onStop(),this.active=!1)}}function My(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let vr=!0;const mE=[];function aa(){mE.push(vr),vr=!1}function la(){const t=mE.pop();vr=t===void 0?!0:t}function Tn(t,e,n){if(vr&&Yn){let i=ap.get(t);i||ap.set(t,i=new Map);let r=i.get(n);r||i.set(n,r=Qm()),gE(r)}}function gE(t,e){let n=!1;ja<=lp?pE(t)||(t.n|=Ir,n=!fE(t)):n=!t.has(Yn),n&&(t.add(Yn),Yn.deps.push(t))}function ji(t,e,n,i,r,s){const o=ap.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ve(t)){const l=Number(i);o.forEach((c,u)=>{(u==="length"||u>=l)&&a.push(c)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ve(t)?Wm(n)&&a.push(o.get("length")):(a.push(o.get(gs)),To(t)&&a.push(o.get(cp)));break;case"delete":ve(t)||(a.push(o.get(gs)),To(t)&&a.push(o.get(cp)));break;case"set":To(t)&&a.push(o.get(gs));break}if(a.length===1)a[0]&&up(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);up(Qm(l))}}function up(t,e){const n=ve(t)?t:[...t];for(const i of n)i.computed&&Ly(i);for(const i of n)i.computed||Ly(i)}function Ly(t,e){(t!==Yn||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const MR=zm("__proto__,__v_isRef,__isVue"),vE=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Km)),LR=Xm(),FR=Xm(!1,!0),BR=Xm(!0),Fy=$R();function $R(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const i=Ue(this);for(let s=0,o=this.length;s<o;s++)Tn(i,"get",s+"");const r=i[e](...n);return r===-1||r===!1?i[e](...n.map(Ue)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){aa();const i=Ue(this)[e].apply(this,n);return la(),i}}),t}function qR(t){const e=Ue(this);return Tn(e,"has",t),e.hasOwnProperty(t)}function Xm(t=!1,e=!1){return function(i,r,s){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&s===(t?e?n1:EE:e?bE:wE).get(i))return i;const o=ve(i);if(!t){if(o&&Fe(Fy,r))return Reflect.get(Fy,r,s);if(r==="hasOwnProperty")return qR}const a=Reflect.get(i,r,s);return(Km(r)?vE.has(r):MR(r))||(t||Tn(i,"get",r),e)?a:Qt(a)?o&&Wm(r)?a:a.value:ct(a)?t?IE(a):qn(a):a}}const UR=yE(),VR=yE(!0);function yE(t=!1){return function(n,i,r,s){let o=n[i];if(Fo(o)&&Qt(o)&&!Qt(r))return!1;if(!t&&(!Uu(r)&&!Fo(r)&&(o=Ue(o),r=Ue(r)),!ve(n)&&Qt(o)&&!Qt(r)))return o.value=r,!0;const a=ve(n)&&Wm(i)?Number(i)<n.length:Fe(n,i),l=Reflect.set(n,i,r,s);return n===Ue(s)&&(a?yl(r,o)&&ji(n,"set",i,r):ji(n,"add",i,r)),l}}function zR(t,e){const n=Fe(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&n&&ji(t,"delete",e,void 0),i}function jR(t,e){const n=Reflect.has(t,e);return(!Km(e)||!vE.has(e))&&Tn(t,"has",e),n}function HR(t){return Tn(t,"iterate",ve(t)?"length":gs),Reflect.ownKeys(t)}const _E={get:LR,set:UR,deleteProperty:zR,has:jR,ownKeys:HR},KR={get:BR,set(t,e){return!0},deleteProperty(t,e){return!0}},WR=Ct({},_E,{get:FR,set:VR}),Jm=t=>t,Vh=t=>Reflect.getPrototypeOf(t);function qc(t,e,n=!1,i=!1){t=t.__v_raw;const r=Ue(t),s=Ue(e);n||(e!==s&&Tn(r,"get",e),Tn(r,"get",s));const{has:o}=Vh(r),a=i?Jm:n?tg:_l;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function Uc(t,e=!1){const n=this.__v_raw,i=Ue(n),r=Ue(t);return e||(t!==r&&Tn(i,"has",t),Tn(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function Vc(t,e=!1){return t=t.__v_raw,!e&&Tn(Ue(t),"iterate",gs),Reflect.get(t,"size",t)}function By(t){t=Ue(t);const e=Ue(this);return Vh(e).has.call(e,t)||(e.add(t),ji(e,"add",t,t)),this}function $y(t,e){e=Ue(e);const n=Ue(this),{has:i,get:r}=Vh(n);let s=i.call(n,t);s||(t=Ue(t),s=i.call(n,t));const o=r.call(n,t);return n.set(t,e),s?yl(e,o)&&ji(n,"set",t,e):ji(n,"add",t,e),this}function qy(t){const e=Ue(this),{has:n,get:i}=Vh(e);let r=n.call(e,t);r||(t=Ue(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&ji(e,"delete",t,void 0),s}function Uy(){const t=Ue(this),e=t.size!==0,n=t.clear();return e&&ji(t,"clear",void 0,void 0),n}function zc(t,e){return function(i,r){const s=this,o=s.__v_raw,a=Ue(o),l=e?Jm:t?tg:_l;return!t&&Tn(a,"iterate",gs),o.forEach((c,u)=>i.call(r,l(c),l(u),s))}}function jc(t,e,n){return function(...i){const r=this.__v_raw,s=Ue(r),o=To(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...i),u=n?Jm:e?tg:_l;return!e&&Tn(s,"iterate",l?cp:gs),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function Ji(t){return function(...e){return t==="delete"?!1:this}}function GR(){const t={get(s){return qc(this,s)},get size(){return Vc(this)},has:Uc,add:By,set:$y,delete:qy,clear:Uy,forEach:zc(!1,!1)},e={get(s){return qc(this,s,!1,!0)},get size(){return Vc(this)},has:Uc,add:By,set:$y,delete:qy,clear:Uy,forEach:zc(!1,!0)},n={get(s){return qc(this,s,!0)},get size(){return Vc(this,!0)},has(s){return Uc.call(this,s,!0)},add:Ji("add"),set:Ji("set"),delete:Ji("delete"),clear:Ji("clear"),forEach:zc(!0,!1)},i={get(s){return qc(this,s,!0,!0)},get size(){return Vc(this,!0)},has(s){return Uc.call(this,s,!0)},add:Ji("add"),set:Ji("set"),delete:Ji("delete"),clear:Ji("clear"),forEach:zc(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=jc(s,!1,!1),n[s]=jc(s,!0,!1),e[s]=jc(s,!1,!0),i[s]=jc(s,!0,!0)}),[t,n,e,i]}const[QR,YR,XR,JR]=GR();function Zm(t,e){const n=e?t?JR:XR:t?YR:QR;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(Fe(n,r)&&r in i?n:i,r,s)}const ZR={get:Zm(!1,!1)},e1={get:Zm(!1,!0)},t1={get:Zm(!0,!1)},wE=new WeakMap,bE=new WeakMap,EE=new WeakMap,n1=new WeakMap;function i1(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function r1(t){return t.__v_skip||!Object.isExtensible(t)?0:i1(_R(t))}function qn(t){return Fo(t)?t:eg(t,!1,_E,ZR,wE)}function s1(t){return eg(t,!1,WR,e1,bE)}function IE(t){return eg(t,!0,KR,t1,EE)}function eg(t,e,n,i,r){if(!ct(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=r1(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function So(t){return Fo(t)?So(t.__v_raw):!!(t&&t.__v_isReactive)}function Fo(t){return!!(t&&t.__v_isReadonly)}function Uu(t){return!!(t&&t.__v_isShallow)}function TE(t){return So(t)||Fo(t)}function Ue(t){const e=t&&t.__v_raw;return e?Ue(e):t}function zh(t){return qu(t,"__v_skip",!0),t}const _l=t=>ct(t)?qn(t):t,tg=t=>ct(t)?IE(t):t;function SE(t){vr&&Yn&&(t=Ue(t),gE(t.dep||(t.dep=Qm())))}function CE(t,e){t=Ue(t);const n=t.dep;n&&up(n)}function Qt(t){return!!(t&&t.__v_isRef===!0)}function ae(t){return xE(t,!1)}function kE(t){return xE(t,!0)}function xE(t,e){return Qt(t)?t:new o1(t,e)}class o1{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Ue(e),this._value=n?e:_l(e)}get value(){return SE(this),this._value}set value(e){const n=this.__v_isShallow||Uu(e)||Fo(e);e=n?e:Ue(e),yl(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:_l(e),CE(this))}}function Ae(t){return Qt(t)?t.value:t}const a1={get:(t,e,n)=>Ae(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Qt(r)&&!Qt(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function AE(t){return So(t)?t:new Proxy(t,a1)}class l1{constructor(e,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Ym(e,()=>{this._dirty||(this._dirty=!0,CE(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=Ue(this);return SE(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function c1(t,e,n=!1){let i,r;const s=Se(t);return s?(i=t,r=ni):(i=t.get,r=t.set),new l1(i,r,s||!r,n)}function yr(t,e,n,i){let r;try{r=i?t(...i):t()}catch(s){jh(s,e,n)}return r}function zn(t,e,n,i){if(Se(t)){const s=yr(t,e,n,i);return s&&oE(s)&&s.catch(o=>{jh(o,e,n)}),s}const r=[];for(let s=0;s<t.length;s++)r.push(zn(t[s],e,n,i));return r}function jh(t,e,n,i=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=n;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){yr(l,null,10,[t,o,a]);return}}u1(t,n,r,i)}function u1(t,e,n,i=!0){console.error(t)}let wl=!1,hp=!1;const rn=[];let pi=0;const Co=[];let Mi=null,ts=0;const RE=Promise.resolve();let ng=null;function sn(t){const e=ng||RE;return t?e.then(this?t.bind(this):t):e}function h1(t){let e=pi+1,n=rn.length;for(;e<n;){const i=e+n>>>1;bl(rn[i])<t?e=i+1:n=i}return e}function ig(t){(!rn.length||!rn.includes(t,wl&&t.allowRecurse?pi+1:pi))&&(t.id==null?rn.push(t):rn.splice(h1(t.id),0,t),NE())}function NE(){!wl&&!hp&&(hp=!0,ng=RE.then(OE))}function d1(t){const e=rn.indexOf(t);e>pi&&rn.splice(e,1)}function f1(t){ve(t)?Co.push(...t):(!Mi||!Mi.includes(t,t.allowRecurse?ts+1:ts))&&Co.push(t),NE()}function Vy(t,e=wl?pi+1:0){for(;e<rn.length;e++){const n=rn[e];n&&n.pre&&(rn.splice(e,1),e--,n())}}function DE(t){if(Co.length){const e=[...new Set(Co)];if(Co.length=0,Mi){Mi.push(...e);return}for(Mi=e,Mi.sort((n,i)=>bl(n)-bl(i)),ts=0;ts<Mi.length;ts++)Mi[ts]();Mi=null,ts=0}}const bl=t=>t.id==null?1/0:t.id,p1=(t,e)=>{const n=bl(t)-bl(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function OE(t){hp=!1,wl=!0,rn.sort(p1);const e=ni;try{for(pi=0;pi<rn.length;pi++){const n=rn[pi];n&&n.active!==!1&&yr(n,null,14)}}finally{pi=0,rn.length=0,DE(),wl=!1,ng=null,(rn.length||Co.length)&&OE()}}function m1(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||nt;let r=n;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in i){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=i[u]||nt;d&&(r=n.map(f=>bt(f)?f.trim():f)),h&&(r=n.map(ER))}let a,l=i[a=tf(e)]||i[a=tf(xi(e))];!l&&s&&(l=i[a=tf(js(e))]),l&&zn(l,t,6,r);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,zn(c,t,6,r)}}function PE(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!Se(t)){const l=c=>{const u=PE(c,e,!0);u&&(a=!0,Ct(o,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(ct(t)&&i.set(t,null),null):(ve(s)?s.forEach(l=>o[l]=null):Ct(o,s),ct(t)&&i.set(t,o),o)}function Hh(t,e){return!t||!Fh(e)?!1:(e=e.slice(2).replace(/Once$/,""),Fe(t,e[0].toLowerCase()+e.slice(1))||Fe(t,js(e))||Fe(t,e))}let Nn=null,ME=null;function Vu(t){const e=Nn;return Nn=t,ME=t&&t.type.__scopeId||null,e}function qe(t,e=Nn,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&t_(-1);const s=Vu(e);let o;try{o=t(...r)}finally{Vu(s),i._d&&t_(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function rf(t){const{type:e,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:m}=t;let g,w;const v=Vu(t);try{if(n.shapeFlag&4){const E=r||i;g=fi(u.call(E,E,h,s,f,d,p)),w=l}else{const E=e;g=fi(E.length>1?E(s,{attrs:l,slots:a,emit:c}):E(s,null)),w=e.props?l:g1(l)}}catch(E){il.length=0,jh(E,t,1),g=Ee(ii)}let b=g;if(w&&m!==!1){const E=Object.keys(w),{shapeFlag:P}=b;E.length&&P&7&&(o&&E.some(jm)&&(w=v1(w,o)),b=Tr(b,w))}return n.dirs&&(b=Tr(b),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&(b.transition=n.transition),g=b,Vu(v),g}const g1=t=>{let e;for(const n in t)(n==="class"||n==="style"||Fh(n))&&((e||(e={}))[n]=t[n]);return e},v1=(t,e)=>{const n={};for(const i in t)(!jm(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function y1(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?zy(i,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==i[d]&&!Hh(c,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?zy(i,o,c):!0:!!o;return!1}function zy(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!Hh(n,s))return!0}return!1}function _1({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const w1=t=>t.__isSuspense;function b1(t,e){e&&e.pendingBranch?ve(t)?e.effects.push(...t):e.effects.push(t):f1(t)}const Hc={};function ge(t,e,n){return LE(t,e,n)}function LE(t,e,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:o}=nt){var a;const l=dE()===((a=Pt)==null?void 0:a.scope)?Pt:null;let c,u=!1,h=!1;if(Qt(t)?(c=()=>t.value,u=Uu(t)):So(t)?(c=()=>t,i=!0):ve(t)?(h=!0,u=t.some(E=>So(E)||Uu(E)),c=()=>t.map(E=>{if(Qt(E))return E.value;if(So(E))return cs(E);if(Se(E))return yr(E,l,2)})):Se(t)?e?c=()=>yr(t,l,2):c=()=>{if(!(l&&l.isUnmounted))return d&&d(),zn(t,l,3,[f])}:c=ni,e&&i){const E=c;c=()=>cs(E())}let d,f=E=>{d=v.onStop=()=>{yr(E,l,4)}},p;if(Il)if(f=ni,e?n&&zn(e,l,3,[c(),h?[]:void 0,f]):c(),r==="sync"){const E=fN();p=E.__watcherHandles||(E.__watcherHandles=[])}else return ni;let m=h?new Array(t.length).fill(Hc):Hc;const g=()=>{if(v.active)if(e){const E=v.run();(i||u||(h?E.some((P,C)=>yl(P,m[C])):yl(E,m)))&&(d&&d(),zn(e,l,3,[E,m===Hc?void 0:h&&m[0]===Hc?[]:m,f]),m=E)}else v.run()};g.allowRecurse=!!e;let w;r==="sync"?w=g:r==="post"?w=()=>yn(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),w=()=>ig(g));const v=new Ym(c,w);e?n?g():m=v.run():r==="post"?yn(v.run.bind(v),l&&l.suspense):v.run();const b=()=>{v.stop(),l&&l.scope&&Hm(l.scope.effects,v)};return p&&p.push(b),b}function E1(t,e,n){const i=this.proxy,r=bt(t)?t.includes(".")?FE(i,t):()=>i[t]:t.bind(i,i);let s;Se(e)?s=e:(s=e.handler,n=e);const o=Pt;$o(this);const a=LE(r,s.bind(i),n);return o?$o(o):vs(),a}function FE(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function cs(t,e){if(!ct(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Qt(t))cs(t.value,e);else if(ve(t))for(let n=0;n<t.length;n++)cs(t[n],e);else if(sE(t)||To(t))t.forEach(n=>{cs(n,e)});else if(lE(t))for(const n in t)cs(t[n],e);return t}function Bo(t,e){const n=Nn;if(n===null)return t;const i=Jh(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,c=nt]=e[s];o&&(Se(o)&&(o={mounted:o,updated:o}),o.deep&&cs(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:c}))}return t}function Hr(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(aa(),zn(l,n,8,[t.el,a,t,e]),la())}}function I1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hn(()=>{t.isMounted=!0}),Xt(()=>{t.isUnmounting=!0}),t}const Fn=[Function,Array],BE={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fn,onEnter:Fn,onAfterEnter:Fn,onEnterCancelled:Fn,onBeforeLeave:Fn,onLeave:Fn,onAfterLeave:Fn,onLeaveCancelled:Fn,onBeforeAppear:Fn,onAppear:Fn,onAfterAppear:Fn,onAppearCancelled:Fn},T1={name:"BaseTransition",props:BE,setup(t,{slots:e}){const n=je(),i=I1();let r;return()=>{const s=e.default&&qE(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const m of s)if(m.type!==ii){o=m;break}}const a=Ue(t),{mode:l}=a;if(i.isLeaving)return sf(o);const c=jy(o);if(!c)return sf(o);const u=dp(c,a,i,n);fp(c,u);const h=n.subTree,d=h&&jy(h);let f=!1;const{getTransitionKey:p}=c.type;if(p){const m=p();r===void 0?r=m:m!==r&&(r=m,f=!0)}if(d&&d.type!==ii&&(!ns(c,d)||f)){const m=dp(d,a,i,n);if(fp(d,m),l==="out-in")return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,n.update.active!==!1&&n.update()},sf(o);l==="in-out"&&c.type!==ii&&(m.delayLeave=(g,w,v)=>{const b=$E(i,d);b[String(d.key)]=d,g._leaveCb=()=>{w(),g._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=v})}return o}}},S1=T1;function $E(t,e){const{leavingVNodes:n}=t;let i=n.get(e.type);return i||(i=Object.create(null),n.set(e.type,i)),i}function dp(t,e,n,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:m,onAppear:g,onAfterAppear:w,onAppearCancelled:v}=e,b=String(t.key),E=$E(n,t),P=(N,S)=>{N&&zn(N,i,9,S)},C=(N,S)=>{const k=S[1];P(N,S),ve(N)?N.every(V=>V.length<=1)&&k():N.length<=1&&k()},B={mode:s,persisted:o,beforeEnter(N){let S=a;if(!n.isMounted)if(r)S=m||a;else return;N._leaveCb&&N._leaveCb(!0);const k=E[b];k&&ns(t,k)&&k.el._leaveCb&&k.el._leaveCb(),P(S,[N])},enter(N){let S=l,k=c,V=u;if(!n.isMounted)if(r)S=g||l,k=w||c,V=v||u;else return;let R=!1;const X=N._enterCb=$=>{R||(R=!0,$?P(V,[N]):P(k,[N]),B.delayedLeave&&B.delayedLeave(),N._enterCb=void 0)};S?C(S,[N,X]):X()},leave(N,S){const k=String(t.key);if(N._enterCb&&N._enterCb(!0),n.isUnmounting)return S();P(h,[N]);let V=!1;const R=N._leaveCb=X=>{V||(V=!0,S(),X?P(p,[N]):P(f,[N]),N._leaveCb=void 0,E[k]===t&&delete E[k])};E[k]=t,d?C(d,[N,R]):R()},clone(N){return dp(N,e,n,i)}};return B}function sf(t){if(Kh(t))return t=Tr(t),t.children=null,t}function jy(t){return Kh(t)?t.children?t.children[0]:void 0:t}function fp(t,e){t.shapeFlag&6&&t.component?fp(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function qE(t,e=!1,n){let i=[],r=0;for(let s=0;s<t.length;s++){let o=t[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===An?(o.patchFlag&128&&r++,i=i.concat(qE(o.children,e,a))):(e||o.type!==ii)&&i.push(a!=null?Tr(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function rg(t,e){return Se(t)?(()=>Ct({name:t.name},e,{setup:t}))():t}const Iu=t=>!!t.type.__asyncLoader,Kh=t=>t.type.__isKeepAlive;function UE(t,e){VE(t,"a",e)}function Wh(t,e){VE(t,"da",e)}function VE(t,e,n=Pt){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Gh(e,i,n),n){let r=n.parent;for(;r&&r.parent;)Kh(r.parent.vnode)&&C1(i,e,n,r),r=r.parent}}function C1(t,e,n,i){const r=Gh(e,t,i,!0);Qh(()=>{Hm(i[e],r)},n)}function Gh(t,e,n=Pt,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;aa(),$o(n);const a=zn(e,n,t,o);return vs(),la(),a});return i?r.unshift(s):r.push(s),s}}const Gi=t=>(e,n=Pt)=>(!Il||t==="sp")&&Gh(t,(...i)=>e(...i),n),k1=Gi("bm"),Hn=Gi("m"),zE=Gi("bu"),x1=Gi("u"),Xt=Gi("bum"),Qh=Gi("um"),jE=Gi("sp"),A1=Gi("rtg"),R1=Gi("rtc");function N1(t,e=Pt){Gh("ec",t,e)}const HE="components";function KE(t,e){return O1(HE,t,!0,e)||t}const D1=Symbol.for("v-ndc");function O1(t,e,n=!0,i=!1){const r=Nn||Pt;if(r){const s=r.type;if(t===HE){const a=hN(s,!1);if(a&&(a===e||a===xi(e)||a===qh(xi(e))))return s}const o=Hy(r[t]||s[t],e)||Hy(r.appContext[t],e);return!o&&i?s:o}}function Hy(t,e){return t&&(t[e]||t[xi(e)]||t[qh(xi(e))])}function WE(t,e,n,i){let r;const s=n&&n[i];if(ve(t)||bt(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,s&&s[o])}else if(ct(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];r[a]=e(t[c],c,a,s&&s[a])}}else r=[];return n&&(n[i]=r),r}const pp=t=>t?rI(t)?Jh(t)||t.proxy:pp(t.parent):null,tl=Ct(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>pp(t.parent),$root:t=>pp(t.root),$emit:t=>t.emit,$options:t=>sg(t),$forceUpdate:t=>t.f||(t.f=()=>ig(t.update)),$nextTick:t=>t.n||(t.n=sn.bind(t.proxy)),$watch:t=>E1.bind(t)}),of=(t,e)=>t!==nt&&!t.__isScriptSetup&&Fe(t,e),P1={get({_:t},e){const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(of(i,e))return o[e]=1,i[e];if(r!==nt&&Fe(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&Fe(c,e))return o[e]=3,s[e];if(n!==nt&&Fe(n,e))return o[e]=4,n[e];mp&&(o[e]=0)}}const u=tl[e];let h,d;if(u)return e==="$attrs"&&Tn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==nt&&Fe(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,Fe(d,e))return d[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return of(r,e)?(r[e]=n,!0):i!==nt&&Fe(i,e)?(i[e]=n,!0):Fe(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==nt&&Fe(t,o)||of(e,o)||(a=s[0])&&Fe(a,o)||Fe(i,o)||Fe(tl,o)||Fe(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Fe(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Ky(t){return ve(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let mp=!0;function M1(t){const e=sg(t),n=t.proxy,i=t.ctx;mp=!1,e.beforeCreate&&Wy(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:m,deactivated:g,beforeDestroy:w,beforeUnmount:v,destroyed:b,unmounted:E,render:P,renderTracked:C,renderTriggered:B,errorCaptured:N,serverPrefetch:S,expose:k,inheritAttrs:V,components:R,directives:X,filters:$}=e;if(c&&L1(c,i,null),o)for(const A in o){const Q=o[A];Se(Q)&&(i[A]=Q.bind(n))}if(r){const A=r.call(n,n);ct(A)&&(t.data=qn(A))}if(mp=!0,s)for(const A in s){const Q=s[A],Ce=Se(Q)?Q.bind(n,n):Se(Q.get)?Q.get.bind(n,n):ni,ye=!Se(Q)&&Se(Q.set)?Q.set.bind(n):ni,ke=I({get:Ce,set:ye});Object.defineProperty(i,A,{enumerable:!0,configurable:!0,get:()=>ke.value,set:j=>ke.value=j})}if(a)for(const A in a)GE(a[A],i,n,A);if(l){const A=Se(l)?l.call(n):l;Reflect.ownKeys(A).forEach(Q=>{ko(Q,A[Q])})}u&&Wy(u,t,"c");function ie(A,Q){ve(Q)?Q.forEach(Ce=>A(Ce.bind(n))):Q&&A(Q.bind(n))}if(ie(k1,h),ie(Hn,d),ie(zE,f),ie(x1,p),ie(UE,m),ie(Wh,g),ie(N1,N),ie(R1,C),ie(A1,B),ie(Xt,v),ie(Qh,E),ie(jE,S),ve(k))if(k.length){const A=t.exposed||(t.exposed={});k.forEach(Q=>{Object.defineProperty(A,Q,{get:()=>n[Q],set:Ce=>n[Q]=Ce})})}else t.exposed||(t.exposed={});P&&t.render===ni&&(t.render=P),V!=null&&(t.inheritAttrs=V),R&&(t.components=R),X&&(t.directives=X)}function L1(t,e,n=ni){ve(t)&&(t=gp(t));for(const i in t){const r=t[i];let s;ct(r)?"default"in r?s=Ft(r.from||i,r.default,!0):s=Ft(r.from||i):s=Ft(r),Qt(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function Wy(t,e,n){zn(ve(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function GE(t,e,n,i){const r=i.includes(".")?FE(n,i):()=>n[i];if(bt(t)){const s=e[t];Se(s)&&ge(r,s)}else if(Se(t))ge(r,t.bind(n));else if(ct(t))if(ve(t))t.forEach(s=>GE(s,e,n,i));else{const s=Se(t.handler)?t.handler.bind(n):e[t.handler];Se(s)&&ge(r,s,t)}}function sg(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(c=>zu(l,c,o,!0)),zu(l,e,o)),ct(e)&&s.set(e,l),l}function zu(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&zu(t,s,n,!0),r&&r.forEach(o=>zu(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=F1[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const F1={data:Gy,props:Qy,emits:Qy,methods:Ha,computed:Ha,beforeCreate:hn,created:hn,beforeMount:hn,mounted:hn,beforeUpdate:hn,updated:hn,beforeDestroy:hn,beforeUnmount:hn,destroyed:hn,unmounted:hn,activated:hn,deactivated:hn,errorCaptured:hn,serverPrefetch:hn,components:Ha,directives:Ha,watch:$1,provide:Gy,inject:B1};function Gy(t,e){return e?t?function(){return Ct(Se(t)?t.call(this,this):t,Se(e)?e.call(this,this):e)}:e:t}function B1(t,e){return Ha(gp(t),gp(e))}function gp(t){if(ve(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function hn(t,e){return t?[...new Set([].concat(t,e))]:e}function Ha(t,e){return t?Ct(Object.create(null),t,e):e}function Qy(t,e){return t?ve(t)&&ve(e)?[...new Set([...t,...e])]:Ct(Object.create(null),Ky(t),Ky(e??{})):e}function $1(t,e){if(!t)return e;if(!e)return t;const n=Ct(Object.create(null),t);for(const i in e)n[i]=hn(t[i],e[i]);return n}function QE(){return{app:null,config:{isNativeTag:gR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let q1=0;function U1(t,e){return function(i,r=null){Se(i)||(i=Ct({},i)),r!=null&&!ct(r)&&(r=null);const s=QE(),o=new Set;let a=!1;const l=s.app={_uid:q1++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:pN,get config(){return s.config},set config(c){},use(c,...u){return o.has(c)||(c&&Se(c.install)?(o.add(c),c.install(l,...u)):Se(c)&&(o.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!a){const d=Ee(i,r);return d.appContext=s,u&&e?e(d,c):t(d,c,h),a=!0,l._container=c,c.__vue_app__=l,Jh(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l},runWithContext(c){ju=l;try{return c()}finally{ju=null}}};return l}}let ju=null;function ko(t,e){if(Pt){let n=Pt.provides;const i=Pt.parent&&Pt.parent.provides;i===n&&(n=Pt.provides=Object.create(i)),n[t]=e}}function Ft(t,e,n=!1){const i=Pt||Nn;if(i||ju){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:ju._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&Se(e)?e.call(i&&i.proxy):e}}function V1(t,e,n,i=!1){const r={},s={};qu(s,Xh,1),t.propsDefaults=Object.create(null),YE(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:s1(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function z1(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=Ue(r),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Hh(t.emitsOptions,d))continue;const f=e[d];if(l)if(Fe(s,d))f!==s[d]&&(s[d]=f,c=!0);else{const p=xi(d);r[p]=vp(l,a,p,f,t,!1)}else f!==s[d]&&(s[d]=f,c=!0)}}}else{YE(t,e,r,s)&&(c=!0);let u;for(const h in a)(!e||!Fe(e,h)&&((u=js(h))===h||!Fe(e,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=vp(l,a,h,void 0,t,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!Fe(e,h))&&(delete s[h],c=!0)}c&&ji(t,"set","$attrs")}function YE(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Eu(l))continue;const c=e[l];let u;r&&Fe(r,u=xi(l))?!s||!s.includes(u)?n[u]=c:(a||(a={}))[u]=c:Hh(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=Ue(n),c=a||nt;for(let u=0;u<s.length;u++){const h=s[u];n[h]=vp(r,l,h,c[h],t,!Fe(c,h))}}return o}function vp(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=Fe(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Se(l)){const{propsDefaults:c}=r;n in c?i=c[n]:($o(r),i=c[n]=l.call(null,e),vs())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===js(n))&&(i=!0))}return i}function XE(t,e,n=!1){const i=e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!Se(t)){const u=h=>{l=!0;const[d,f]=XE(h,e,!0);Ct(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!l)return ct(t)&&i.set(t,Io),Io;if(ve(s))for(let u=0;u<s.length;u++){const h=xi(s[u]);Yy(h)&&(o[h]=nt)}else if(s)for(const u in s){const h=xi(u);if(Yy(h)){const d=s[u],f=o[h]=ve(d)||Se(d)?{type:d}:Ct({},d);if(f){const p=Zy(Boolean,f.type),m=Zy(String,f.type);f[0]=p>-1,f[1]=m<0||p<m,(p>-1||Fe(f,"default"))&&a.push(h)}}}const c=[o,a];return ct(t)&&i.set(t,c),c}function Yy(t){return t[0]!=="$"}function Xy(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Jy(t,e){return Xy(t)===Xy(e)}function Zy(t,e){return ve(e)?e.findIndex(n=>Jy(n,t)):Se(e)&&Jy(e,t)?0:-1}const JE=t=>t[0]==="_"||t==="$stable",og=t=>ve(t)?t.map(fi):[fi(t)],j1=(t,e,n)=>{if(e._n)return e;const i=qe((...r)=>og(e(...r)),n);return i._c=!1,i},ZE=(t,e,n)=>{const i=t._ctx;for(const r in t){if(JE(r))continue;const s=t[r];if(Se(s))e[r]=j1(r,s,i);else if(s!=null){const o=og(s);e[r]=()=>o}}},eI=(t,e)=>{const n=og(e);t.slots.default=()=>n},H1=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Ue(e),qu(e,"_",n)):ZE(e,t.slots={})}else t.slots={},e&&eI(t,e);qu(t.slots,Xh,1)},K1=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=nt;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(Ct(r,e),!n&&a===1&&delete r._):(s=!e.$stable,ZE(e,r)),o=e}else e&&(eI(t,e),o={default:1});if(s)for(const a in r)!JE(a)&&!(a in o)&&delete r[a]};function yp(t,e,n,i,r=!1){if(ve(t)){t.forEach((d,f)=>yp(d,e&&(ve(e)?e[f]:e),n,i,r));return}if(Iu(i)&&!r)return;const s=i.shapeFlag&4?Jh(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=t,c=e&&e.r,u=a.refs===nt?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(bt(c)?(u[c]=null,Fe(h,c)&&(h[c]=null)):Qt(c)&&(c.value=null)),Se(l))yr(l,a,12,[o,u]);else{const d=bt(l),f=Qt(l);if(d||f){const p=()=>{if(t.f){const m=d?Fe(h,l)?h[l]:u[l]:l.value;r?ve(m)&&Hm(m,s):ve(m)?m.includes(s)||m.push(s):d?(u[l]=[s],Fe(h,l)&&(h[l]=u[l])):(l.value=[s],t.k&&(u[t.k]=l.value))}else d?(u[l]=o,Fe(h,l)&&(h[l]=o)):f&&(l.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,yn(p,n)):p()}}}const yn=b1;function W1(t){return G1(t)}function G1(t,e){const n=op();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=ni,insertStaticContent:p}=t,m=(y,_,T,F=null,q=null,H=null,re=!1,W=null,Y=!!_.dynamicChildren)=>{if(y===_)return;y&&!ns(y,_)&&(F=L(y),j(y,q,H,!0),y=null),_.patchFlag===-2&&(Y=!1,_.dynamicChildren=null);const{type:K,ref:fe,shapeFlag:O}=_;switch(K){case Yh:g(y,_,T,F);break;case ii:w(y,_,T,F);break;case af:y==null&&v(_,T,F,re);break;case An:R(y,_,T,F,q,H,re,W,Y);break;default:O&1?P(y,_,T,F,q,H,re,W,Y):O&6?X(y,_,T,F,q,H,re,W,Y):(O&64||O&128)&&K.process(y,_,T,F,q,H,re,W,Y,J)}fe!=null&&q&&yp(fe,y&&y.ref,H,_||y,!_)},g=(y,_,T,F)=>{if(y==null)i(_.el=a(_.children),T,F);else{const q=_.el=y.el;_.children!==y.children&&c(q,_.children)}},w=(y,_,T,F)=>{y==null?i(_.el=l(_.children||""),T,F):_.el=y.el},v=(y,_,T,F)=>{[y.el,y.anchor]=p(y.children,_,T,F,y.el,y.anchor)},b=({el:y,anchor:_},T,F)=>{let q;for(;y&&y!==_;)q=d(y),i(y,T,F),y=q;i(_,T,F)},E=({el:y,anchor:_})=>{let T;for(;y&&y!==_;)T=d(y),r(y),y=T;r(_)},P=(y,_,T,F,q,H,re,W,Y)=>{re=re||_.type==="svg",y==null?C(_,T,F,q,H,re,W,Y):S(y,_,q,H,re,W,Y)},C=(y,_,T,F,q,H,re,W)=>{let Y,K;const{type:fe,props:O,shapeFlag:G,transition:ce,dirs:Te}=y;if(Y=y.el=o(y.type,H,O&&O.is,O),G&8?u(Y,y.children):G&16&&N(y.children,Y,null,F,q,H&&fe!=="foreignObject",re,W),Te&&Hr(y,null,F,"created"),B(Y,y,y.scopeId,re,F),O){for(const Qe in O)Qe!=="value"&&!Eu(Qe)&&s(Y,Qe,null,O[Qe],H,y.children,F,q,pe);"value"in O&&s(Y,"value",null,O.value),(K=O.onVnodeBeforeMount)&&di(K,F,y)}Te&&Hr(y,null,F,"beforeMount");const Xe=(!q||q&&!q.pendingBranch)&&ce&&!ce.persisted;Xe&&ce.beforeEnter(Y),i(Y,_,T),((K=O&&O.onVnodeMounted)||Xe||Te)&&yn(()=>{K&&di(K,F,y),Xe&&ce.enter(Y),Te&&Hr(y,null,F,"mounted")},q)},B=(y,_,T,F,q)=>{if(T&&f(y,T),F)for(let H=0;H<F.length;H++)f(y,F[H]);if(q){let H=q.subTree;if(_===H){const re=q.vnode;B(y,re,re.scopeId,re.slotScopeIds,q.parent)}}},N=(y,_,T,F,q,H,re,W,Y=0)=>{for(let K=Y;K<y.length;K++){const fe=y[K]=W?sr(y[K]):fi(y[K]);m(null,fe,_,T,F,q,H,re,W)}},S=(y,_,T,F,q,H,re)=>{const W=_.el=y.el;let{patchFlag:Y,dynamicChildren:K,dirs:fe}=_;Y|=y.patchFlag&16;const O=y.props||nt,G=_.props||nt;let ce;T&&Kr(T,!1),(ce=G.onVnodeBeforeUpdate)&&di(ce,T,_,y),fe&&Hr(_,y,T,"beforeUpdate"),T&&Kr(T,!0);const Te=q&&_.type!=="foreignObject";if(K?k(y.dynamicChildren,K,W,T,F,Te,H):re||Q(y,_,W,null,T,F,Te,H,!1),Y>0){if(Y&16)V(W,_,O,G,T,F,q);else if(Y&2&&O.class!==G.class&&s(W,"class",null,G.class,q),Y&4&&s(W,"style",O.style,G.style,q),Y&8){const Xe=_.dynamicProps;for(let Qe=0;Qe<Xe.length;Qe++){const It=Xe[Qe],Gn=O[It],io=G[It];(io!==Gn||It==="value")&&s(W,It,Gn,io,q,y.children,T,F,pe)}}Y&1&&y.children!==_.children&&u(W,_.children)}else!re&&K==null&&V(W,_,O,G,T,F,q);((ce=G.onVnodeUpdated)||fe)&&yn(()=>{ce&&di(ce,T,_,y),fe&&Hr(_,y,T,"updated")},F)},k=(y,_,T,F,q,H,re)=>{for(let W=0;W<_.length;W++){const Y=y[W],K=_[W],fe=Y.el&&(Y.type===An||!ns(Y,K)||Y.shapeFlag&70)?h(Y.el):T;m(Y,K,fe,null,F,q,H,re,!0)}},V=(y,_,T,F,q,H,re)=>{if(T!==F){if(T!==nt)for(const W in T)!Eu(W)&&!(W in F)&&s(y,W,T[W],null,re,_.children,q,H,pe);for(const W in F){if(Eu(W))continue;const Y=F[W],K=T[W];Y!==K&&W!=="value"&&s(y,W,K,Y,re,_.children,q,H,pe)}"value"in F&&s(y,"value",T.value,F.value)}},R=(y,_,T,F,q,H,re,W,Y)=>{const K=_.el=y?y.el:a(""),fe=_.anchor=y?y.anchor:a("");let{patchFlag:O,dynamicChildren:G,slotScopeIds:ce}=_;ce&&(W=W?W.concat(ce):ce),y==null?(i(K,T,F),i(fe,T,F),N(_.children,T,fe,q,H,re,W,Y)):O>0&&O&64&&G&&y.dynamicChildren?(k(y.dynamicChildren,G,T,q,H,re,W),(_.key!=null||q&&_===q.subTree)&&ag(y,_,!0)):Q(y,_,T,fe,q,H,re,W,Y)},X=(y,_,T,F,q,H,re,W,Y)=>{_.slotScopeIds=W,y==null?_.shapeFlag&512?q.ctx.activate(_,T,F,re,Y):$(_,T,F,q,H,re,Y):le(y,_,Y)},$=(y,_,T,F,q,H,re)=>{const W=y.component=oN(y,F,q);if(Kh(y)&&(W.ctx.renderer=J),aN(W),W.asyncDep){if(q&&q.registerDep(W,ie),!y.el){const Y=W.subTree=Ee(ii);w(null,Y,_,T)}return}ie(W,y,_,T,q,H,re)},le=(y,_,T)=>{const F=_.component=y.component;if(y1(y,_,T))if(F.asyncDep&&!F.asyncResolved){A(F,_,T);return}else F.next=_,d1(F.update),F.update();else _.el=y.el,F.vnode=_},ie=(y,_,T,F,q,H,re)=>{const W=()=>{if(y.isMounted){let{next:fe,bu:O,u:G,parent:ce,vnode:Te}=y,Xe=fe,Qe;Kr(y,!1),fe?(fe.el=Te.el,A(y,fe,re)):fe=Te,O&&nf(O),(Qe=fe.props&&fe.props.onVnodeBeforeUpdate)&&di(Qe,ce,fe,Te),Kr(y,!0);const It=rf(y),Gn=y.subTree;y.subTree=It,m(Gn,It,h(Gn.el),L(Gn),y,q,H),fe.el=It.el,Xe===null&&_1(y,It.el),G&&yn(G,q),(Qe=fe.props&&fe.props.onVnodeUpdated)&&yn(()=>di(Qe,ce,fe,Te),q)}else{let fe;const{el:O,props:G}=_,{bm:ce,m:Te,parent:Xe}=y,Qe=Iu(_);if(Kr(y,!1),ce&&nf(ce),!Qe&&(fe=G&&G.onVnodeBeforeMount)&&di(fe,Xe,_),Kr(y,!0),O&&$e){const It=()=>{y.subTree=rf(y),$e(O,y.subTree,y,q,null)};Qe?_.type.__asyncLoader().then(()=>!y.isUnmounted&&It()):It()}else{const It=y.subTree=rf(y);m(null,It,T,F,y,q,H),_.el=It.el}if(Te&&yn(Te,q),!Qe&&(fe=G&&G.onVnodeMounted)){const It=_;yn(()=>di(fe,Xe,It),q)}(_.shapeFlag&256||Xe&&Iu(Xe.vnode)&&Xe.vnode.shapeFlag&256)&&y.a&&yn(y.a,q),y.isMounted=!0,_=T=F=null}},Y=y.effect=new Ym(W,()=>ig(K),y.scope),K=y.update=()=>Y.run();K.id=y.uid,Kr(y,!0),K()},A=(y,_,T)=>{_.component=y;const F=y.vnode.props;y.vnode=_,y.next=null,z1(y,_.props,F,T),K1(y,_.children,T),aa(),Vy(),la()},Q=(y,_,T,F,q,H,re,W,Y=!1)=>{const K=y&&y.children,fe=y?y.shapeFlag:0,O=_.children,{patchFlag:G,shapeFlag:ce}=_;if(G>0){if(G&128){ye(K,O,T,F,q,H,re,W,Y);return}else if(G&256){Ce(K,O,T,F,q,H,re,W,Y);return}}ce&8?(fe&16&&pe(K,q,H),O!==K&&u(T,O)):fe&16?ce&16?ye(K,O,T,F,q,H,re,W,Y):pe(K,q,H,!0):(fe&8&&u(T,""),ce&16&&N(O,T,F,q,H,re,W,Y))},Ce=(y,_,T,F,q,H,re,W,Y)=>{y=y||Io,_=_||Io;const K=y.length,fe=_.length,O=Math.min(K,fe);let G;for(G=0;G<O;G++){const ce=_[G]=Y?sr(_[G]):fi(_[G]);m(y[G],ce,T,null,q,H,re,W,Y)}K>fe?pe(y,q,H,!0,!1,O):N(_,T,F,q,H,re,W,Y,O)},ye=(y,_,T,F,q,H,re,W,Y)=>{let K=0;const fe=_.length;let O=y.length-1,G=fe-1;for(;K<=O&&K<=G;){const ce=y[K],Te=_[K]=Y?sr(_[K]):fi(_[K]);if(ns(ce,Te))m(ce,Te,T,null,q,H,re,W,Y);else break;K++}for(;K<=O&&K<=G;){const ce=y[O],Te=_[G]=Y?sr(_[G]):fi(_[G]);if(ns(ce,Te))m(ce,Te,T,null,q,H,re,W,Y);else break;O--,G--}if(K>O){if(K<=G){const ce=G+1,Te=ce<fe?_[ce].el:F;for(;K<=G;)m(null,_[K]=Y?sr(_[K]):fi(_[K]),T,Te,q,H,re,W,Y),K++}}else if(K>G)for(;K<=O;)j(y[K],q,H,!0),K++;else{const ce=K,Te=K,Xe=new Map;for(K=Te;K<=G;K++){const Cn=_[K]=Y?sr(_[K]):fi(_[K]);Cn.key!=null&&Xe.set(Cn.key,K)}let Qe,It=0;const Gn=G-Te+1;let io=!1,Ny=0;const Ca=new Array(Gn);for(K=0;K<Gn;K++)Ca[K]=0;for(K=ce;K<=O;K++){const Cn=y[K];if(It>=Gn){j(Cn,q,H,!0);continue}let hi;if(Cn.key!=null)hi=Xe.get(Cn.key);else for(Qe=Te;Qe<=G;Qe++)if(Ca[Qe-Te]===0&&ns(Cn,_[Qe])){hi=Qe;break}hi===void 0?j(Cn,q,H,!0):(Ca[hi-Te]=K+1,hi>=Ny?Ny=hi:io=!0,m(Cn,_[hi],T,null,q,H,re,W,Y),It++)}const Dy=io?Q1(Ca):Io;for(Qe=Dy.length-1,K=Gn-1;K>=0;K--){const Cn=Te+K,hi=_[Cn],Oy=Cn+1<fe?_[Cn+1].el:F;Ca[K]===0?m(null,hi,T,Oy,q,H,re,W,Y):io&&(Qe<0||K!==Dy[Qe]?ke(hi,T,Oy,2):Qe--)}}},ke=(y,_,T,F,q=null)=>{const{el:H,type:re,transition:W,children:Y,shapeFlag:K}=y;if(K&6){ke(y.component.subTree,_,T,F);return}if(K&128){y.suspense.move(_,T,F);return}if(K&64){re.move(y,_,T,J);return}if(re===An){i(H,_,T);for(let O=0;O<Y.length;O++)ke(Y[O],_,T,F);i(y.anchor,_,T);return}if(re===af){b(y,_,T);return}if(F!==2&&K&1&&W)if(F===0)W.beforeEnter(H),i(H,_,T),yn(()=>W.enter(H),q);else{const{leave:O,delayLeave:G,afterLeave:ce}=W,Te=()=>i(H,_,T),Xe=()=>{O(H,()=>{Te(),ce&&ce()})};G?G(H,Te,Xe):Xe()}else i(H,_,T)},j=(y,_,T,F=!1,q=!1)=>{const{type:H,props:re,ref:W,children:Y,dynamicChildren:K,shapeFlag:fe,patchFlag:O,dirs:G}=y;if(W!=null&&yp(W,null,T,y,!0),fe&256){_.ctx.deactivate(y);return}const ce=fe&1&&G,Te=!Iu(y);let Xe;if(Te&&(Xe=re&&re.onVnodeBeforeUnmount)&&di(Xe,_,y),fe&6)me(y.component,T,F);else{if(fe&128){y.suspense.unmount(T,F);return}ce&&Hr(y,null,_,"beforeUnmount"),fe&64?y.type.remove(y,_,T,q,J,F):K&&(H!==An||O>0&&O&64)?pe(K,_,T,!1,!0):(H===An&&O&384||!q&&fe&16)&&pe(Y,_,T),F&&xe(y)}(Te&&(Xe=re&&re.onVnodeUnmounted)||ce)&&yn(()=>{Xe&&di(Xe,_,y),ce&&Hr(y,null,_,"unmounted")},T)},xe=y=>{const{type:_,el:T,anchor:F,transition:q}=y;if(_===An){Et(T,F);return}if(_===af){E(y);return}const H=()=>{r(T),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(y.shapeFlag&1&&q&&!q.persisted){const{leave:re,delayLeave:W}=q,Y=()=>re(T,H);W?W(y.el,H,Y):Y()}else H()},Et=(y,_)=>{let T;for(;y!==_;)T=d(y),r(y),y=T;r(_)},me=(y,_,T)=>{const{bum:F,scope:q,update:H,subTree:re,um:W}=y;F&&nf(F),q.stop(),H&&(H.active=!1,j(re,y,_,T)),W&&yn(W,_),yn(()=>{y.isUnmounted=!0},_),_&&_.pendingBranch&&!_.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===_.pendingId&&(_.deps--,_.deps===0&&_.resolve())},pe=(y,_,T,F=!1,q=!1,H=0)=>{for(let re=H;re<y.length;re++)j(y[re],_,T,F,q)},L=y=>y.shapeFlag&6?L(y.component.subTree):y.shapeFlag&128?y.suspense.next():d(y.anchor||y.el),se=(y,_,T)=>{y==null?_._vnode&&j(_._vnode,null,null,!0):m(_._vnode||null,y,_,null,null,null,T),Vy(),DE(),_._vnode=y},J={p:m,um:j,m:ke,r:xe,mt:$,mc:N,pc:Q,pbc:k,n:L,o:t};let de,$e;return e&&([de,$e]=e(J)),{render:se,hydrate:de,createApp:U1(se,de)}}function Kr({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function ag(t,e,n=!1){const i=t.children,r=e.children;if(ve(i)&&ve(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=sr(r[s]),a.el=o.el),n||ag(o,a)),a.type===Yh&&(a.el=o.el)}}function Q1(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(r=n[n.length-1],t[r]<c){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<c?s=a+1:o=a;c<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}const Y1=t=>t.__isTeleport,nl=t=>t&&(t.disabled||t.disabled===""),e_=t=>typeof SVGElement<"u"&&t instanceof SVGElement,_p=(t,e)=>{const n=t&&t.to;return bt(n)?e?e(n):null:n},X1={__isTeleport:!0,process(t,e,n,i,r,s,o,a,l,c){const{mc:u,pc:h,pbc:d,o:{insert:f,querySelector:p,createText:m,createComment:g}}=c,w=nl(e.props);let{shapeFlag:v,children:b,dynamicChildren:E}=e;if(t==null){const P=e.el=m(""),C=e.anchor=m("");f(P,n,i),f(C,n,i);const B=e.target=_p(e.props,p),N=e.targetAnchor=m("");B&&(f(N,B),o=o||e_(B));const S=(k,V)=>{v&16&&u(b,k,V,r,s,o,a,l)};w?S(n,C):B&&S(B,N)}else{e.el=t.el;const P=e.anchor=t.anchor,C=e.target=t.target,B=e.targetAnchor=t.targetAnchor,N=nl(t.props),S=N?n:C,k=N?P:B;if(o=o||e_(C),E?(d(t.dynamicChildren,E,S,r,s,o,a),ag(t,e,!0)):l||h(t,e,S,k,r,s,o,a,!1),w)N||Kc(e,n,P,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const V=e.target=_p(e.props,p);V&&Kc(e,V,null,c,0)}else N&&Kc(e,C,B,c,1)}tI(e)},remove(t,e,n,i,{um:r,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:h,props:d}=t;if(h&&s(u),(o||!nl(d))&&(s(c),a&16))for(let f=0;f<l.length;f++){const p=l[f];r(p,e,n,!0,!!p.dynamicChildren)}},move:Kc,hydrate:J1};function Kc(t,e,n,{o:{insert:i},m:r},s=2){s===0&&i(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=t,h=s===2;if(h&&i(o,e,n),(!h||nl(u))&&l&16)for(let d=0;d<c.length;d++)r(c[d],e,n,2);h&&i(a,e,n)}function J1(t,e,n,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=_p(e.props,l);if(u){const h=u._lpa||u.firstChild;if(e.shapeFlag&16)if(nl(e.props))e.anchor=c(o(t),e,a(t),n,i,r,s),e.targetAnchor=h;else{e.anchor=o(t);let d=h;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(h,e,u,n,i,r,s)}tI(e)}return e.anchor&&o(e.anchor)}const Z1=X1;function tI(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const An=Symbol.for("v-fgt"),Yh=Symbol.for("v-txt"),ii=Symbol.for("v-cmt"),af=Symbol.for("v-stc"),il=[];let Zn=null;function Ke(t=!1){il.push(Zn=t?null:[])}function eN(){il.pop(),Zn=il[il.length-1]||null}let El=1;function t_(t){El+=t}function nI(t){return t.dynamicChildren=El>0?Zn||Io:null,eN(),El>0&&Zn&&Zn.push(t),t}function mr(t,e,n,i,r,s){return nI(pn(t,e,n,i,r,s,!0))}function vt(t,e,n,i,r){return nI(Ee(t,e,n,i,r,!0))}function wp(t){return t?t.__v_isVNode===!0:!1}function ns(t,e){return t.type===e.type&&t.key===e.key}const Xh="__vInternal",iI=({key:t})=>t??null,Tu=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?bt(t)||Qt(t)||Se(t)?{i:Nn,r:t,k:e,f:!!n}:t:null);function pn(t,e=null,n=null,i=0,r=null,s=t===An?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&iI(e),ref:e&&Tu(e),scopeId:ME,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Nn};return a?(lg(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=bt(n)?8:16),El>0&&!o&&Zn&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Zn.push(l),l}const Ee=tN;function tN(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===D1)&&(t=ii),wp(t)){const a=Tr(t,e,!0);return n&&lg(a,n),El>0&&!s&&Zn&&(a.shapeFlag&6?Zn[Zn.indexOf(t)]=a:Zn.push(a)),a.patchFlag|=-2,a}if(dN(t)&&(t=t.__vccOpts),e){e=nN(e);let{class:a,style:l}=e;a&&!bt(a)&&(e.class=Uh(a)),ct(l)&&(TE(l)&&!ve(l)&&(l=Ct({},l)),e.style=Gm(l))}const o=bt(t)?1:w1(t)?128:Y1(t)?64:ct(t)?4:Se(t)?2:0;return pn(t,e,n,i,r,o,s,!0)}function nN(t){return t?TE(t)||Xh in t?Ct({},t):t:null}function Tr(t,e,n=!1){const{props:i,ref:r,patchFlag:s,children:o}=t,a=e?iN(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&iI(a),ref:e&&e.ref?n&&r?ve(r)?r.concat(Tu(e)):[r,Tu(e)]:Tu(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==An?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Tr(t.ssContent),ssFallback:t.ssFallback&&Tr(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function _r(t=" ",e=0){return Ee(Yh,null,t,e)}function At(t="",e=!1){return e?(Ke(),vt(ii,null,t)):Ee(ii,null,t)}function fi(t){return t==null||typeof t=="boolean"?Ee(ii):ve(t)?Ee(An,null,t.slice()):typeof t=="object"?sr(t):Ee(Yh,null,String(t))}function sr(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Tr(t)}function lg(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ve(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),lg(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(Xh in e)?e._ctx=Nn:r===3&&Nn&&(Nn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Se(e)?(e={default:e,_ctx:Nn},n=32):(e=String(e),i&64?(n=16,e=[_r(e)]):n=8);t.children=e,t.shapeFlag|=n}function iN(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Uh([e.class,i.class]));else if(r==="style")e.style=Gm([e.style,i.style]);else if(Fh(r)){const s=e[r],o=i[r];o&&s!==o&&!(ve(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function di(t,e,n,i=null){zn(t,e,7,[n,i])}const rN=QE();let sN=0;function oN(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||rN,s={uid:sN++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new hE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:XE(i,r),emitsOptions:PE(i,r),emit:null,emitted:null,propsDefaults:nt,inheritAttrs:i.inheritAttrs,ctx:nt,data:nt,props:nt,attrs:nt,slots:nt,refs:nt,setupState:nt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=m1.bind(null,s),t.ce&&t.ce(s),s}let Pt=null;const je=()=>Pt||Nn;let cg,ro,n_="__VUE_INSTANCE_SETTERS__";(ro=op()[n_])||(ro=op()[n_]=[]),ro.push(t=>Pt=t),cg=t=>{ro.length>1?ro.forEach(e=>e(t)):ro[0](t)};const $o=t=>{cg(t),t.scope.on()},vs=()=>{Pt&&Pt.scope.off(),cg(null)};function rI(t){return t.vnode.shapeFlag&4}let Il=!1;function aN(t,e=!1){Il=e;const{props:n,children:i}=t.vnode,r=rI(t);V1(t,n,r,e),H1(t,i);const s=r?lN(t,e):void 0;return Il=!1,s}function lN(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=zh(new Proxy(t.ctx,P1));const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?uN(t):null;$o(t),aa();const s=yr(i,t,0,[t.props,r]);if(la(),vs(),oE(s)){if(s.then(vs,vs),e)return s.then(o=>{i_(t,o,e)}).catch(o=>{jh(o,t,0)});t.asyncDep=s}else i_(t,s,e)}else sI(t,e)}function i_(t,e,n){Se(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ct(e)&&(t.setupState=AE(e)),sI(t,n)}let r_;function sI(t,e,n){const i=t.type;if(!t.render){if(!e&&r_&&!i.render){const r=i.template||sg(t).template;if(r){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=i,c=Ct(Ct({isCustomElement:s,delimiters:a},o),l);i.render=r_(r,c)}}t.render=i.render||ni}$o(t),aa(),M1(t),la(),vs()}function cN(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return Tn(t,"get","$attrs"),e[n]}}))}function uN(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return cN(t)},slots:t.slots,emit:t.emit,expose:e}}function Jh(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(AE(zh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in tl)return tl[n](t)},has(e,n){return n in e||n in tl}}))}function hN(t,e=!0){return Se(t)?t.displayName||t.name:t.name||e&&t.__name}function dN(t){return Se(t)&&"__vccOpts"in t}const I=(t,e)=>c1(t,e,Il);function M(t,e,n){const i=arguments.length;return i===2?ct(e)&&!ve(e)?wp(e)?Ee(t,null,[e]):Ee(t,e):Ee(t,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&wp(n)&&(n=[n]),Ee(t,e,n))}const oI=Symbol.for("v-scx"),fN=()=>Ft(oI),pN="3.3.4",mN="http://www.w3.org/2000/svg",is=typeof document<"u"?document:null,s_=is&&is.createElement("template"),gN={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e?is.createElementNS(mN,t):is.createElement(t,n?{is:n}:void 0);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>is.createTextNode(t),createComment:t=>is.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>is.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{s_.innerHTML=i?`<svg>${t}</svg>`:t;const a=s_.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function vN(t,e,n){const i=t._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function yN(t,e,n){const i=t.style,r=bt(n);if(n&&!r){if(e&&!bt(e))for(const s in e)n[s]==null&&bp(i,s,"");for(const s in n)bp(i,s,n[s])}else{const s=i.display;r?e!==n&&(i.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(i.display=s)}}const o_=/\s*!important$/;function bp(t,e,n){if(ve(n))n.forEach(i=>bp(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=_N(t,e);o_.test(n)?t.setProperty(js(i),n.replace(o_,""),"important"):t[i]=n}}const a_=["Webkit","Moz","ms"],lf={};function _N(t,e){const n=lf[e];if(n)return n;let i=xi(e);if(i!=="filter"&&i in t)return lf[e]=i;i=qh(i);for(let r=0;r<a_.length;r++){const s=a_[r]+i;if(s in t)return lf[e]=s}return e}const l_="http://www.w3.org/1999/xlink";function wN(t,e,n,i,r){if(i&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(l_,e.slice(6,e.length)):t.setAttributeNS(l_,e,n);else{const s=AR(e);n==null||s&&!cE(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function bN(t,e,n,i,r,s,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,r,s),t[e]=n??"";return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=n;const c=a==="OPTION"?t.getAttribute("value"):t.value,u=n??"";c!==u&&(t.value=u),n==null&&t.removeAttribute(e);return}let l=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=cE(n):n==null&&c==="string"?(n="",l=!0):c==="number"&&(n=0,l=!0)}try{t[e]=n}catch{}l&&t.removeAttribute(e)}function EN(t,e,n,i){t.addEventListener(e,n,i)}function IN(t,e,n,i){t.removeEventListener(e,n,i)}function TN(t,e,n,i,r=null){const s=t._vei||(t._vei={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=SN(e);if(i){const c=s[e]=xN(i,r);EN(t,a,c,l)}else o&&(IN(t,a,o,l),s[e]=void 0)}}const c_=/(?:Once|Passive|Capture)$/;function SN(t){let e;if(c_.test(t)){e={};let i;for(;i=t.match(c_);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):js(t.slice(2)),e]}let cf=0;const CN=Promise.resolve(),kN=()=>cf||(CN.then(()=>cf=0),cf=Date.now());function xN(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;zn(AN(i,n.value),e,5,[i])};return n.value=t,n.attached=kN(),n}function AN(t,e){if(ve(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const u_=/^on[a-z]/,RN=(t,e,n,i,r=!1,s,o,a,l)=>{e==="class"?vN(t,i,r):e==="style"?yN(t,n,i):Fh(e)?jm(e)||TN(t,e,n,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):NN(t,e,i,r))?bN(t,e,i,s,o,a,l):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),wN(t,e,i,r))};function NN(t,e,n,i){return i?!!(e==="innerHTML"||e==="textContent"||e in t&&u_.test(e)&&Se(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||u_.test(e)&&bt(n)?!1:e in t}const Zi="transition",ka="animation",Cs=(t,{slots:e})=>M(S1,DN(t),e);Cs.displayName="Transition";const aI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Cs.props=Ct({},BE,aI);const Wr=(t,e=[])=>{ve(t)?t.forEach(n=>n(...e)):t&&t(...e)},h_=t=>t?ve(t)?t.some(e=>e.length>1):t.length>1:!1;function DN(t){const e={};for(const R in t)R in aI||(e[R]=t[R]);if(t.css===!1)return e;const{name:n="v",type:i,duration:r,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=ON(r),m=p&&p[0],g=p&&p[1],{onBeforeEnter:w,onEnter:v,onEnterCancelled:b,onLeave:E,onLeaveCancelled:P,onBeforeAppear:C=w,onAppear:B=v,onAppearCancelled:N=b}=e,S=(R,X,$)=>{Gr(R,X?u:a),Gr(R,X?c:o),$&&$()},k=(R,X)=>{R._isLeaving=!1,Gr(R,h),Gr(R,f),Gr(R,d),X&&X()},V=R=>(X,$)=>{const le=R?B:v,ie=()=>S(X,R,$);Wr(le,[X,ie]),d_(()=>{Gr(X,R?l:s),er(X,R?u:a),h_(le)||f_(X,i,m,ie)})};return Ct(e,{onBeforeEnter(R){Wr(w,[R]),er(R,s),er(R,o)},onBeforeAppear(R){Wr(C,[R]),er(R,l),er(R,c)},onEnter:V(!1),onAppear:V(!0),onLeave(R,X){R._isLeaving=!0;const $=()=>k(R,X);er(R,h),LN(),er(R,d),d_(()=>{R._isLeaving&&(Gr(R,h),er(R,f),h_(E)||f_(R,i,g,$))}),Wr(E,[R,$])},onEnterCancelled(R){S(R,!1),Wr(b,[R])},onAppearCancelled(R){S(R,!0),Wr(N,[R])},onLeaveCancelled(R){k(R),Wr(P,[R])}})}function ON(t){if(t==null)return null;if(ct(t))return[uf(t.enter),uf(t.leave)];{const e=uf(t);return[e,e]}}function uf(t){return IR(t)}function er(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function Gr(t,e){e.split(/\s+/).forEach(i=>i&&t.classList.remove(i));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function d_(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let PN=0;function f_(t,e,n,i){const r=t._endId=++PN,s=()=>{r===t._endId&&i()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:l}=MN(t,e);if(!o)return i();const c=o+"end";let u=0;const h=()=>{t.removeEventListener(c,d),s()},d=f=>{f.target===t&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),t.addEventListener(c,d)}function MN(t,e){const n=window.getComputedStyle(t),i=p=>(n[p]||"").split(", "),r=i(`${Zi}Delay`),s=i(`${Zi}Duration`),o=p_(r,s),a=i(`${ka}Delay`),l=i(`${ka}Duration`),c=p_(a,l);let u=null,h=0,d=0;e===Zi?o>0&&(u=Zi,h=o,d=s.length):e===ka?c>0&&(u=ka,h=c,d=l.length):(h=Math.max(o,c),u=h>0?o>c?Zi:ka:null,d=u?u===Zi?s.length:l.length:0);const f=u===Zi&&/\b(transform|all)(,|$)/.test(i(`${Zi}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function p_(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,i)=>m_(n)+m_(t[i])))}function m_(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function LN(){return document.body.offsetHeight}const FN={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},lI=(t,e)=>n=>{if(!("key"in n))return;const i=js(n.key);if(e.some(r=>r===i||FN[r]===i))return t(n)},BN=Ct({patchProp:RN},gN);let g_;function $N(){return g_||(g_=W1(BN))}const qN=(...t)=>{const e=$N().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=UN(i);if(!r)return;const s=e._component;!Se(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function UN(t){return bt(t)?document.querySelector(t):t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(t,e){if(!t)throw ca(e)},ca=function(t){return new Error("Firebase Database ("+cI.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},VN=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Zh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),i.push(n[u],n[h],n[d],n[f])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(uI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):VN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||c==null||h==null)throw new zN;const d=s<<2|a>>4;if(i.push(d),c!==64){const f=a<<4&240|c>>2;if(i.push(f),h!==64){const p=c<<6&192|h;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hI=function(t){const e=uI(t);return Zh.encodeByteArray(e,!0)},Hu=function(t){return hI(t).replace(/\./g,"")},Ku=function(t){try{return Zh.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(t){return Tl(void 0,t)}function Tl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!HN(n)||(t[n]=Tl(t[n],e[n]));return t}function HN(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN=()=>KN().__FIREBASE_DEFAULTS__,GN=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ku(t[1]);return e&&JSON.parse(e)},ed=()=>{try{return WN()||GN()||QN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dI=t=>{var e,n;return(n=(e=ed())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},fI=t=>{const e=dI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},pI=()=>{var t;return(t=ed())===null||t===void 0?void 0:t.config},mI=t=>{var e;return(e=ed())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Hu(JSON.stringify(n)),Hu(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ug(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kt())}function vI(){var t;const e=(t=ed())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YN(){return typeof self=="object"&&self.self===self}function XN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JN(){const t=kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _I(){return cI.NODE_ADMIN===!0}function ZN(){return!vI()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hg(){try{return typeof indexedDB=="object"}catch{return!1}}function eD(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD="FirebaseError";class ui extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=tD,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Br.prototype.create)}}class Br{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?nD(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ui(r,a,i)}}function nD(t,e){return t.replace(iD,(n,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const iD=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cl(t){return JSON.parse(t)}function Wt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=function(t){let e={},n={},i={},r="";try{const s=t.split(".");e=Cl(Ku(s[0])||""),n=Cl(Ku(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:i,signature:r}},rD=function(t){const e=wI(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},sD=function(t){const e=wI(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qo(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ep(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wu(t,e,n){const i={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function Gu(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const s=t[r],o=e[r];if(v_(s)&&v_(o)){if(!Gu(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function v_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const i=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)i[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)i[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=i[h-3]^i[h-8]^i[h-14]^i[h-16];i[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):h<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);const d=(r<<5|r>>>27)+c+l+u+i[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const i=n-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<n;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}}function bI(t,e){const n=new aD(t,e);return n.subscribe.bind(n)}class aD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");lD(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=hf),r.error===void 0&&(r.error=hf),r.complete===void 0&&(r.complete=hf);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function hf(){}function cD(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,ee(i<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},td=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t){return t&&t._delegate?t._delegate:t}class Pn{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new Sl;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fD(e))try{this.getOrInitializeService({instanceIdentifier:Xr})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Xr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xr){return this.instances.has(e)}getOptions(e=Xr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;const r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dD(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Xr){return this.component?this.component.multipleInstances?e:Xr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dD(t){return t===Xr?void 0:t}function fD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg=[];var Ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ne||(Ne={}));const EI={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},mD=Ne.INFO,gD={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},vD=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),r=gD[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ha{constructor(e){this.name=e,this._logLevel=mD,this._logHandler=vD,this._userLogHandler=null,dg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}function yD(t){dg.forEach(e=>{e.setLogLevel(t)})}function _D(t,e){for(const n of dg){let i=null;e&&e.level&&(i=EI[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(i??r.logLevel)&&t({level:Ne[s].toLowerCase(),message:a,args:o,type:r.name})}}}const wD=(t,e)=>e.some(n=>t instanceof n);let y_,__;function bD(){return y_||(y_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ED(){return __||(__=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const II=new WeakMap,Ip=new WeakMap,TI=new WeakMap,df=new WeakMap,fg=new WeakMap;function ID(t){const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(wr(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&II.set(n,t)}).catch(()=>{}),fg.set(e,t),e}function TD(t){if(Ip.has(t))return;const e=new Promise((n,i)=>{const r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Ip.set(t,e)}let Tp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ip.get(t);if(e==="objectStoreNames")return t.objectStoreNames||TI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return wr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SD(t){Tp=t(Tp)}function CD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(ff(this),e,...n);return TI.set(i,e.sort?e.sort():[e]),wr(i)}:ED().includes(t)?function(...e){return t.apply(ff(this),e),wr(II.get(this))}:function(...e){return wr(t.apply(ff(this),e))}}function kD(t){return typeof t=="function"?CD(t):(t instanceof IDBTransaction&&TD(t),wD(t,bD())?new Proxy(t,Tp):t)}function wr(t){if(t instanceof IDBRequest)return ID(t);if(df.has(t))return df.get(t);const e=kD(t);return e!==t&&(df.set(t,e),fg.set(e,t)),e}const ff=t=>fg.get(t);function xD(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=wr(o);return i&&o.addEventListener("upgradeneeded",l=>{i(wr(o.result),l.oldVersion,l.newVersion,wr(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const AD=["get","getKey","getAll","getAllKeys","count"],RD=["put","add","delete","clear"],pf=new Map;function w_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pf.get(e))return pf.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=RD.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||AD.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return pf.set(e,s),s}SD(t=>({...t,get:(e,n,i)=>w_(e,n)||t.get(e,n,i),has:(e,n)=>!!w_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DD(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function DD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sp="@firebase/app",b_="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new ha("@firebase/app"),OD="@firebase/app-compat",PD="@firebase/analytics-compat",MD="@firebase/analytics",LD="@firebase/app-check-compat",FD="@firebase/app-check",BD="@firebase/auth",$D="@firebase/auth-compat",qD="@firebase/database",UD="@firebase/database-compat",VD="@firebase/functions",zD="@firebase/functions-compat",jD="@firebase/installations",HD="@firebase/installations-compat",KD="@firebase/messaging",WD="@firebase/messaging-compat",GD="@firebase/performance",QD="@firebase/performance-compat",YD="@firebase/remote-config",XD="@firebase/remote-config-compat",JD="@firebase/storage",ZD="@firebase/storage-compat",eO="@firebase/firestore",tO="@firebase/firestore-compat",nO="firebase",iO="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr="[DEFAULT]",rO={[Sp]:"fire-core",[OD]:"fire-core-compat",[MD]:"fire-analytics",[PD]:"fire-analytics-compat",[FD]:"fire-app-check",[LD]:"fire-app-check-compat",[BD]:"fire-auth",[$D]:"fire-auth-compat",[qD]:"fire-rtdb",[UD]:"fire-rtdb-compat",[VD]:"fire-fn",[zD]:"fire-fn-compat",[jD]:"fire-iid",[HD]:"fire-iid-compat",[KD]:"fire-fcm",[WD]:"fire-fcm-compat",[GD]:"fire-perf",[QD]:"fire-perf-compat",[YD]:"fire-rc",[XD]:"fire-rc-compat",[JD]:"fire-gcs",[ZD]:"fire-gcs-compat",[eO]:"fire-fst",[tO]:"fire-fst-compat","fire-js":"fire-js",[nO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=new Map,kl=new Map;function Qu(t,e){try{t.container.addComponent(e)}catch(n){ks.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function SI(t,e){t.container.addOrOverwriteComponent(e)}function Kn(t){const e=t.name;if(kl.has(e))return ks.debug(`There were multiple attempts to register component ${e}.`),!1;kl.set(e,t);for(const n of Cr.values())Qu(n,t);return!0}function da(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function sO(t,e,n=Sr){da(t,e).clearInstance(n)}function oO(){kl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ui=new Br("app","Firebase",aO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lO=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ui.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=iO;function nd(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Sr,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw Ui.create("bad-app-name",{appName:String(r)});if(n||(n=pI()),!n)throw Ui.create("no-options");const s=Cr.get(r);if(s){if(Gu(n,s.options)&&Gu(i,s.config))return s;throw Ui.create("duplicate-app",{appName:r})}const o=new pD(r);for(const l of kl.values())o.addComponent(l);const a=new lO(n,i,o);return Cr.set(r,a),a}function ic(t=Sr){const e=Cr.get(t);if(!e&&t===Sr&&pI())return nd();if(!e)throw Ui.create("no-app",{appName:t});return e}function cO(){return Array.from(Cr.values())}async function CI(t){const e=t.name;Cr.has(e)&&(Cr.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function an(t,e,n){var i;let r=(i=rO[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ks.warn(a.join(" "));return}Kn(new Pn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function kI(t,e){if(t!==null&&typeof t!="function")throw Ui.create("invalid-log-argument");_D(t,e)}function xI(t){yD(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO="firebase-heartbeat-database",hO=1,xl="firebase-heartbeat-store";let mf=null;function AI(){return mf||(mf=xD(uO,hO,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(xl)}}}).catch(t=>{throw Ui.create("idb-open",{originalErrorMessage:t.message})})),mf}async function dO(t){try{return await(await AI()).transaction(xl).objectStore(xl).get(RI(t))}catch(e){if(e instanceof ui)ks.warn(e.message);else{const n=Ui.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ks.warn(n.message)}}}async function E_(t,e){try{const i=(await AI()).transaction(xl,"readwrite");await i.objectStore(xl).put(e,RI(t)),await i.done}catch(n){if(n instanceof ui)ks.warn(n.message);else{const i=Ui.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ks.warn(i.message)}}}function RI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=1024,pO=30*24*60*60*1e3;class mO{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new vO(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=I_();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const s=new Date(r.date).valueOf();return Date.now()-s<=pO}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=I_(),{heartbeatsToSend:n,unsentEntries:i}=gO(this._heartbeatsCache.heartbeats),r=Hu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function I_(){return new Date().toISOString().substring(0,10)}function gO(t,e=fO){const n=[];let i=t.slice();for(const r of t){const s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),T_(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),T_(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class vO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hg()?eD().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await dO(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return E_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return E_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function T_(t){return Hu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t){Kn(new Pn("platform-logger",e=>new ND(e),"PRIVATE")),Kn(new Pn("heartbeat",e=>new mO(e),"PRIVATE")),an(Sp,b_,t),an(Sp,b_,"esm2017"),an("fire-js","")}yO("");const _O=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:ui,SDK_VERSION:Oi,_DEFAULT_ENTRY_NAME:Sr,_addComponent:Qu,_addOrOverwriteComponent:SI,_apps:Cr,_clearComponents:oO,_components:kl,_getProvider:da,_registerComponent:Kn,_removeServiceInstance:sO,deleteApp:CI,getApp:ic,getApps:cO,initializeApp:nd,onLog:kI,registerVersion:an,setLogLevel:xI},Symbol.toStringTag,{value:"Module"}));function pg(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function NI(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wO=NI,DI=new Br("auth","Firebase",NI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=new ha("@firebase/auth");function bO(t,...e){Yu.logLevel<=Ne.WARN&&Yu.warn(`Auth (${Oi}): ${t}`,...e)}function Su(t,...e){Yu.logLevel<=Ne.ERROR&&Yu.error(`Auth (${Oi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t,...e){throw mg(t,...e)}function Ii(t,...e){return mg(t,...e)}function OI(t,e,n){const i=Object.assign(Object.assign({},wO()),{[e]:n});return new Br("auth","Firebase",i).create(e,{appName:t.name})}function EO(t,e,n){const i=n;if(!(e instanceof i))throw i.name!==e.constructor.name&&Ai(t,"argument-error"),OI(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function mg(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return DI.create(t,...e)}function we(t,e,...n){if(!t)throw mg(e,...n)}function Li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Su(e),new Error(e)}function Hi(t,e){t||Li(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function IO(){return S_()==="http:"||S_()==="https:"}function S_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IO()||XN()||"connection"in navigator)?navigator.onLine:!0}function SO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Hi(n>e,"Short delay should be less than long delay!"),this.isMobile=ug()||yI()}get(){return TO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t,e){Hi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=new rc(3e4,6e4);function MI(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function sc(t,e,n,i,r={}){return LI(t,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=ua(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),PI.fetch()(FI(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},s))})}async function LI(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},CO),e);try{const r=new AO(t),s=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Wc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wc(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Wc(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Wc(t,"user-disabled",o);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw OI(t,u,c);Ai(t,u)}}catch(r){if(r instanceof ui)throw r;Ai(t,"network-request-failed",{message:String(r)})}}async function xO(t,e,n,i,r={}){const s=await sc(t,e,n,i,r);return"mfaPendingCredential"in s&&Ai(t,"multi-factor-auth-required",{_serverResponse:s}),s}function FI(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?gg(t.config,r):`${t.config.apiScheme}://${r}`}class AO{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(Ii(this.auth,"network-request-failed")),kO.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Wc(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Ii(t,e,i);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RO(t,e){return sc(t,"POST","/v1/accounts:delete",e)}async function NO(t,e){return sc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function DO(t,e=!1){const n=Ve(t),i=await n.getIdToken(e),r=vg(i);we(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:rl(gf(r.auth_time)),issuedAtTime:rl(gf(r.iat)),expirationTime:rl(gf(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function gf(t){return Number(t)*1e3}function vg(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ku(n);return r?JSON.parse(r):(Su("Failed to decode base64 JWT payload"),null)}catch(r){return Su("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function OO(t){const e=vg(t);return we(e,"internal-error"),we(typeof e.exp<"u","internal-error"),we(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Al(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof ui&&PO(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function PO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=rl(this.lastLoginAt),this.creationTime=rl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xu(t){var e;const n=t.auth,i=await t.getIdToken(),r=await Al(t,NO(n,{idToken:i}));we(r==null?void 0:r.users.length,n,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?BO(s.providerUserInfo):[],a=FO(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new BI(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function LO(t){const e=Ve(t);await Xu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function FO(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function BO(t){return t.map(e=>{var{providerId:n}=e,i=pg(e,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $O(t,e){const n=await LI(t,{},async()=>{const i=ua({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=FI(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",PI.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){we(e.idToken,"internal-error"),we(typeof e.idToken<"u","internal-error"),we(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return we(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:r,expiresIn:s}=await $O(e,n);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new Rl;return i&&(we(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(we(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(we(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rl,this.toJSON())}_performRefresh(){return Li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){we(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ys{constructor(e){var{uid:n,auth:i,stsTokenManager:r}=e,s=pg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new BI(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Al(this,this.stsTokenManager.getToken(this.auth,e));return we(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return DO(this,e)}reload(){return LO(this)}_assign(e){this!==e&&(we(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ys(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){we(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Xu(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Al(this,RO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var i,r,s,o,a,l,c,u;const h=(i=n.displayName)!==null&&i!==void 0?i:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,m=(a=n.tenantId)!==null&&a!==void 0?a:void 0,g=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:b,emailVerified:E,isAnonymous:P,providerData:C,stsTokenManager:B}=n;we(b&&B,e,"internal-error");const N=Rl.fromJSON(this.name,B);we(typeof b=="string",e,"internal-error"),tr(h,e.name),tr(d,e.name),we(typeof E=="boolean",e,"internal-error"),we(typeof P=="boolean",e,"internal-error"),tr(f,e.name),tr(p,e.name),tr(m,e.name),tr(g,e.name),tr(w,e.name),tr(v,e.name);const S=new ys({uid:b,auth:e,email:d,emailVerified:E,displayName:h,isAnonymous:P,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:N,createdAt:w,lastLoginAt:v});return C&&Array.isArray(C)&&(S.providerData=C.map(k=>Object.assign({},k))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,n,i=!1){const r=new Rl;r.updateFromServerResponse(n);const s=new ys({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Xu(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=new Map;function Fi(t){Hi(t instanceof Function,"Expected a class definition");let e=C_.get(t);return e?(Hi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,C_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}$I.type="NONE";const k_=$I;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(t,e,n){return`firebase:${t}:${e}:${n}`}class xo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Cu(this.userKey,r.apiKey,s),this.fullPersistenceKey=Cu("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ys._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new xo(Fi(k_),e,i);const r=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=r[0]||Fi(k_);const o=Cu(i,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){const h=ys._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new xo(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new xo(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(jI(e))return"Blackberry";if(HI(e))return"Webos";if(yg(e))return"Safari";if((e.includes("chrome/")||UI(e))&&!e.includes("edge/"))return"Chrome";if(zI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function qI(t=kt()){return/firefox\//i.test(t)}function yg(t=kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UI(t=kt()){return/crios\//i.test(t)}function VI(t=kt()){return/iemobile/i.test(t)}function zI(t=kt()){return/android/i.test(t)}function jI(t=kt()){return/blackberry/i.test(t)}function HI(t=kt()){return/webos/i.test(t)}function id(t=kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function qO(t=kt()){var e;return id(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function UO(){return JN()&&document.documentMode===10}function KI(t=kt()){return id(t)||zI(t)||HI(t)||jI(t)||/windows phone/i.test(t)||VI(t)}function VO(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(t,e=[]){let n;switch(t){case"Browser":n=x_(kt());break;case"Worker":n=`${x_(kt())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Oi}/${i}`}async function GI(t,e){return sc(t,"GET","/v2/recaptchaConfig",MI(t,e))}function A_(t){return t!==void 0&&t.enterprise!==void 0}class QI{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function YI(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{const s=Ii("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",zO().appendChild(i)})}function jO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const HO="https://www.google.com/recaptcha/enterprise.js?render=",KO="recaptcha-enterprise",WO="NO_RECAPTCHA";class GO{constructor(e){this.type=KO,this.auth=oc(e)}async verify(e="verify",n=!1){async function i(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{GI(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new QI(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;A_(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(WO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{i(this.auth).then(a=>{if(!n&&A_(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}YI(HO+a).then(()=>{r(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=n,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,n,i,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new R_(this),this.idTokenSubscription=new R_(this),this.beforeStateQueue=new QO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Fi(n)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await xo.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return we(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Xu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=SO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Ve(e):null;return n&&we(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&we(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Fi(e))})}async initializeRecaptchaConfig(){const e=await GI(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new QI(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new GO(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Br("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Fi(e)||this._popupRedirectResolver;we(n,this,"argument-error"),this.redirectPersistenceManager=await xo.create(this,[Fi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,i;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return we(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof n=="function"?e.addObserver(n,i,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return we(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=WI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(n["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&bO(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function oc(t){return Ve(t)}class R_{constructor(e){this.auth=e,this.observer=null,this.addObserver=bI(n=>this.observer=n)}get next(){return we(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(t,e){const n=da(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),s=n.getOptions();if(Gu(s,e??{}))return r;Ai(r,"already-initialized")}return n.initialize({options:e})}function JO(t,e){const n=(e==null?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Fi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function ZO(t,e,n){const i=oc(t);we(i._canInitEmulator,i,"emulator-config-failed"),we(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),s=XI(e),{host:o,port:a}=eP(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||tP()}function XI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function eP(t){const e=XI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:N_(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:N_(o)}}}function N_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function tP(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Li("not implemented")}_getIdTokenResponse(e){return Li("not implemented")}_linkToIdToken(e,n){return Li("not implemented")}_getReauthenticationResolver(e){return Li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(t,e){return xO(t,"POST","/v1/accounts:signInWithIdp",MI(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP="http://localhost";class xs extends JI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ai("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=n,s=pg(n,["providerId","signInMethod"]);if(!i||!r)return null;const o=new xs(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ao(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Ao(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ao(e,n)}buildRequest(){const e={requestUri:nP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ua(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends _g{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends ac{constructor(){super("facebook.com")}static credential(e){return xs._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return lr.credential(e.oauthAccessToken)}catch{return null}}}lr.FACEBOOK_SIGN_IN_METHOD="facebook.com";lr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xs._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return cr.credential(n,i)}catch{return null}}}cr.GOOGLE_SIGN_IN_METHOD="google.com";cr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends ac{constructor(){super("github.com")}static credential(e){return xs._fromParams({providerId:ur.PROVIDER_ID,signInMethod:ur.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ur.credentialFromTaggedObject(e)}static credentialFromError(e){return ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ur.credential(e.oauthAccessToken)}catch{return null}}}ur.GITHUB_SIGN_IN_METHOD="github.com";ur.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends ac{constructor(){super("twitter.com")}static credential(e,n){return xs._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return hr.credential(n,i)}catch{return null}}}hr.TWITTER_SIGN_IN_METHOD="twitter.com";hr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,r=!1){const s=await ys._fromIdTokenResponse(e,i,r),o=D_(i);return new Uo({user:s,providerId:o,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const r=D_(i);return new Uo({user:e,providerId:r,_tokenResponse:i,operationType:n})}}function D_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends ui{constructor(e,n,i,r){var s;super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Ju.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,r){return new Ju(e,n,i,r)}}function ZI(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ju._fromErrorAndOperation(t,s,e,i):s})}async function iP(t,e,n=!1){const i=await Al(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Uo._forOperation(t,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rP(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await Al(t,ZI(i,r,e,t),n);we(s.idToken,i,"internal-error");const o=vg(s.idToken);we(o,i,"internal-error");const{sub:a}=o;return we(t.uid===a,i,"user-mismatch"),Uo._forOperation(t,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ai(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sP(t,e,n=!1){const i="signIn",r=await ZI(t,i,e),s=await Uo._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}function eT(t,e,n,i){return Ve(t).onIdTokenChanged(e,n,i)}function oP(t,e,n){return Ve(t).beforeAuthStateChanged(e,n)}function aP(t){return Ve(t).signOut()}const Zu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Zu,"1"),this.storage.removeItem(Zu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(){const t=kt();return yg(t)||id(t)}const cP=1e3,uP=10;class nT extends tT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=lP()&&VO(),this.fallbackToPolling=KI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),r=this.localCache[n];i!==r&&e(n,r,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(i);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(i,e.newValue):this.storage.removeItem(i);else if(this.localCache[i]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(i);!n&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);UO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,uP):r()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},cP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}nT.type="LOCAL";const hP=nT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT extends tT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}iT.type="SESSION";const rT=iT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dP(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const i=new rd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:r,data:s}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await dP(a);n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=wg("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return window}function pP(t){Ti().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(){return typeof Ti().WorkerGlobalScope<"u"&&typeof Ti().importScripts=="function"}async function mP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gP(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function vP(){return sT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="firebaseLocalStorageDb",yP=1,eh="firebaseLocalStorage",aT="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sd(t,e){return t.transaction([eh],e?"readwrite":"readonly").objectStore(eh)}function _P(){const t=indexedDB.deleteDatabase(oT);return new lc(t).toPromise()}function kp(){const t=indexedDB.open(oT,yP);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(eh,{keyPath:aT})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(eh)?e(i):(i.close(),await _P(),e(await kp()))})})}async function O_(t,e,n){const i=sd(t,!0).put({[aT]:e,value:n});return new lc(i).toPromise()}async function wP(t,e){const n=sd(t,!1).get(e),i=await new lc(n).toPromise();return i===void 0?null:i.value}function P_(t,e){const n=sd(t,!0).delete(e);return new lc(n).toPromise()}const bP=800,EP=3;class lT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>EP)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rd._getInstance(vP()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await mP(),!this.activeServiceWorker)return;this.sender=new fP(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((n=i[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kp();return await O_(e,Zu,"1"),await P_(e,Zu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>O_(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>wP(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>P_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=sd(r,!1).getAll();return new lc(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lT.type="LOCAL";const IP=lT;new rc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(t,e){return e?Fi(e):(we(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends JI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ao(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ao(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ao(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function TP(t){return sP(t.auth,new bg(t),t.bypassAuthState)}function SP(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),rP(n,new bg(t),t.bypassAuthState)}async function CP(t){const{auth:e,user:n}=t;return we(n,e,"internal-error"),iP(n,new bg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,n,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return TP;case"linkViaPopup":case"linkViaRedirect":return CP;case"reauthViaPopup":case"reauthViaRedirect":return SP;default:Ai(this.auth,"internal-error")}}resolve(e){Hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP=new rc(2e3,1e4);class yo extends uT{constructor(e,n,i,r,s){super(e,n,r,s),this.provider=i,this.authWindow=null,this.pollId=null,yo.currentPopupAction&&yo.currentPopupAction.cancel(),yo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return we(e,this.auth,"internal-error"),e}async onExecution(){Hi(this.filter.length===1,"Popup operations only handle one event");const e=wg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ii(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ii(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,i;if(!((i=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ii(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kP.get())};e()}}yo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="pendingRedirect",ku=new Map;class AP extends uT{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ku.get(this.auth._key());if(!e){try{const i=await RP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ku.set(this.auth._key(),e)}return this.bypassAuthState||ku.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function RP(t,e){const n=dT(e),i=hT(t);if(!await i._isAvailable())return!1;const r=await i._get(n)==="true";return await i._remove(n),r}async function NP(t,e){return hT(t)._set(dT(e),"true")}function DP(t,e){ku.set(t._key(),e)}function hT(t){return Fi(t._redirectPersistence)}function dT(t){return Cu(xP,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SK(t,e,n){return OP(t,e,n)}async function OP(t,e,n){const i=oc(t);EO(t,e,_g),await i._initializationPromise;const r=cT(i,n);return await NP(r,i),r._openRedirect(i,e,"signInViaRedirect")}async function PP(t,e,n=!1){const i=oc(t),r=cT(i,e),o=await new AP(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP=10*60*1e3;class LP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!FP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var i;if(e.error&&!fT(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(Ii(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MP&&this.cachedEventUids.clear(),this.cachedEventUids.has(M_(e))}saveEventToCache(e){this.cachedEventUids.add(M_(e)),this.lastProcessedEventTime=Date.now()}}function M_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function FP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BP(t,e={}){return sc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qP=/^https?/;async function UP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BP(t);for(const n of e)try{if(VP(n))return}catch{}Ai(t,"unauthorized-domain")}function VP(t){const e=Cp(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!qP.test(n))return!1;if($P.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=new rc(3e4,6e4);function L_(){const t=Ti().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function jP(t){return new Promise((e,n)=>{var i,r,s;function o(){L_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{L_(),n(Ii(t,"network-request-failed"))},timeout:zP.get()})}if(!((r=(i=Ti().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Ti().gapi)===null||s===void 0)&&s.load)o();else{const a=jO("iframefcb");return Ti()[a]=()=>{gapi.load?o():n(Ii(t,"network-request-failed"))},YI(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw xu=null,e})}let xu=null;function HP(t){return xu=xu||jP(t),xu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=new rc(5e3,15e3),WP="__/auth/iframe",GP="emulator/auth/iframe",QP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},YP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XP(t){const e=t.config;we(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?gg(e,GP):`https://${t.config.authDomain}/${WP}`,i={apiKey:e.apiKey,appName:t.name,v:Oi},r=YP.get(t.config.apiHost);r&&(i.eid=r);const s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${ua(i).slice(1)}`}async function JP(t){const e=await HP(t),n=Ti().gapi;return we(n,t,"internal-error"),e.open({where:document.body,url:XP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QP,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Ii(t,"network-request-failed"),a=Ti().setTimeout(()=>{s(o)},KP.get());function l(){Ti().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},eM=500,tM=600,nM="_blank",iM="http://localhost";class F_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rM(t,e,n,i=eM,r=tM){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},ZP),{width:i.toString(),height:r.toString(),top:s,left:o}),c=kt().toLowerCase();n&&(a=UI(c)?nM:n),qI(c)&&(e=e||iM,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(qO(c)&&a!=="_self")return sM(e||"",a),new F_(null);const h=window.open(e||"",a,u);we(h,t,"popup-blocked");try{h.focus()}catch{}return new F_(h)}function sM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="__/auth/handler",aM="emulator/auth/handler",lM=encodeURIComponent("fac");async function B_(t,e,n,i,r,s){we(t.config.authDomain,t,"auth-domain-config-required"),we(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:Oi,eventId:r};if(e instanceof _g){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ep(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries(s||{}))o[u]=h}if(e instanceof ac){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${lM}=${encodeURIComponent(l)}`:"";return`${cM(t)}?${ua(a).slice(1)}${c}`}function cM({config:t}){return t.emulator?gg(t,aM):`https://${t.authDomain}/${oM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vf="webStorageSupport";class uM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rT,this._completeRedirectFn=PP,this._overrideRedirectResult=DP}async _openPopup(e,n,i,r){var s;Hi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await B_(e,n,i,Cp(),r);return rM(e,o,wg())}async _openRedirect(e,n,i,r){await this._originValidation(e);const s=await B_(e,n,i,Cp(),r);return pP(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(Hi(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await JP(e),i=new LP(e);return n.register("authEvent",r=>(we(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(vf,{type:vf},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[vf];o!==void 0&&n(!!o),Ai(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=UP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return KI()||yg()||id()}}const hM=uM;var $_="@firebase/auth",q_="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){we(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function pM(t){Kn(new Pn("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;we(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:WI(t)},c=new YO(i,r,s,l);return JO(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Kn(new Pn("auth-internal",e=>{const n=oc(e.getProvider("auth").getImmediate());return(i=>new dM(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),an($_,q_,fM(t)),an($_,q_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mM=5*60,gM=mI("authIdTokenMaxAge")||mM;let U_=null;const vM=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>gM)return;const r=n==null?void 0:n.token;U_!==r&&(U_=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function pT(t=ic()){const e=da(t,"auth");if(e.isInitialized())return e.getImmediate();const n=XO(t,{popupRedirectResolver:hM,persistence:[IP,hP,rT]}),i=mI("authTokenSyncURL");if(i){const s=vM(i);oP(n,s,()=>s(n.currentUser)),eT(n,o=>s(o))}const r=dI("auth");return r&&ZO(n,`http://${r}`),n}pM("Browser");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM=new Map,_M={activated:!1,tokenObservers:[]};function oi(t){return yM.get(t)||Object.assign({},_M)}const V_={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,n,i,r,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Sl,await bM(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Sl,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function bM(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},th=new Br("appCheck","AppCheck",EM);function mT(t){if(!oi(t).activated)throw th.create("use-before-activation",{appName:t.name})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM="firebase-app-check-database",TM=1,xp="firebase-app-check-store";let Gc=null;function SM(){return Gc||(Gc=new Promise((t,e)=>{try{const n=indexedDB.open(IM,TM);n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{var r;e(th.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},n.onupgradeneeded=i=>{const r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(xp,{keyPath:"compositeKey"})}}}catch(n){e(th.create("storage-open",{originalErrorMessage:n==null?void 0:n.message}))}}),Gc)}function CM(t,e){return kM(xM(t),e)}async function kM(t,e){const i=(await SM()).transaction(xp,"readwrite"),s=i.objectStore(xp).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},i.onerror=l=>{var c;a(th.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})}function xM(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=new ha("@firebase/app-check");function z_(t,e){return hg()?CM(t,e).catch(n=>{Ap.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM={error:"UNKNOWN_ERROR"};function RM(t){return Zh.encodeString(JSON.stringify(t),!1)}async function Rp(t,e=!1){const n=t.app;mT(n);const i=oi(n);let r=i.token,s;if(r&&!Ka(r)&&(i.token=void 0,r=void 0),!r){const l=await i.cachedTokenPromise;l&&(Ka(l)?r=l:await z_(n,void 0))}if(!e&&r&&Ka(r))return{token:r.token};let o=!1;try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=await oi(n).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?Ap.warn(l.message):Ap.error(l),s=l}let a;return r?s?Ka(r)?a={token:r.token,internalError:s}:a=H_(s):(a={token:r.token},i.token=r,await z_(n,r)):a=H_(s),o&&PM(n,a),a}async function NM(t){const e=t.app;mT(e);const{provider:n}=oi(e);{const{token:i}=await n.getToken();return{token:i}}}function DM(t,e,n,i){const{app:r}=t,s=oi(r),o={next:n,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ka(s.token)){const a=s.token;Promise.resolve().then(()=>{n({token:a.token}),j_(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>j_(t))}function gT(t,e){const n=oi(t),i=n.tokenObservers.filter(r=>r.next!==e);i.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function j_(t){const{app:e}=t,n=oi(e);let i=n.tokenRefresher;i||(i=OM(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function OM(t){const{app:e}=t;return new wM(async()=>{const n=oi(e);let i;if(n.token?i=await Rp(t,!0):i=await Rp(t),i.error)throw i.error;if(i.internalError)throw i.internalError},()=>!0,()=>{const n=oi(e);if(n.token){let i=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const r=n.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},V_.RETRIAL_MIN_WAIT,V_.RETRIAL_MAX_WAIT)}function PM(t,e){const n=oi(t).tokenObservers;for(const i of n)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function Ka(t){return t.expireTimeMillis-Date.now()>0}function H_(t){return{token:RM(AM),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=oi(this.app);for(const n of e)gT(this.app,n.next);return Promise.resolve()}}function LM(t,e){return new MM(t,e)}function FM(t){return{getToken:e=>Rp(t,e),getLimitedUseToken:()=>NM(t),addTokenListener:e=>DM(t,"INTERNAL",e),removeTokenListener:e=>gT(t.app,e)}}const BM="@firebase/app-check",$M="0.8.0",qM="app-check",K_="app-check-internal";function UM(){Kn(new Pn(qM,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return LM(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(K_).initialize()})),Kn(new Pn(K_,t=>{const e=t.getProvider("app-check").getImmediate();return FM(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),an(BM,$M)}UM();var VM="firebase",zM="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */an(VM,zM,"app");const vT=Symbol("firebaseApp");function od(t){return je()&&Ft(vT,null)||ic(t)}const gi=()=>{};function Eg(t,e){return e.split(".").reduce((n,i)=>n&&n[i],t)}function jM(t,e,n){const i=(""+e).split("."),r=i.pop(),s=i.reduce((o,a)=>o&&o[a],t);if(s!=null)return Array.isArray(s)?s.splice(Number(r),1,n):s[r]=n}function Hs(t){return!!t&&typeof t=="object"}const HM=Object.prototype;function KM(t){return Hs(t)&&Object.getPrototypeOf(t)===HM}function Ig(t){return Hs(t)&&t.type==="document"}function yT(t){return Hs(t)&&t.type==="collection"}function WM(t){return Ig(t)||yT(t)}function GM(t){return Hs(t)&&t.type==="query"}function QM(t){return Hs(t)&&"ref"in t}function YM(t){return Hs(t)&&typeof t.bucket=="string"}function XM(t,e){let n;return()=>{if(!n)return n=!0,t(e())}}function JM(){return!!(je()&&Ft(oI,null))}const Qc=new WeakMap;function ZM(t,e){if(!Qc.has(t)){const n=RR(!0);Qc.set(t,n);const{unmount:i}=e;e.unmount=()=>{i.call(e),n.stop(),Qc.delete(t)}}return Qc.get(t)}const _T=new WeakMap;function Tg(t){return _T.get(od(t))}const Yc=new WeakMap;function wT(t){const e=od(t);if(!Yc.has(e)){let n;const r=[new Promise(s=>{n=s}),s=>{Yc.set(e,s),n(s.value)}];Yc.set(e,r)}return Yc.get(e)}function yf(t){const e=wT(t);return Array.isArray(e)?e[0]:Promise.resolve(e.value)}function eL(t,e){const n=pT(e);eT(n,i=>{const r=wT();t.value=i,Array.isArray(r)&&r[1](t)})}const W_="@firebase/database",G_="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bT="";function tL(t){bT=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Wt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Cl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return si(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new nL(e)}}catch{}return new iL},us=ET("localStorage"),Np=ET("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new ha("@firebase/database"),rL=function(){let t=1;return function(){return t++}}(),IT=function(t){const e=uD(t),n=new oD;n.update(e);const i=n.digest();return Zh.encodeByteArray(i)},cc=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=cc.apply(null,i):typeof i=="object"?e+=Wt(i):e+=i,e+=" "}return e};let _s=null,Q_=!0;const sL=function(t,e){ee(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Ro.logLevel=Ne.VERBOSE,_s=Ro.log.bind(Ro),e&&Np.set("logging_enabled",!0)):typeof t=="function"?_s=t:(_s=null,Np.remove("logging_enabled"))},tn=function(...t){if(Q_===!0&&(Q_=!1,_s===null&&Np.get("logging_enabled")===!0&&sL(!0)),_s){const e=cc.apply(null,t);_s(e)}},uc=function(t){return function(...e){tn(t,...e)}},Dp=function(...t){const e="FIREBASE INTERNAL ERROR: "+cc(...t);Ro.error(e)},As=function(...t){const e=`FIREBASE FATAL ERROR: ${cc(...t)}`;throw Ro.error(e),new Error(e)},On=function(...t){const e="FIREBASE WARNING: "+cc(...t);Ro.warn(e)},oL=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&On("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},TT=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},aL=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Vo="[MIN_NAME]",Rs="[MAX_NAME]",fa=function(t,e){if(t===e)return 0;if(t===Vo||e===Rs)return-1;if(e===Vo||t===Rs)return 1;{const n=Y_(t),i=Y_(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},lL=function(t,e){return t===e?0:t<e?-1:1},xa=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Wt(e))},Sg=function(t){if(typeof t!="object"||t===null)return Wt(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=Wt(e[i]),n+=":",n+=Sg(t[e[i]]);return n+="}",n},ST=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function Wn(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const CT=function(t){ee(!TT(t),"Invalid JSON number");const e=11,n=52,i=(1<<e-1)-1;let r,s,o,a,l;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},cL=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},uL=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},hL=new RegExp("^-?(0*)\\d{1,10}$"),dL=-2147483648,fL=2147483647,Y_=function(t){if(hL.test(t)){const e=Number(t);if(e>=dL&&e<=fL)return e}return null},hc=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw On("Exception was thrown by user callback.",n),e},Math.floor(0))}},pL=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},sl=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){On(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(tn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',On(e)}}class Op{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Op.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="5",kT="v",xT="s",AT="r",RT="f",NT=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,DT="ls",OT="p",Pp="ac",PT="websocket",MT="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e,n,i,r,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=us.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&us.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function yL(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function LT(t,e,n){ee(typeof e=="string","typeof type must == string"),ee(typeof n=="object","typeof params must == object");let i;if(e===PT)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===MT)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);yL(t)&&(n.ns=t.namespace);const r=[];return Wn(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(){this.counters_={}}incrementCounter(e,n=1){si(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return jN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f={},wf={};function kg(t){const e=t.toString();return _f[e]||(_f[e]=new _L),_f[e]}function wL(t,e){const n=t.toString();return wf[n]||(wf[n]=e()),wf[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&hc(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="start",EL="close",IL="pLPCommand",TL="pRTLPCB",FT="id",BT="pw",$T="ser",SL="cb",CL="seg",kL="ts",xL="d",AL="dframe",qT=1870,UT=30,RL=qT-UT,NL=25e3,DL=3e4;class _o{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=uc(e),this.stats_=kg(n),this.urlFn=l=>(this.appCheckToken&&(l[Pp]=this.appCheckToken),LT(n,MT,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new bL(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(DL)),aL(()=>{if(this.isClosed_)return;this.scriptTagHolder=new xg((...s)=>{const[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===X_)this.id=a,this.password=l;else if(o===EL)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[X_]="t",i[$T]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[SL]=this.scriptTagHolder.uniqueCallbackIdentifier),i[kT]=Cg,this.transportSessionId&&(i[xT]=this.transportSessionId),this.lastSessionId&&(i[DT]=this.lastSessionId),this.applicationId&&(i[OT]=this.applicationId),this.appCheckToken&&(i[Pp]=this.appCheckToken),typeof location<"u"&&location.hostname&&NT.test(location.hostname)&&(i[AT]=RT);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_o.forceAllow_=!0}static forceDisallow(){_o.forceDisallow_=!0}static isAvailable(){return _o.forceAllow_?!0:!_o.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!cL()&&!uL()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Wt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=hI(n),r=ST(i,RL);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const i={};i[AL]="t",i[FT]=e,i[BT]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Wt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class xg{constructor(e,n,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=rL(),window[IL+this.uniqueCallbackIdentifier]=e,window[TL+this.uniqueCallbackIdentifier]=n,this.myIFrame=xg.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){tn("frame writing exception"),a.stack&&tn(a.stack),tn(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||tn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[FT]=this.myID,e[BT]=this.myPW,e[$T]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+UT+i.length<=qT;){const o=this.pendingSegs.shift();i=i+"&"+CL+r+"="+o.seg+"&"+kL+r+"="+o.ts+"&"+xL+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(NL)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{tn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL=16384,PL=45e3;let nh=null;typeof MozWebSocket<"u"?nh=MozWebSocket:typeof WebSocket<"u"&&(nh=WebSocket);class Xn{constructor(e,n,i,r,s,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=uc(this.connId),this.stats_=kg(n),this.connURL=Xn.connectionURL_(n,o,a,r,i),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,i,r,s){const o={};return o[kT]=Cg,typeof location<"u"&&location.hostname&&NT.test(location.hostname)&&(o[AT]=RT),n&&(o[xT]=n),i&&(o[DT]=i),r&&(o[Pp]=r),s&&(o[OT]=s),LT(e,PT,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,us.set("previous_websocket_failure",!0);try{let i;_I(),this.mySock=new nh(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Xn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(n);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&nh!==null&&!Xn.forceDisallow_}static previouslyFailed(){return us.isInMemoryStorage||us.get("previous_websocket_failure")===!0}markConnectionHealthy(){us.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const i=Cl(n);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ee(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const i=this.extractFrameCount_(n);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const n=Wt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const i=ST(n,OL);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(PL))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Xn.responsesRequiredToBeHealthy=2;Xn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[_o,Xn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Xn&&Xn.isAvailable();let i=n&&!Xn.previouslyFailed();if(e.webSocketOnly&&(n||On("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Xn];else{const r=this.transports_=[];for(const s of Nl.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);Nl.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Nl.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=6e4,LL=5e3,FL=10*1024,BL=100*1024,bf="t",J_="d",$L="s",Z_="r",qL="e",ew="o",tw="a",nw="n",iw="p",UL="h";class VL{constructor(e,n,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=uc("c:"+this.id+":"),this.transportManager_=new Nl(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=sl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BL?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>FL?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(bf in e){const n=e[bf];n===tw?this.upgradeIfSecondaryHealthy_():n===Z_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ew&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=xa("t",e),i=xa("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:iw,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tw,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nw,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=xa("t",e),i=xa("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=xa(bf,e);if(J_ in e){const i=e[J_];if(n===UL){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===nw){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===$L?this.onConnectionShutdown_(i):n===Z_?this.onReset_(i):n===qL?Dp("Server Error: "+i):n===ew?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Dp("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Cg!==i&&On("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),sl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ML))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):sl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(LL))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:iw,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(us.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e){this.allowedEvents_=e,this.listeners_={},ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});const r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){ee(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih extends zT{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ug()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ih}getInitialEvent(e){return ee(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw=32,sw=768;class ut{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ye(){return new ut("")}function Pe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function kr(t){return t.pieces_.length-t.pieceNum_}function it(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ut(t.pieces_,e)}function jT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function zL(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function HT(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function KT(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ut(e,0)}function Mt(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof ut)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ut(n,0)}function De(t){return t.pieceNum_>=t.pieces_.length}function Un(t,e){const n=Pe(t),i=Pe(e);if(n===null)return e;if(n===i)return Un(it(t),it(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function WT(t,e){if(kr(t)!==kr(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function ei(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(kr(t)>kr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class jL{constructor(e,n){this.errorPrefix_=n,this.parts_=HT(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=td(this.parts_[i]);GT(this)}}function HL(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=td(e),GT(t)}function KL(t){const e=t.parts_.pop();t.byteLength_-=td(e),t.parts_.length>0&&(t.byteLength_-=1)}function GT(t){if(t.byteLength_>sw)throw new Error(t.errorPrefix_+"has a key path longer than "+sw+" bytes ("+t.byteLength_+").");if(t.parts_.length>rw)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+rw+") or object contains a cycle "+Jr(t))}function Jr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag extends zT{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new Ag}getInitialEvent(e){return ee(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=1e3,WL=60*5*1e3,ow=30*1e3,GL=1.3,QL=3e4,YL="server_kill",aw=3;class Vi extends VT{constructor(e,n,i,r,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Vi.nextPersistentConnectionId_++,this.log_=uc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Aa,this.maxReconnectDelay_=WL,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!_I())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ag.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ih.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,i){const r=++this.requestNumber_,s={r,a:e,b:n};this.log_(Wt(s)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const n=new Sl,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,i,r){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})}sendListen_(e){const n=e.query,i=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;Vi.warnOnListenWarnings_(l,n),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&si(e,"w")){const i=qo(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();On(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||sD(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ow)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=rD(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(n,i,r=>{const s=r.s,o=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,i=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,i)})}unlisten(e,n){const i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,n)}sendUnlisten_(e,n,i,r){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:i})}onDisconnectMerge(e,n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:i})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,i,r){const s={p:n,d:i};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,i,r){this.putInternal("p",e,n,i,r)}merge(e,n,i,r){this.putInternal("m",e,n,i,r)}putInternal(e,n,i,r,s){this.initConnection_();const o={p:n,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,i,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Wt(e));const n=e.r,i=this.requestCBHash_[n];i&&(delete this.requestCBHash_[n],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Dp("Unrecognized action received from server: "+Wt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Aa,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Aa,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>QL&&(this.reconnectDelay_=Aa),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*GL)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Vi.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(h){ee(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?tn("getToken() completed but was canceled"):(tn("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new VL(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,i,f=>{On(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(YL)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&On(h),l())}}}interrupt(e){tn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){tn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ep(this.interruptReasons_)&&(this.reconnectDelay_=Aa,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let i;n?i=n.map(s=>Sg(s)).join("$"):i="default";const r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const i=new ut(e).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(n),s.delete(n),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,n){tn("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=aw&&(this.reconnectDelay_=ow,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){tn("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=aw&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+bT.replace(/\./g,"-")]=1,ug()?e["framework.cordova"]=1:yI()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ih.getInstance().currentlyOnline();return Ep(this.interruptReasons_)&&e}}Vi.nextPersistentConnectionId_=0;Vi.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Me(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const i=new Me(Vo,e),r=new Me(Vo,n);return this.compare(i,r)!==0}minPost(){return Me.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xc;class QT extends ad{static get __EMPTY_NODE(){return Xc}static set __EMPTY_NODE(e){Xc=e}compare(e,n){return fa(e.name,n.name)}isDefinedOn(e){throw ca("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Me.MIN}maxPost(){return new Me(Rs,Xc)}makePost(e,n){return ee(typeof e=="string","KeyIndex indexValue must always be a string."),new Me(e,Xc)}toString(){return".key"}}const No=new QT;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Dt{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??Dt.RED,this.left=r??wn.EMPTY_NODE,this.right=s??wn.EMPTY_NODE}copy(e,n,i,r,s){return new Dt(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const s=i(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return wn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let i,r;if(i=this,n(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),n(e,i.key)===0){if(i.right.isEmpty())return wn.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Dt.RED=!0;Dt.BLACK=!1;class XL{copy(e,n,i,r,s){return this}insert(e,n,i){return new Dt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class wn{constructor(e,n=wn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new wn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Dt.BLACK,null,null))}remove(e){return new wn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Dt.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Jc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Jc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Jc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Jc(this.root_,null,this.comparator_,!0,e)}}wn.EMPTY_NODE=new XL;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(t,e){return fa(t.name,e.name)}function Rg(t,e){return fa(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mp;function ZL(t){Mp=t}const YT=function(t){return typeof t=="number"?"number:"+CT(t):"string:"+t},XT=function(t){if(t.isLeafNode()){const e=t.val();ee(typeof e=="string"||typeof e=="number"||typeof e=="object"&&si(e,".sv"),"Priority must be a string or number.")}else ee(t===Mp||t.isEmpty(),"priority of unexpected type.");ee(t===Mp||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lw;class Rt{constructor(e,n=Rt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),XT(this.priorityNode_)}static set __childrenNodeConstructor(e){lw=e}static get __childrenNodeConstructor(){return lw}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return De(e)?this:Pe(e)===".priority"?this.priorityNode_:Rt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Rt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const i=Pe(e);return i===null?n:n.isEmpty()&&i!==".priority"?this:(ee(i!==".priority"||kr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Rt.__childrenNodeConstructor.EMPTY_NODE.updateChild(it(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+YT(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=CT(this.value_):e+=this.value_,this.lazyHash_=IT(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rt.__childrenNodeConstructor?-1:(ee(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,i=typeof this.value_,r=Rt.VALUE_TYPE_ORDER.indexOf(n),s=Rt.VALUE_TYPE_ORDER.indexOf(i);return ee(r>=0,"Unknown leaf type: "+n),ee(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Rt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let JT,ZT;function eF(t){JT=t}function tF(t){ZT=t}class nF extends ad{compare(e,n){const i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?fa(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Me.MIN}maxPost(){return new Me(Rs,new Rt("[PRIORITY-POST]",ZT))}makePost(e,n){const i=JT(e);return new Me(n,new Rt("[PRIORITY-POST]",i))}toString(){return".priority"}}const on=new nF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF=Math.log(2);class rF{constructor(e){const n=s=>parseInt(Math.log(s)/iF,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const rh=function(t,e,n,i){t.sort(e);const r=function(l,c){const u=c-l;let h,d;if(u===0)return null;if(u===1)return h=t[l],d=n?n(h):h,new Dt(d,h.node,Dt.BLACK,null,null);{const f=parseInt(u/2,10)+l,p=r(l,f),m=r(f+1,c);return h=t[f],d=n?n(h):h,new Dt(d,h.node,Dt.BLACK,p,m)}},s=function(l){let c=null,u=null,h=t.length;const d=function(p,m){const g=h-p,w=h;h-=p;const v=r(g+1,w),b=t[g],E=n?n(b):b;f(new Dt(E,b.node,m,null,v))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const m=l.nextBitIsOne(),g=Math.pow(2,l.count-(p+1));m?d(g,Dt.BLACK):(d(g,Dt.BLACK),d(g,Dt.RED))}return u},o=new rF(t.length),a=s(o);return new wn(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ef;const so={};class Bi{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return ee(so&&on,"ChildrenNode.ts has not been loaded"),Ef=Ef||new Bi({".priority":so},{".priority":on}),Ef}get(e){const n=qo(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof wn?n:null}hasIndex(e){return si(this.indexSet_,e.toString())}addIndex(e,n){ee(e!==No,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=n.getIterator(Me.Wrap);let o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=rh(i,e.getCompare()):a=so;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Bi(u,c)}addToIndexes(e,n){const i=Wu(this.indexes_,(r,s)=>{const o=qo(this.indexSet_,s);if(ee(o,"Missing index implementation for "+s),r===so)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(Me.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),rh(a,o.getCompare())}else return so;else{const a=n.get(e.name);let l=r;return a&&(l=l.remove(new Me(e.name,a))),l.insert(e,e.node)}});return new Bi(i,this.indexSet_)}removeFromIndexes(e,n){const i=Wu(this.indexes_,r=>{if(r===so)return r;{const s=n.get(e.name);return s?r.remove(new Me(e.name,s)):r}});return new Bi(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ra;class ze{constructor(e,n,i){this.children_=e,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&XT(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ra||(Ra=new ze(new wn(Rg),null,Bi.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ra}updatePriority(e){return this.children_.isEmpty()?this:new ze(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ra:n}}getChild(e){const n=Pe(e);return n===null?this:this.getImmediateChild(n).getChild(it(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(ee(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const i=new Me(e,n);let r,s;n.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?Ra:this.priorityNode_;return new ze(r,o,s)}}updateChild(e,n){const i=Pe(e);if(i===null)return n;{ee(Pe(e)!==".priority"||kr(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(it(e),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let i=0,r=0,s=!0;if(this.forEachChild(on,(o,a)=>{n[o]=a.val(e),i++,s&&ze.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*i){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+YT(this.getPriority().val())+":"),this.forEachChild(on,(n,i)=>{const r=i.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":IT(e)}return this.lazyHash_}getPredecessorChildName(e,n,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new Me(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Me(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const i=n.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Me(n,this.children_.get(n)):null}forEachChild(e,n){const i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Me.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const i=this.resolveIndex_(n);if(i)return i.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Me.Wrap);let s=r.peek();for(;s!=null&&n.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===dc?-1:0}withIndex(e){if(e===No||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ze(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===No||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const i=this.getIterator(on),r=n.getIterator(on);let s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===No?null:this.indexMap_.get(e.toString())}}ze.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class sF extends ze{constructor(){super(new wn(Rg),ze.EMPTY_NODE,Bi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ze.EMPTY_NODE}isEmpty(){return!1}}const dc=new sF;Object.defineProperties(Me,{MIN:{value:new Me(Vo,ze.EMPTY_NODE)},MAX:{value:new Me(Rs,dc)}});QT.__EMPTY_NODE=ze.EMPTY_NODE;Rt.__childrenNodeConstructor=ze;ZL(dc);tF(dc);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=!0;function nn(t,e=null){if(t===null)return ze.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),ee(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Rt(n,nn(e))}if(!(t instanceof Array)&&oF){const n=[];let i=!1;if(Wn(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=nn(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new Me(o,l)))}}),n.length===0)return ze.EMPTY_NODE;const s=rh(n,JL,o=>o.name,Rg);if(i){const o=rh(n,on.getCompare());return new ze(s,nn(e),new Bi({".priority":o},{".priority":on}))}else return new ze(s,nn(e),Bi.Default)}else{let n=ze.EMPTY_NODE;return Wn(t,(i,r)=>{if(si(t,i)&&i.substring(0,1)!=="."){const s=nn(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(nn(e))}}eF(nn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF extends ad{constructor(e){super(),this.indexPath_=e,ee(!De(e)&&Pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?fa(e.name,n.name):s}makePost(e,n){const i=nn(e),r=ze.EMPTY_NODE.updateChild(this.indexPath_,i);return new Me(n,r)}maxPost(){const e=ze.EMPTY_NODE.updateChild(this.indexPath_,dc);return new Me(Rs,e)}toString(){return HT(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF extends ad{compare(e,n){const i=e.node.compareTo(n.node);return i===0?fa(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Me.MIN}maxPost(){return Me.MAX}makePost(e,n){const i=nn(e);return new Me(n,i)}toString(){return".value"}}const cF=new lF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uF(t){return{type:"value",snapshotNode:t}}function hF(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function dF(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function cw(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function fF(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=on}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Vo}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Rs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===on}copy(){const e=new Ng;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uw(t){const e={};if(t.isDefault())return e;let n;if(t.index_===on?n="$priority":t.index_===cF?n="$value":t.index_===No?n="$key":(ee(t.index_ instanceof aF,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Wt(n),t.startSet_){const i=t.startAfterSet_?"startAfter":"startAt";e[i]=Wt(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+Wt(t.indexStartName_))}if(t.endSet_){const i=t.endBeforeSet_?"endBefore":"endAt";e[i]=Wt(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+Wt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function hw(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==on&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends VT{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=uc("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=sh.getListenId_(e,i),a={};this.listens_[o]=a;const l=uw(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(s,h,!1,i),qo(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",r(d,null)}})}unlisten(e,n){const i=sh.getListenId_(e,n);delete this.listens_[i]}get(e){const n=uw(e._queryParams),i=e._path.toString(),r=new Sl;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ua(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Cl(a.responseText)}catch{On("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&On("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(){this.rootNode_=ze.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(){return{value:null,children:new Map}}function eS(t,e,n){if(De(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const i=Pe(e);t.children.has(i)||t.children.set(i,oh());const r=t.children.get(i);e=it(e),eS(r,e,n)}}function Lp(t,e,n){t.value!==null?n(e,t.value):mF(t,(i,r)=>{const s=new ut(e.toString()+"/"+i);Lp(r,s,n)})}function mF(t,e){t.children.forEach((n,i)=>{e(i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Wn(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=10*1e3,vF=30*1e3,yF=5*60*1e3;class _F{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new gF(e);const i=dw+(vF-dw)*Math.random();sl(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),n={};let i=!1;Wn(e,(r,s)=>{s>0&&si(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),sl(this.reportStats_.bind(this),Math.floor(Math.random()*2*yF))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vi;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(vi||(vi={}));function tS(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function nS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function iS(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=vi.ACK_USER_WRITE,this.source=tS()}operationForChild(e){if(De(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new ut(e));return new ah(Ye(),n,this.revert)}}else return ee(Pe(this.path)===e,"operationForChild called for unrelated child."),new ah(it(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=vi.OVERWRITE}operationForChild(e){return De(this.path)?new Ns(this.source,Ye(),this.snap.getImmediateChild(e)):new Ns(this.source,it(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=vi.MERGE}operationForChild(e){if(De(this.path)){const n=this.children.subtree(new ut(e));return n.isEmpty()?null:n.value?new Ns(this.source,Ye(),n.value):new Dl(this.source,Ye(),n)}else return ee(Pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Dl(this.source,it(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(De(e))return this.isFullyInitialized()&&!this.filtered_;const n=Pe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function wF(t,e,n,i){const r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(fF(o.childName,o.snapshotNode))}),Na(t,r,"child_removed",e,i,n),Na(t,r,"child_added",e,i,n),Na(t,r,"child_moved",s,i,n),Na(t,r,"child_changed",e,i,n),Na(t,r,"value",e,i,n),r}function Na(t,e,n,i,r,s){const o=i.filter(a=>a.type===n);o.sort((a,l)=>EF(t,a,l)),o.forEach(a=>{const l=bF(t,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function bF(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function EF(t,e,n){if(e.childName==null||n.childName==null)throw ca("Should only compare child_ events.");const i=new Me(e.childName,e.snapshotNode),r=new Me(n.childName,n.snapshotNode);return t.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t,e){return{eventCache:t,serverCache:e}}function ol(t,e,n,i){return rS(new Dg(e,n,i),t.serverCache)}function sS(t,e,n,i){return rS(t.eventCache,new Dg(e,n,i))}function Fp(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ds(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let If;const IF=()=>(If||(If=new wn(lL)),If);class tt{constructor(e,n=IF()){this.value=e,this.children=n}static fromObject(e){let n=new tt(null);return Wn(e,(i,r)=>{n=n.set(new ut(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ye(),value:this.value};if(De(e))return null;{const i=Pe(e),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(it(e),n);return s!=null?{path:Mt(new ut(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(De(e))return this;{const n=Pe(e),i=this.children.get(n);return i!==null?i.subtree(it(e)):new tt(null)}}set(e,n){if(De(e))return new tt(n,this.children);{const i=Pe(e),s=(this.children.get(i)||new tt(null)).set(it(e),n),o=this.children.insert(i,s);return new tt(this.value,o)}}remove(e){if(De(e))return this.children.isEmpty()?new tt(null):new tt(null,this.children);{const n=Pe(e),i=this.children.get(n);if(i){const r=i.remove(it(e));let s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new tt(null):new tt(this.value,s)}else return this}}get(e){if(De(e))return this.value;{const n=Pe(e),i=this.children.get(n);return i?i.get(it(e)):null}}setTree(e,n){if(De(e))return n;{const i=Pe(e),s=(this.children.get(i)||new tt(null)).setTree(it(e),n);let o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new tt(this.value,o)}}fold(e){return this.fold_(Ye(),e)}fold_(e,n){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Mt(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,Ye(),n)}findOnPath_(e,n,i){const r=this.value?i(n,this.value):!1;if(r)return r;if(De(e))return null;{const s=Pe(e),o=this.children.get(s);return o?o.findOnPath_(it(e),Mt(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ye(),n)}foreachOnPath_(e,n,i){if(De(e))return this;{this.value&&i(n,this.value);const r=Pe(e),s=this.children.get(r);return s?s.foreachOnPath_(it(e),Mt(n,r),i):new tt(null)}}foreach(e){this.foreach_(Ye(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(Mt(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.writeTree_=e}static empty(){return new ri(new tt(null))}}function al(t,e,n){if(De(e))return new ri(new tt(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){const r=i.path;let s=i.value;const o=Un(r,e);return s=s.updateChild(o,n),new ri(t.writeTree_.set(r,s))}else{const r=new tt(n),s=t.writeTree_.setTree(e,r);return new ri(s)}}}function fw(t,e,n){let i=t;return Wn(n,(r,s)=>{i=al(i,Mt(e,r),s)}),i}function pw(t,e){if(De(e))return ri.empty();{const n=t.writeTree_.setTree(e,new tt(null));return new ri(n)}}function Bp(t,e){return Ks(t,e)!=null}function Ks(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Un(n.path,e)):null}function mw(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(on,(i,r)=>{e.push(new Me(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new Me(i,r.value))}),e}function br(t,e){if(De(e))return t;{const n=Ks(t,e);return n!=null?new ri(new tt(n)):new ri(t.writeTree_.subtree(e))}}function $p(t){return t.writeTree_.isEmpty()}function zo(t,e){return oS(Ye(),t.writeTree_,e)}function oS(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(ee(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=oS(Mt(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(Mt(t,".priority"),i)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t,e){return dS(e,t)}function TF(t,e,n,i,r){ee(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=al(t.visibleWrites,e,n)),t.lastWriteId=i}function SF(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}function CF(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);ee(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&kF(a,i.path)?r=!1:ei(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return xF(t),!0;if(i.snap)t.visibleWrites=pw(t.visibleWrites,i.path);else{const a=i.children;Wn(a,l=>{t.visibleWrites=pw(t.visibleWrites,Mt(i.path,l))})}return!0}else return!1}function kF(t,e){if(t.snap)return ei(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ei(Mt(t.path,n),e))return!0;return!1}function xF(t){t.visibleWrites=lS(t.allWrites,AF,Ye()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function AF(t){return t.visible}function lS(t,e,n){let i=ri.empty();for(let r=0;r<t.length;++r){const s=t[r];if(e(s)){const o=s.path;let a;if(s.snap)ei(n,o)?(a=Un(n,o),i=al(i,a,s.snap)):ei(o,n)&&(a=Un(o,n),i=al(i,Ye(),s.snap.getChild(a)));else if(s.children){if(ei(n,o))a=Un(n,o),i=fw(i,a,s.children);else if(ei(o,n))if(a=Un(o,n),De(a))i=fw(i,Ye(),s.children);else{const l=qo(s.children,Pe(a));if(l){const c=l.getChild(it(a));i=al(i,Ye(),c)}}}else throw ca("WriteRecord should have .snap or .children")}}return i}function cS(t,e,n,i,r){if(!i&&!r){const s=Ks(t.visibleWrites,e);if(s!=null)return s;{const o=br(t.visibleWrites,e);if($p(o))return n;if(n==null&&!Bp(o,Ye()))return null;{const a=n||ze.EMPTY_NODE;return zo(o,a)}}}else{const s=br(t.visibleWrites,e);if(!r&&$p(s))return n;if(!r&&n==null&&!Bp(s,Ye()))return null;{const o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(ei(c.path,e)||ei(e,c.path))},a=lS(t.allWrites,o,e),l=n||ze.EMPTY_NODE;return zo(a,l)}}}function RF(t,e,n){let i=ze.EMPTY_NODE;const r=Ks(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(on,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){const s=br(t.visibleWrites,e);return n.forEachChild(on,(o,a)=>{const l=zo(br(s,new ut(o)),a);i=i.updateImmediateChild(o,l)}),mw(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const s=br(t.visibleWrites,e);return mw(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function NF(t,e,n,i,r){ee(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Mt(e,n);if(Bp(t.visibleWrites,s))return null;{const o=br(t.visibleWrites,s);return $p(o)?r.getChild(n):zo(o,r.getChild(n))}}function DF(t,e,n,i){const r=Mt(e,n),s=Ks(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){const o=br(t.visibleWrites,r);return zo(o,i.getNode().getImmediateChild(n))}else return null}function OF(t,e){return Ks(t.visibleWrites,e)}function PF(t,e,n,i,r,s,o){let a;const l=br(t.visibleWrites,e),c=Ks(l,Ye());if(c!=null)a=c;else if(n!=null)a=zo(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let f=d.getNext();for(;f&&u.length<r;)h(f,i)!==0&&u.push(f),f=d.getNext();return u}else return[]}function MF(){return{visibleWrites:ri.empty(),allWrites:[],lastWriteId:-1}}function qp(t,e,n,i){return cS(t.writeTree,t.treePath,e,n,i)}function uS(t,e){return RF(t.writeTree,t.treePath,e)}function gw(t,e,n,i){return NF(t.writeTree,t.treePath,e,n,i)}function lh(t,e){return OF(t.writeTree,Mt(t.treePath,e))}function LF(t,e,n,i,r,s){return PF(t.writeTree,t.treePath,e,n,i,r,s)}function Og(t,e,n){return DF(t.writeTree,t.treePath,e,n)}function hS(t,e){return dS(Mt(t.treePath,e),t.writeTree)}function dS(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,i=e.childName;ee(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ee(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,cw(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,dF(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,hF(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,cw(i,e.snapshotNode,r.oldSnap));else throw ca("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}}const fS=new BF;class Pg{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Dg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Og(this.writes_,e,i)}}getChildAfterChild(e,n,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ds(this.viewCache_),s=LF(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}}function $F(t,e){ee(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),ee(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function qF(t,e,n,i,r){const s=new FF;let o,a;if(n.type===vi.OVERWRITE){const c=n;c.source.fromUser?o=Up(t,e,c.path,c.snap,i,r,s):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!De(c.path),o=ch(t,e,c.path,c.snap,i,r,a,s))}else if(n.type===vi.MERGE){const c=n;c.source.fromUser?o=VF(t,e,c.path,c.children,i,r,s):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Vp(t,e,c.path,c.children,i,r,a,s))}else if(n.type===vi.ACK_USER_WRITE){const c=n;c.revert?o=HF(t,e,c.path,i,r,s):o=zF(t,e,c.path,c.affectedTree,i,r,s)}else if(n.type===vi.LISTEN_COMPLETE)o=jF(t,e,n.path,i,s);else throw ca("Unknown operation type: "+n.type);const l=s.getChanges();return UF(e,o,l),{viewCache:o,changes:l}}function UF(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Fp(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(uF(Fp(e)))}}function pS(t,e,n,i,r,s){const o=e.eventCache;if(lh(i,n)!=null)return e;{let a,l;if(De(n))if(ee(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Ds(e),u=c instanceof ze?c:ze.EMPTY_NODE,h=uS(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const c=qp(i,Ds(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=Pe(n);if(c===".priority"){ee(kr(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const h=gw(i,n,u,l);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=it(n);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const d=gw(i,n,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=Og(i,c,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),c,h,u,r,s):a=o.getNode()}}return ol(e,a,o.isFullyInitialized()||De(n),t.filter.filtersNodes())}}function ch(t,e,n,i,r,s,o,a){const l=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(De(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),f,null)}else{const f=Pe(n);if(!l.isCompleteForPath(n)&&kr(n)>1)return e;const p=it(n),g=l.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=u.updatePriority(l.getNode(),g):c=u.updateChild(l.getNode(),f,g,p,fS,null)}const h=sS(e,c,l.isFullyInitialized()||De(n),u.filtersNodes()),d=new Pg(r,h,s);return pS(t,h,n,r,d,a)}function Up(t,e,n,i,r,s,o){const a=e.eventCache;let l,c;const u=new Pg(r,e,s);if(De(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=ol(e,c,!0,t.filter.filtersNodes());else{const h=Pe(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=ol(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=it(n),f=a.getNode().getImmediateChild(h);let p;if(De(d))p=i;else{const m=u.getCompleteChild(h);m!=null?jT(d)===".priority"&&m.getChild(KT(d)).isEmpty()?p=m:p=m.updateChild(d,i):p=ze.EMPTY_NODE}if(f.equals(p))l=e;else{const m=t.filter.updateChild(a.getNode(),h,p,d,u,o);l=ol(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function vw(t,e){return t.eventCache.isCompleteForChild(e)}function VF(t,e,n,i,r,s,o){let a=e;return i.foreach((l,c)=>{const u=Mt(n,l);vw(e,Pe(u))&&(a=Up(t,a,u,c,r,s,o))}),i.foreach((l,c)=>{const u=Mt(n,l);vw(e,Pe(u))||(a=Up(t,a,u,c,r,s,o))}),a}function yw(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Vp(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;De(n)?c=i:c=new tt(null).setTree(n,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=yw(t,f,d);l=ch(t,l,new ut(h),p,r,s,o,a)}}),c.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),m=yw(t,p,d);l=ch(t,l,new ut(h),m,r,s,o,a)}}),l}function zF(t,e,n,i,r,s,o){if(lh(r,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(De(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ch(t,e,n,l.getNode().getChild(n),r,s,a,o);if(De(n)){let c=new tt(null);return l.getNode().forEachChild(No,(u,h)=>{c=c.set(new ut(u),h)}),Vp(t,e,n,c,r,s,a,o)}else return e}else{let c=new tt(null);return i.foreach((u,h)=>{const d=Mt(n,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),Vp(t,e,n,c,r,s,a,o)}}function jF(t,e,n,i,r){const s=e.serverCache,o=sS(e,s.getNode(),s.isFullyInitialized()||De(n),s.isFiltered());return pS(t,o,n,i,fS,r)}function HF(t,e,n,i,r,s){let o;if(lh(i,n)!=null)return e;{const a=new Pg(i,e,r),l=e.eventCache.getNode();let c;if(De(n)||Pe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=qp(i,Ds(e));else{const h=e.serverCache.getNode();ee(h instanceof ze,"serverChildren would be complete if leaf node"),u=uS(i,h)}u=u,c=t.filter.updateFullNode(l,u,s)}else{const u=Pe(n);let h=Og(i,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=t.filter.updateChild(l,u,h,it(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,ze.EMPTY_NODE,it(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=qp(i,Ds(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||lh(i,Ye())!=null,ol(e,c,o,t.filter.filtersNodes())}}function KF(t,e){const n=Ds(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!De(e)&&!n.getImmediateChild(Pe(e)).isEmpty())?n.getChild(e):null}function _w(t,e,n,i){e.type===vi.MERGE&&e.source.queryId!==null&&(ee(Ds(t.viewCache_),"We should always have a full cache before handling merges"),ee(Fp(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,s=qF(t.processor_,r,e,n,i);return $F(t.processor_,s.viewCache),ee(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,WF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function WF(t,e,n,i){const r=i?[i]:t.eventRegistrations_;return wF(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ww;function GF(t){ee(!ww,"__referenceConstructor has already been defined"),ww=t}function Mg(t,e,n,i){const r=e.source.queryId;if(r!==null){const s=t.views.get(r);return ee(s!=null,"SyncTree gave us an op for an invalid query."),_w(s,e,n,i)}else{let s=[];for(const o of t.views.values())s=s.concat(_w(o,e,n,i));return s}}function Lg(t,e){let n=null;for(const i of t.views.values())n=n||KF(i,e);return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bw;function QF(t){ee(!bw,"__referenceConstructor has already been defined"),bw=t}class Ew{constructor(e){this.listenProvider_=e,this.syncPointTree_=new tt(null),this.pendingWriteTree_=MF(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function YF(t,e,n,i,r){return TF(t.pendingWriteTree_,e,n,i,r),r?cd(t,new Ns(tS(),e,n)):[]}function wo(t,e,n=!1){const i=SF(t.pendingWriteTree_,e);if(CF(t.pendingWriteTree_,e)){let s=new tt(null);return i.snap!=null?s=s.set(Ye(),!0):Wn(i.children,o=>{s=s.set(new ut(o),!0)}),cd(t,new ah(i.path,s,n))}else return[]}function ld(t,e,n){return cd(t,new Ns(nS(),e,n))}function XF(t,e,n){const i=tt.fromObject(n);return cd(t,new Dl(nS(),e,i))}function JF(t,e,n,i){const r=yS(t,i);if(r!=null){const s=_S(r),o=s.path,a=s.queryId,l=Un(o,e),c=new Ns(iS(a),l,n);return wS(t,o,c)}else return[]}function ZF(t,e,n,i){const r=yS(t,i);if(r){const s=_S(r),o=s.path,a=s.queryId,l=Un(o,e),c=tt.fromObject(n),u=new Dl(iS(a),l,c);return wS(t,o,u)}else return[]}function mS(t,e,n){const r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Un(o,e),c=Lg(a,l);if(c)return c});return cS(r,e,s,n,!0)}function cd(t,e){return gS(e,t.syncPointTree_,null,aS(t.pendingWriteTree_,Ye()))}function gS(t,e,n,i){if(De(t.path))return vS(t,e,n,i);{const r=e.get(Ye());n==null&&r!=null&&(n=Lg(r,Ye()));let s=[];const o=Pe(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=hS(i,o);s=s.concat(gS(a,l,c,u))}return r&&(s=s.concat(Mg(r,t,i,n))),s}}function vS(t,e,n,i){const r=e.get(Ye());n==null&&r!=null&&(n=Lg(r,Ye()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=hS(i,o),u=t.operationForChild(o);u&&(s=s.concat(vS(u,a,l,c)))}),r&&(s=s.concat(Mg(r,t,i,n))),s}function yS(t,e){return t.tagToQueryMap.get(e)}function _S(t){const e=t.indexOf("$");return ee(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ut(t.substr(0,e))}}function wS(t,e,n){const i=t.syncPointTree_.get(e);ee(i,"Missing sync point for query tag that we're tracking");const r=aS(t.pendingWriteTree_,e);return Mg(i,n,r,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Fg(n)}node(){return this.node_}}class Bg{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Mt(this.path_,e);return new Bg(this.syncTree_,n)}node(){return mS(this.syncTree_,this.path_)}}const eB=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Iw=function(t,e,n){if(!t||typeof t!="object")return t;if(ee(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return tB(t[".sv"],e,n);if(typeof t[".sv"]=="object")return nB(t[".sv"],e);ee(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},tB=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:ee(!1,"Unexpected server value: "+t)}},nB=function(t,e,n){t.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;typeof i!="number"&&ee(!1,"Unexpected increment value: "+i);const r=e.node();if(ee(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return typeof o!="number"?i:o+i},iB=function(t,e,n,i){return $g(e,new Bg(n,t),i)},rB=function(t,e,n){return $g(t,new Fg(e),n)};function $g(t,e,n){const i=t.getPriority().val(),r=Iw(i,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=Iw(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new Rt(a,nn(r)):t}else{const o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new Rt(r))),o.forEachChild(on,(a,l)=>{const c=$g(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}}function Ug(t,e){let n=e instanceof ut?e:new ut(e),i=t,r=Pe(n);for(;r!==null;){const s=qo(i.node.children,r)||{children:{},childCount:0};i=new qg(r,i,s),n=it(n),r=Pe(n)}return i}function pa(t){return t.node.value}function bS(t,e){t.node.value=e,zp(t)}function ES(t){return t.node.childCount>0}function sB(t){return pa(t)===void 0&&!ES(t)}function ud(t,e){Wn(t.node.children,(n,i)=>{e(new qg(n,t,i))})}function IS(t,e,n,i){n&&!i&&e(t),ud(t,r=>{IS(r,e,!0,i)}),n&&i&&e(t)}function oB(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function fc(t){return new ut(t.parent===null?t.name:fc(t.parent)+"/"+t.name)}function zp(t){t.parent!==null&&aB(t.parent,t.name,t)}function aB(t,e,n){const i=sB(n),r=si(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,zp(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,zp(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lB=/[\[\].#$\/\u0000-\u001F\u007F]/,cB=/[\[\].#$\u0000-\u001F\u007F]/,Tf=10*1024*1024,TS=function(t){return typeof t=="string"&&t.length!==0&&!lB.test(t)},uB=function(t){return typeof t=="string"&&t.length!==0&&!cB.test(t)},hB=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),uB(t)},SS=function(t,e,n){const i=n instanceof ut?new jL(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Jr(i));if(typeof e=="function")throw new Error(t+"contains a function "+Jr(i)+" with contents = "+e.toString());if(TT(e))throw new Error(t+"contains "+e.toString()+" "+Jr(i));if(typeof e=="string"&&e.length>Tf/3&&td(e)>Tf)throw new Error(t+"contains a string greater than "+Tf+" utf8 bytes "+Jr(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Wn(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!TS(o)))throw new Error(t+" contains an invalid key ("+o+") "+Jr(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);HL(i,o),SS(t,a,i),KL(i)}),r&&s)throw new Error(t+' contains ".value" child '+Jr(i)+" in addition to actual children.")}},dB=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!TS(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!hB(n))throw new Error(cD(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function pB(t,e){let n=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();n!==null&&!WT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Ws(t,e,n){pB(t,n),mB(t,i=>ei(i,e)||ei(e,i))}function mB(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const r=t.eventLists_[i];if(r){const s=r.path;e(s)?(gB(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function gB(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const i=n.getEventRunner();_s&&tn("event: "+n.toString()),hc(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB="repo_interrupt",yB=25;class _B{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fB,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=oh(),this.transactionQueueTree_=new qg,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function wB(t,e,n){if(t.stats_=kg(t.repoInfo_),t.forceRestClient_||pL())t.server_=new sh(t.repoInfo_,(i,r,s,o)=>{Tw(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Sw(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Wt(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Vi(t.repoInfo_,e,(i,r,s,o)=>{Tw(t,i,r,s,o)},i=>{Sw(t,i)},i=>{EB(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=wL(t.repoInfo_,()=>new _F(t.stats_,t.server_)),t.infoData_=new pF,t.infoSyncTree_=new Ew({startListening:(i,r,s,o)=>{let a=[];const l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=ld(t.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Vg(t,"connected",!1),t.serverSyncTree_=new Ew({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,l)=>{const c=o(a,l);Ws(t.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function bB(t){const n=t.infoData_.getNode(new ut(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function CS(t){return eB({timestamp:bB(t)})}function Tw(t,e,n,i,r){t.dataUpdateCount++;const s=new ut(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){const l=Wu(n,c=>nn(c));o=ZF(t.serverSyncTree_,s,l,r)}else{const l=nn(n);o=JF(t.serverSyncTree_,s,l,r)}else if(i){const l=Wu(n,c=>nn(c));o=XF(t.serverSyncTree_,s,l)}else{const l=nn(n);o=ld(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=jg(t,s)),Ws(t.eventQueue_,a,o)}function Sw(t,e){Vg(t,"connected",e),e===!1&&TB(t)}function EB(t,e){Wn(e,(n,i)=>{Vg(t,n,i)})}function Vg(t,e,n){const i=new ut("/.info/"+e),r=nn(n);t.infoData_.updateSnapshot(i,r);const s=ld(t.infoSyncTree_,i,r);Ws(t.eventQueue_,i,s)}function IB(t){return t.nextWriteId_++}function TB(t){kS(t,"onDisconnectEvents");const e=CS(t),n=oh();Lp(t.onDisconnect_,Ye(),(r,s)=>{const o=iB(r,s,t.serverSyncTree_,e);eS(n,r,o)});let i=[];Lp(n,Ye(),(r,s)=>{i=i.concat(ld(t.serverSyncTree_,r,s));const o=xB(t,r);jg(t,o)}),t.onDisconnect_=oh(),Ws(t.eventQueue_,Ye(),i)}function SB(t){t.persistentConnection_&&t.persistentConnection_.interrupt(vB)}function kS(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),tn(n,...e)}function xS(t,e,n){return mS(t.serverSyncTree_,e,n)||ze.EMPTY_NODE}function zg(t,e=t.transactionQueueTree_){if(e||hd(t,e),pa(e)){const n=RS(t,e);ee(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&CB(t,fc(e),n)}else ES(e)&&ud(e,n=>{zg(t,n)})}function CB(t,e,n){const i=n.map(c=>c.currentWriteId),r=xS(t,e,i);let s=r;const o=r.hash();for(let c=0;c<n.length;c++){const u=n[c];ee(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=Un(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{kS(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(wo(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();hd(t,Ug(t.transactionQueueTree_,e)),zg(t,t.transactionQueueTree_),Ws(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)hc(h[d])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{On("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}jg(t,e)}},o)}function jg(t,e){const n=AS(t,e),i=fc(n),r=RS(t,n);return kB(t,r,i),i}function kB(t,e,n){if(e.length===0)return;const i=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Un(n,l.path);let u=!1,h;if(ee(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,r=r.concat(wo(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=yB)u=!0,h="maxretry",r=r.concat(wo(t.serverSyncTree_,l.currentWriteId,!0));else{const d=xS(t,l.path,o);l.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){SS("transaction failed: Data returned ",f,l.path);let p=nn(f);typeof f=="object"&&f!=null&&si(f,".priority")||(p=p.updatePriority(d.getPriority()));const g=l.currentWriteId,w=CS(t),v=rB(p,d,w);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=v,l.currentWriteId=IB(t),o.splice(o.indexOf(g),1),r=r.concat(YF(t.serverSyncTree_,l.path,v,l.currentWriteId,l.applyLocally)),r=r.concat(wo(t.serverSyncTree_,g,!0))}else u=!0,h="nodata",r=r.concat(wo(t.serverSyncTree_,l.currentWriteId,!0))}Ws(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(h),!1,null))))}hd(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)hc(i[a]);zg(t,t.transactionQueueTree_)}function AS(t,e){let n,i=t.transactionQueueTree_;for(n=Pe(e);n!==null&&pa(i)===void 0;)i=Ug(i,n),e=it(e),n=Pe(e);return i}function RS(t,e){const n=[];return NS(t,e,n),n.sort((i,r)=>i.order-r.order),n}function NS(t,e,n){const i=pa(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);ud(e,r=>{NS(t,r,n)})}function hd(t,e){const n=pa(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,bS(e,n.length>0?n:void 0)}ud(e,i=>{hd(t,i)})}function xB(t,e){const n=fc(AS(t,e)),i=Ug(t.transactionQueueTree_,e);return oB(i,r=>{Sf(t,r)}),Sf(t,i),IS(i,r=>{Sf(t,r)}),n}function Sf(t,e){const n=pa(e);if(n){const i=[];let r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(ee(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(ee(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(wo(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?bS(e,void 0):n.length=s+1,Ws(t.eventQueue_,fc(e),r);for(let o=0;o<i.length;o++)hc(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(t){let e="";const n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function RB(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):On(`Invalid query segment '${n}' in query '${t}'`)}return e}const Cw=function(t,e){const n=NB(t),i=n.namespace;n.domain==="firebase.com"&&As(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&As("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||oL();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new vL(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new ut(n.pathString)}},NB=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=AB(t.substring(u,h)));const d=RB(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return De(this._path)?null:jT(this._path)}get ref(){return new ma(this._repo,this._path)}get _queryIdentifier(){const e=hw(this._queryParams),n=Sg(e);return n==="{}"?"default":n}get _queryObject(){return hw(this._queryParams)}isEqual(e){if(e=Ve(e),!(e instanceof Hg))return!1;const n=this._repo===e._repo,i=WT(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+zL(this._path)}}class ma extends Hg{constructor(e,n){super(e,n,new Ng,!1)}get parent(){const e=KT(this._path);return e===null?null:new ma(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}GF(ma);QF(ma);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB="FIREBASE_DATABASE_EMULATOR_HOST",jp={};let OB=!1;function PB(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||As("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),tn("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Cw(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[DB]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=Cw(s,r),a=o.repoInfo):l=!o.repoInfo.secure;const u=r&&l?new Op(Op.OWNER):new gL(t.name,t.options,e);dB("Invalid Firebase Database URL",o),De(o.path)||As("Database URL must point to the root of a Firebase Database (not including a child path).");const h=LB(a,t,u,new mL(t.name,n));return new FB(h,t)}function MB(t,e){const n=jp[e];(!n||n[t.key]!==t)&&As(`Database ${e}(${t.repoInfo_}) has already been deleted.`),SB(t),delete n[t.key]}function LB(t,e,n,i){let r=jp[e.name];r||(r={},jp[e.name]=r);let s=r[t.toURLString()];return s&&As("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new _B(t,OB,n,i),r[t.toURLString()]=s,s}class FB{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(wB(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ma(this._repo,Ye())),this._rootInternal}_delete(){return this._rootInternal!==null&&(MB(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&As("Cannot call "+e+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(t){tL(Oi),Kn(new Pn("database",(e,{instanceIdentifier:n})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return PB(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),an(W_,G_,t),an(W_,G_,"esm2017")}Vi.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Vi.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};BB();var $B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ne,Kg=Kg||{},_e=$B||self;function dd(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function pc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function qB(t){return Object.prototype.hasOwnProperty.call(t,Cf)&&t[Cf]||(t[Cf]=++UB)}var Cf="closure_uid_"+(1e9*Math.random()>>>0),UB=0;function VB(t,e,n){return t.call.apply(t.bind,arguments)}function zB(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function ln(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ln=VB:ln=zB,ln.apply(null,arguments)}function Zc(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),t.apply(this,i)}}function qt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function $r(){this.s=this.s,this.o=this.o}var jB=0;$r.prototype.s=!1;$r.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),jB!=0)&&qB(this)};$r.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const DS=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Wg(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function kw(t,e){for(let n=1;n<arguments.length;n++){const i=arguments[n];if(dd(i)){const r=t.length||0,s=i.length||0;t.length=r+s;for(let o=0;o<s;o++)t[r+o]=i[o]}else t.push(i)}}function cn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}cn.prototype.h=function(){this.defaultPrevented=!0};var HB=function(){if(!_e.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_e.addEventListener("test",()=>{},e),_e.removeEventListener("test",()=>{},e)}catch{}return t}();function Ol(t){return/^[\s\xa0]*$/.test(t)}function fd(){var t=_e.navigator;return t&&(t=t.userAgent)?t:""}function mi(t){return fd().indexOf(t)!=-1}function Gg(t){return Gg[" "](t),t}Gg[" "]=function(){};function KB(t,e){var n=B$;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var WB=mi("Opera"),jo=mi("Trident")||mi("MSIE"),OS=mi("Edge"),Hp=OS||jo,PS=mi("Gecko")&&!(fd().toLowerCase().indexOf("webkit")!=-1&&!mi("Edge"))&&!(mi("Trident")||mi("MSIE"))&&!mi("Edge"),GB=fd().toLowerCase().indexOf("webkit")!=-1&&!mi("Edge");function MS(){var t=_e.document;return t?t.documentMode:void 0}var Kp;e:{var kf="",xf=function(){var t=fd();if(PS)return/rv:([^\);]+)(\)|;)/.exec(t);if(OS)return/Edge\/([\d\.]+)/.exec(t);if(jo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(GB)return/WebKit\/(\S+)/.exec(t);if(WB)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(xf&&(kf=xf?xf[1]:""),jo){var Af=MS();if(Af!=null&&Af>parseFloat(kf)){Kp=String(Af);break e}}Kp=kf}var Wp;if(_e.document&&jo){var xw=MS();Wp=xw||parseInt(Kp,10)||void 0}else Wp=void 0;var QB=Wp;function Pl(t,e){if(cn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(PS){e:{try{Gg(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:YB[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Pl.$.h.call(this)}}qt(Pl,cn);var YB={2:"touch",3:"pen",4:"mouse"};Pl.prototype.h=function(){Pl.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var mc="closure_listenable_"+(1e6*Math.random()|0),XB=0;function JB(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++XB,this.fa=this.ia=!1}function pd(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Qg(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function ZB(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function LS(t){const e={};for(const n in t)e[n]=t[n];return e}const Aw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function FS(t,e){let n,i;for(let r=1;r<arguments.length;r++){i=arguments[r];for(n in i)t[n]=i[n];for(let s=0;s<Aw.length;s++)n=Aw[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function md(t){this.src=t,this.g={},this.h=0}md.prototype.add=function(t,e,n,i,r){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Qp(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new JB(e,this.src,s,!!i,r),e.ia=n,t.push(e)),e};function Gp(t,e){var n=e.type;if(n in t.g){var i=t.g[n],r=DS(i,e),s;(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(pd(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Qp(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}var Yg="closure_lm_"+(1e6*Math.random()|0),Rf={};function BS(t,e,n,i,r){if(i&&i.once)return qS(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)BS(t,e[s],n,i,r);return null}return n=Zg(n),t&&t[mc]?t.O(e,n,pc(i)?!!i.capture:!!i,r):$S(t,e,n,!1,i,r)}function $S(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=pc(r)?!!r.capture:!!r,a=Jg(t);if(a||(t[Yg]=a=new md(t)),n=a.add(e,n,i,o,s),n.proxy)return n;if(i=e$(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)HB||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(VS(e.toString()),i);else if(t.addListener&&t.removeListener)t.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return n}function e$(){function t(n){return e.call(t.src,t.listener,n)}const e=t$;return t}function qS(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)qS(t,e[s],n,i,r);return null}return n=Zg(n),t&&t[mc]?t.P(e,n,pc(i)?!!i.capture:!!i,r):$S(t,e,n,!0,i,r)}function US(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)US(t,e[s],n,i,r);else i=pc(i)?!!i.capture:!!i,n=Zg(n),t&&t[mc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Qp(s,n,i,r),-1<n&&(pd(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Jg(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Qp(e,n,i,r)),(n=-1<t?e[t]:null)&&Xg(n))}function Xg(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[mc])Gp(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(VS(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Jg(e))?(Gp(n,t),n.h==0&&(n.src=null,e[Yg]=null)):pd(t)}}}function VS(t){return t in Rf?Rf[t]:Rf[t]="on"+t}function t$(t,e){if(t.fa)t=!0;else{e=new Pl(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Xg(t),t=n.call(i,e)}return t}function Jg(t){return t=t[Yg],t instanceof md?t:null}var Nf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zg(t){return typeof t=="function"?t:(t[Nf]||(t[Nf]=function(e){return t.handleEvent(e)}),t[Nf])}function $t(){$r.call(this),this.i=new md(this),this.S=this,this.J=null}qt($t,$r);$t.prototype[mc]=!0;$t.prototype.removeEventListener=function(t,e,n,i){US(this,t,e,n,i)};function Yt(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,typeof e=="string")e=new cn(e,t);else if(e instanceof cn)e.target=e.target||t;else{var r=e;e=new cn(i,t),FS(e,r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=eu(o,i,!0,e)&&r}if(o=e.g=t,r=eu(o,i,!0,e)&&r,r=eu(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)o=e.g=n[s],r=eu(o,i,!1,e)&&r}$t.prototype.N=function(){if($t.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)pd(n[i]);delete t.g[e],t.h--}}this.J=null};$t.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)};$t.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};function eu(t,e,n,i){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Gp(t.i,o),r=a.call(l,i)!==!1&&r}}return r&&!i.defaultPrevented}var ev=_e.JSON.stringify;class n${constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function i$(){var t=tv;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class r${constructor(){this.h=this.g=null}add(e,n){const i=zS.get();i.set(e,n),this.h?this.h.next=i:this.g=i,this.h=i}}var zS=new n$(()=>new s$,t=>t.reset());class s${constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function o$(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function a$(t){_e.setTimeout(()=>{throw t},0)}let Ml,Ll=!1,tv=new r$,jS=()=>{const t=_e.Promise.resolve(void 0);Ml=()=>{t.then(l$)}};var l$=()=>{for(var t;t=i$();){try{t.h.call(t.g)}catch(n){a$(n)}var e=zS;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ll=!1};function gd(t,e){$t.call(this),this.h=t||1,this.g=e||_e,this.j=ln(this.qb,this),this.l=Date.now()}qt(gd,$t);ne=gd.prototype;ne.ga=!1;ne.T=null;ne.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Yt(this,"tick"),this.ga&&(nv(this),this.start()))}};ne.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function nv(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}ne.N=function(){gd.$.N.call(this),nv(this),delete this.g};function iv(t,e,n){if(typeof t=="function")n&&(t=ln(t,n));else if(t&&typeof t.handleEvent=="function")t=ln(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:_e.setTimeout(t,e||0)}function HS(t){t.g=iv(()=>{t.g=null,t.i&&(t.i=!1,HS(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class c$ extends $r{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:HS(this)}N(){super.N(),this.g&&(_e.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fl(t){$r.call(this),this.h=t,this.g={}}qt(Fl,$r);var Rw=[];function KS(t,e,n,i){Array.isArray(n)||(n&&(Rw[0]=n.toString()),n=Rw);for(var r=0;r<n.length;r++){var s=BS(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function WS(t){Qg(t.g,function(e,n){this.g.hasOwnProperty(n)&&Xg(e)},t),t.g={}}Fl.prototype.N=function(){Fl.$.N.call(this),WS(this)};Fl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function vd(){this.g=!0}vd.prototype.Ea=function(){this.g=!1};function u$(t,e,n,i,r,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function h$(t,e,n,i,r,s,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+`
`+n+`
`+s+" "+o})}function bo(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+f$(t,n)+(i?" "+i:"")})}function d$(t,e){t.info(function(){return"TIMEOUT: "+e})}vd.prototype.info=function(){};function f$(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return ev(n)}catch{return e}}var Gs={},Nw=null;function yd(){return Nw=Nw||new $t}Gs.Ta="serverreachability";function GS(t){cn.call(this,Gs.Ta,t)}qt(GS,cn);function Bl(t){const e=yd();Yt(e,new GS(e))}Gs.STAT_EVENT="statevent";function QS(t,e){cn.call(this,Gs.STAT_EVENT,t),this.stat=e}qt(QS,cn);function gn(t){const e=yd();Yt(e,new QS(e,t))}Gs.Ua="timingevent";function YS(t,e){cn.call(this,Gs.Ua,t),this.size=e}qt(YS,cn);function gc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return _e.setTimeout(function(){t()},e)}var _d={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},XS={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function rv(){}rv.prototype.h=null;function Dw(t){return t.h||(t.h=t.i())}function JS(){}var vc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function sv(){cn.call(this,"d")}qt(sv,cn);function ov(){cn.call(this,"c")}qt(ov,cn);var Yp;function wd(){}qt(wd,rv);wd.prototype.g=function(){return new XMLHttpRequest};wd.prototype.i=function(){return{}};Yp=new wd;function yc(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new Fl(this),this.P=p$,t=Hp?125:void 0,this.V=new gd(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ZS}function ZS(){this.i=null,this.g="",this.h=!1}var p$=45e3,Xp={},uh={};ne=yc.prototype;ne.setTimeout=function(t){this.P=t};function Jp(t,e,n){t.L=1,t.v=Ed(Ki(e)),t.s=n,t.S=!0,eC(t,null)}function eC(t,e){t.G=Date.now(),_c(t),t.A=Ki(t.v);var n=t.A,i=t.W;Array.isArray(i)||(i=[String(i)]),lC(n.i,"t",i),t.C=0,n=t.l.J,t.h=new ZS,t.g=AC(t.l,n?e:null,!t.s),0<t.O&&(t.M=new c$(ln(t.Pa,t,t.g),t.O)),KS(t.U,t.g,"readystatechange",t.nb),e=t.I?LS(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Bl(),u$(t.j,t.u,t.A,t.m,t.W,t.s)}ne.nb=function(t){t=t.target;const e=this.M;e&&yi(t)==3?e.l():this.Pa(t)};ne.Pa=function(t){try{if(t==this.g)e:{const u=yi(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||Hp||this.g&&(this.h.h||this.g.ja()||Lw(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?Bl(3):Bl(2)),bd(this);var n=this.g.da();this.ca=n;t:if(tC(this)){var i=Lw(this.g);t="";var r=i.length,s=yi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hs(this),ll(this);var o="";break t}this.h.i=new _e.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,h$(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ol(a)){var c=a;break t}}c=null}if(n=c)bo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zp(this,n);else{this.i=!1,this.o=3,gn(12),hs(this),ll(this);break e}}this.S?(nC(this,u,o),Hp&&this.i&&u==3&&(KS(this.U,this.V,"tick",this.mb),this.V.start())):(bo(this.j,this.m,o,null),Zp(this,o)),u==4&&hs(this),this.i&&!this.J&&(u==4?SC(this.l,this):(this.i=!1,_c(this)))}else M$(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,gn(12)):(this.o=0,gn(13)),hs(this),ll(this)}}}catch{}finally{}};function tC(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function nC(t,e,n){let i=!0,r;for(;!t.J&&t.C<n.length;)if(r=m$(t,n),r==uh){e==4&&(t.o=4,gn(14),i=!1),bo(t.j,t.m,null,"[Incomplete Response]");break}else if(r==Xp){t.o=4,gn(15),bo(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}else bo(t.j,t.m,r,null),Zp(t,r);tC(t)&&r!=uh&&r!=Xp&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,gn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),dv(e),e.M=!0,gn(11))):(bo(t.j,t.m,n,"[Invalid Chunked Response]"),hs(t),ll(t))}ne.mb=function(){if(this.g){var t=yi(this.g),e=this.g.ja();this.C<e.length&&(bd(this),nC(this,t,e),this.i&&t!=4&&_c(this))}};function m$(t,e){var n=t.C,i=e.indexOf(`
`,n);return i==-1?uh:(n=Number(e.substring(n,i)),isNaN(n)?Xp:(i+=1,i+n>e.length?uh:(e=e.slice(i,i+n),t.C=i+n,e)))}ne.cancel=function(){this.J=!0,hs(this)};function _c(t){t.Y=Date.now()+t.P,iC(t,t.P)}function iC(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=gc(ln(t.lb,t),e)}function bd(t){t.B&&(_e.clearTimeout(t.B),t.B=null)}ne.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(d$(this.j,this.A),this.L!=2&&(Bl(),gn(17)),hs(this),this.o=2,ll(this)):iC(this,this.Y-t)};function ll(t){t.l.H==0||t.J||SC(t.l,t)}function hs(t){bd(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,nv(t.V),WS(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Zp(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||em(n.i,t))){if(!t.K&&em(n.i,t)&&n.H==3){try{var i=n.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&i.length==3){var r=i;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)fh(n),Sd(n);else break e;hv(n),gn(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&n.A==0&&!n.v&&(n.v=gc(ln(n.ib,n),6e3));if(1>=hC(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ds(n,11)}else if((t.K||n.g==t)&&fh(n),!Ol(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const u=c[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(i=1.5*d,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=i.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(av(s,s.h),s.h=null))}if(i.F){const m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(i.Da=m,rt(i.I,i.F,m))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),i=n;var o=t;if(i.wa=xC(i,i.J?i.pa:null,i.Y),o.K){dC(i.i,o);var a=o,l=i.L;l&&a.setTimeout(l),a.B&&(bd(a),_c(a)),i.g=o}else IC(i);0<n.j.length&&Cd(n)}else c[0]!="stop"&&c[0]!="close"||ds(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?ds(n,7):uv(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Bl(4)}catch{}}function g$(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(dd(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}e=[],n=0;for(i in t)e[n++]=t[i];return e}function v$(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(dd(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}function rC(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(dd(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=v$(t),i=g$(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}var sC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function y$(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function ws(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ws){this.h=t.h,hh(this,t.j),this.s=t.s,this.g=t.g,dh(this,t.m),this.l=t.l;var e=t.i,n=new $l;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Ow(this,n),this.o=t.o}else t&&(e=String(t).match(sC))?(this.h=!1,hh(this,e[1]||"",!0),this.s=Wa(e[2]||""),this.g=Wa(e[3]||"",!0),dh(this,e[4]),this.l=Wa(e[5]||"",!0),Ow(this,e[6]||"",!0),this.o=Wa(e[7]||"")):(this.h=!1,this.i=new $l(null,this.h))}ws.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ga(e,Pw,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ga(e,Pw,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Ga(n,n.charAt(0)=="/"?b$:w$,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ga(n,I$)),t.join("")};function Ki(t){return new ws(t)}function hh(t,e,n){t.j=n?Wa(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function dh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ow(t,e,n){e instanceof $l?(t.i=e,T$(t.i,t.h)):(n||(e=Ga(e,E$)),t.i=new $l(e,t.h))}function rt(t,e,n){t.i.set(e,n)}function Ed(t){return rt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Wa(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ga(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,_$),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function _$(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Pw=/[#\/\?@]/g,w$=/[#\?:]/g,b$=/[#\?]/g,E$=/[#\?@]/g,I$=/#/g;function $l(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function qr(t){t.g||(t.g=new Map,t.h=0,t.i&&y$(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}ne=$l.prototype;ne.add=function(t,e){qr(this),this.i=null,t=ga(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function oC(t,e){qr(t),e=ga(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function aC(t,e){return qr(t),e=ga(t,e),t.g.has(e)}ne.forEach=function(t,e){qr(this),this.g.forEach(function(n,i){n.forEach(function(r){t.call(e,r,i,this)},this)},this)};ne.ta=function(){qr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const r=t[i];for(let s=0;s<r.length;s++)n.push(e[i])}return n};ne.Z=function(t){qr(this);let e=[];if(typeof t=="string")aC(this,t)&&(e=e.concat(this.g.get(ga(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};ne.set=function(t,e){return qr(this),this.i=null,t=ga(this,t),aC(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};ne.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function lC(t,e,n){oC(t,e),0<n.length&&(t.i=null,t.g.set(ga(t,e),Wg(n)),t.h+=n.length)}ne.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;o[i]!==""&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};function ga(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function T$(t,e){e&&!t.j&&(qr(t),t.i=null,t.g.forEach(function(n,i){var r=i.toLowerCase();i!=r&&(oC(this,i),lC(this,r,n))},t)),t.j=e}var S$=class{constructor(t,e){this.g=t,this.map=e}};function cC(t){this.l=t||C$,_e.PerformanceNavigationTiming?(t=_e.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(_e.g&&_e.g.Ka&&_e.g.Ka()&&_e.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var C$=10;function uC(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function hC(t){return t.h?1:t.g?t.g.size:0}function em(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function av(t,e){t.g?t.g.add(e):t.h=e}function dC(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}cC.prototype.cancel=function(){if(this.i=fC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function fC(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Wg(t.i)}var k$=class{stringify(t){return _e.JSON.stringify(t,void 0)}parse(t){return _e.JSON.parse(t,void 0)}};function x$(){this.g=new k$}function A$(t,e,n){const i=n||"";try{rC(t,function(r,s){let o=r;pc(r)&&(o=ev(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function R$(t,e){const n=new vd;if(_e.Image){const i=new Image;i.onload=Zc(tu,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Zc(tu,n,i,"TestLoadImage: error",!1,e),i.onabort=Zc(tu,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Zc(tu,n,i,"TestLoadImage: timeout",!1,e),_e.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}function tu(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function wc(t){this.l=t.fc||null,this.j=t.ob||!1}qt(wc,rv);wc.prototype.g=function(){return new Id(this.l,this.j)};wc.prototype.i=function(t){return function(){return t}}({});function Id(t,e){$t.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=lv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}qt(Id,$t);var lv=0;ne=Id.prototype;ne.open=function(t,e){if(this.readyState!=lv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,ql(this)};ne.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||_e).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};ne.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bc(this)),this.readyState=lv};ne.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,ql(this)),this.g&&(this.readyState=3,ql(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof _e.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pC(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function pC(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}ne.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bc(this):ql(this),this.readyState==3&&pC(this)}};ne.Za=function(t){this.g&&(this.response=this.responseText=t,bc(this))};ne.Ya=function(t){this.g&&(this.response=t,bc(this))};ne.ka=function(){this.g&&bc(this)};function bc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,ql(t)}ne.setRequestHeader=function(t,e){this.v.append(t,e)};ne.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};ne.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function ql(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Id.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var N$=_e.JSON.parse;function ft(t){$t.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=mC,this.L=this.M=!1}qt(ft,$t);var mC="",D$=/^https?$/i,O$=["POST","PUT"];ne=ft.prototype;ne.Oa=function(t){this.M=t};ne.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Yp.g(),this.C=this.u?Dw(this.u):Dw(Yp),this.g.onreadystatechange=ln(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Mw(this,s);return}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(const s of i.keys())n.set(s,i.get(s));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),r=_e.FormData&&t instanceof _e.FormData,!(0<=DS(O$,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{yC(this),0<this.B&&((this.L=P$(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ln(this.ua,this)):this.A=iv(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Mw(this,s)}};function P$(t){return jo&&typeof t.timeout=="number"&&t.ontimeout!==void 0}ne.ua=function(){typeof Kg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Yt(this,"timeout"),this.abort(8))};function Mw(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,gC(t),Td(t)}function gC(t){t.F||(t.F=!0,Yt(t,"complete"),Yt(t,"error"))}ne.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Yt(this,"complete"),Yt(this,"abort"),Td(this))};ne.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Td(this,!0)),ft.$.N.call(this)};ne.La=function(){this.s||(this.G||this.v||this.l?vC(this):this.kb())};ne.kb=function(){vC(this)};function vC(t){if(t.h&&typeof Kg<"u"&&(!t.C[1]||yi(t)!=4||t.da()!=2)){if(t.v&&yi(t)==4)iv(t.La,0,t);else if(Yt(t,"readystatechange"),yi(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var i;if(i=o===0){var r=String(t.I).match(sC)[1]||null;!r&&_e.self&&_e.self.location&&(r=_e.self.location.protocol.slice(0,-1)),i=!D$.test(r?r.toLowerCase():"")}n=i}if(n)Yt(t,"complete"),Yt(t,"success");else{t.m=6;try{var s=2<yi(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",gC(t)}}finally{Td(t)}}}}function Td(t,e){if(t.g){yC(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Yt(t,"ready");try{n.onreadystatechange=i}catch{}}}function yC(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(_e.clearTimeout(t.A),t.A=null)}ne.isActive=function(){return!!this.g};function yi(t){return t.g?t.g.readyState:0}ne.da=function(){try{return 2<yi(this)?this.g.status:-1}catch{return-1}};ne.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};ne.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),N$(e)}};function Lw(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case mC:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function M$(t){const e={};t=(t.g&&2<=yi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<t.length;i++){if(Ol(t[i]))continue;var n=o$(t[i]);const r=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[r]||[];e[r]=s,s.push(n)}ZB(e,function(i){return i.join(", ")})}ne.Ia=function(){return this.m};ne.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function _C(t){let e="";return Qg(t,function(n,i){e+=i,e+=":",e+=n,e+=`\r
`}),e}function cv(t,e,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=_C(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):rt(t,e,n))}function Da(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function wC(t){this.Ga=0,this.j=[],this.l=new vd,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Da("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Da("baseRetryDelayMs",5e3,t),this.hb=Da("retryDelaySeedMs",1e4,t),this.eb=Da("forwardChannelMaxRetries",2,t),this.xa=Da("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new cC(t&&t.concurrentRequestLimit),this.Ja=new x$,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}ne=wC.prototype;ne.ra=8;ne.H=1;function uv(t){if(bC(t),t.H==3){var e=t.W++,n=Ki(t.I);if(rt(n,"SID",t.K),rt(n,"RID",e),rt(n,"TYPE","terminate"),Ec(t,n),e=new yc(t,t.l,e),e.L=2,e.v=Ed(Ki(n)),n=!1,_e.navigator&&_e.navigator.sendBeacon)try{n=_e.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&_e.Image&&(new Image().src=e.v,n=!0),n||(e.g=AC(e.l,null),e.g.ha(e.v)),e.G=Date.now(),_c(e)}kC(t)}function Sd(t){t.g&&(dv(t),t.g.cancel(),t.g=null)}function bC(t){Sd(t),t.u&&(_e.clearTimeout(t.u),t.u=null),fh(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&_e.clearTimeout(t.m),t.m=null)}function Cd(t){if(!uC(t.i)&&!t.m){t.m=!0;var e=t.Na;Ml||jS(),Ll||(Ml(),Ll=!0),tv.add(e,t),t.C=0}}function L$(t,e){return hC(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=gc(ln(t.Na,t,e),CC(t,t.C)),t.C++,!0)}ne.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new yc(this,this.l,t);let s=this.s;if(this.U&&(s?(s=LS(s),FS(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var i=this.j[n];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(e+=i,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=EC(this,r,e),n=Ki(this.I),rt(n,"RID",t),rt(n,"CVER",22),this.F&&rt(n,"X-HTTP-Session-Id",this.F),Ec(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(_C(s)))+"&"+e:this.o&&cv(n,this.o,s)),av(this.i,r),this.bb&&rt(n,"TYPE","init"),this.P?(rt(n,"$req",e),rt(n,"SID","null"),r.aa=!0,Jp(r,n,null)):Jp(r,n,e),this.H=2}}else this.H==3&&(t?Fw(this,t):this.j.length==0||uC(this.i)||Fw(this))};function Fw(t,e){var n;e?n=e.m:n=t.W++;const i=Ki(t.I);rt(i,"SID",t.K),rt(i,"RID",n),rt(i,"AID",t.V),Ec(t,i),t.o&&t.s&&cv(i,t.o,t.s),n=new yc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=EC(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),av(t.i,n),Jp(n,i,e)}function Ec(t,e){t.na&&Qg(t.na,function(n,i){rt(e,i,n)}),t.h&&rC({},function(n,i){rt(e,i,n)})}function EC(t,e,n){n=Math.min(t.j.length,n);var i=t.h?ln(t.h.Va,t.h,t):null;e:{var r=t.j;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=r[l].g;const u=r[l].map;if(c-=s,0>c)s=Math.max(0,r[l].g-100),a=!1;else try{A$(u,o,"req"+c+"_")}catch{i&&i(u)}}if(a){i=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,i}function IC(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Ml||jS(),Ll||(Ml(),Ll=!0),tv.add(e,t),t.A=0}}function hv(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=gc(ln(t.Ma,t),CC(t,t.A)),t.A++,!0)}ne.Ma=function(){if(this.u=null,TC(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=gc(ln(this.jb,this),t)}};ne.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,gn(10),Sd(this),TC(this))};function dv(t){t.B!=null&&(_e.clearTimeout(t.B),t.B=null)}function TC(t){t.g=new yc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ki(t.wa);rt(e,"RID","rpc"),rt(e,"SID",t.K),rt(e,"AID",t.V),rt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&rt(e,"TO",t.qa),rt(e,"TYPE","xmlhttp"),Ec(t,e),t.o&&t.s&&cv(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Ed(Ki(e)),n.s=null,n.S=!0,eC(n,t)}ne.ib=function(){this.v!=null&&(this.v=null,Sd(this),hv(this),gn(19))};function fh(t){t.v!=null&&(_e.clearTimeout(t.v),t.v=null)}function SC(t,e){var n=null;if(t.g==e){fh(t),dv(t),t.g=null;var i=2}else if(em(t.i,e))n=e.F,dC(t.i,e),i=1;else return;if(t.H!=0){if(e.i)if(i==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var r=t.C;i=yd(),Yt(i,new YS(i,n)),Cd(t)}else IC(t);else if(r=e.o,r==3||r==0&&0<e.ca||!(i==1&&L$(t,e)||i==2&&hv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ds(t,5);break;case 4:ds(t,10);break;case 3:ds(t,6);break;default:ds(t,2)}}}function CC(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ds(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var i=ln(t.pb,t);n||(n=new ws("//www.google.com/images/cleardot.gif"),_e.location&&_e.location.protocol=="http"||hh(n,"https"),Ed(n)),R$(n.toString(),i)}else gn(2);t.H=0,t.h&&t.h.za(e),kC(t),bC(t)}ne.pb=function(t){t?(this.l.info("Successfully pinged google.com"),gn(2)):(this.l.info("Failed to ping google.com"),gn(1))};function kC(t){if(t.H=0,t.ma=[],t.h){const e=fC(t.i);(e.length!=0||t.j.length!=0)&&(kw(t.ma,e),kw(t.ma,t.j),t.i.i.length=0,Wg(t.j),t.j.length=0),t.h.ya()}}function xC(t,e,n){var i=n instanceof ws?Ki(n):new ws(n);if(i.g!="")e&&(i.g=e+"."+i.g),dh(i,i.m);else{var r=_e.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new ws(null);i&&hh(s,i),e&&(s.g=e),r&&dh(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&rt(i,n,e),rt(i,"VER",t.ra),Ec(t,i),i}function AC(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new ft(new wc({ob:!0})):new ft(t.va),e.Oa(t.J),e}ne.isActive=function(){return!!this.h&&this.h.isActive(this)};function RC(){}ne=RC.prototype;ne.Ba=function(){};ne.Aa=function(){};ne.za=function(){};ne.ya=function(){};ne.isActive=function(){return!0};ne.Va=function(){};function ph(){if(jo&&!(10<=Number(QB)))throw Error("Environmental error: no available transport.")}ph.prototype.g=function(t,e){return new Mn(t,e)};function Mn(t,e){$t.call(this),this.g=new wC(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ol(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ol(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new va(this)}qt(Mn,$t);Mn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;gn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=xC(t,null,t.Y),Cd(t)};Mn.prototype.close=function(){uv(this.g)};Mn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=ev(t),t=n);e.j.push(new S$(e.fb++,t)),e.H==3&&Cd(e)};Mn.prototype.N=function(){this.g.h=null,delete this.j,uv(this.g),delete this.g,Mn.$.N.call(this)};function NC(t){sv.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}qt(NC,sv);function DC(){ov.call(this),this.status=1}qt(DC,ov);function va(t){this.g=t}qt(va,RC);va.prototype.Ba=function(){Yt(this.g,"a")};va.prototype.Aa=function(t){Yt(this.g,new NC(t))};va.prototype.za=function(t){Yt(this.g,new DC)};va.prototype.ya=function(){Yt(this.g,"b")};function F$(){this.blockSize=-1}function ai(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}qt(ai,F$);ai.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Df(t,e,n){n||(n=0);var i=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[2]+606105819&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[3]+3250441966&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[6]+2821735955&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[7]+4249261313&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[10]+4294925233&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[11]+2304563134&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[14]+2792965006&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[15]+1236535329&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(r^s&(n^r))+i[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[11]+643717713&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[0]+3921069994&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[15]+3634488961&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[4]+3889429448&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[3]+4107603335&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[8]+1163531501&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[7]+1735328473&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[12]+2368359562&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(n^r^s)+i[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[11]+1839030562&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[14]+4259657740&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[7]+4139469664&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[10]+3200236656&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[3]+3572445317&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[6]+76029189&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[15]+530742520&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[2]+3299628645&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(r^(n|~s))+i[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[14]+2878612391&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[5]+4237533241&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[10]+4293915773&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[1]+2240044497&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[6]+2734768916&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[13]+1309151649&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[2]+718787259&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}ai.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=n;)Df(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Df(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Df(this,i),r=0;break}}this.h=r,this.i+=e};ai.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};function Ge(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=t[r]|0;i&&s==e||(n[r]=s,i=!1)}this.g=n}var B$={};function fv(t){return-128<=t&&128>t?KB(t,function(e){return new Ge([e|0],0>e?-1:0)}):new Ge([t|0],0>t?-1:0)}function _i(t){if(isNaN(t)||!isFinite(t))return Do;if(0>t)return Kt(_i(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=tm;return new Ge(e,0)}function OC(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Kt(OC(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=_i(Math.pow(e,8)),i=Do,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),o=parseInt(t.substring(r,r+s),e);8>s?(s=_i(Math.pow(e,s)),i=i.R(s).add(_i(o))):(i=i.R(n),i=i.add(_i(o)))}return i}var tm=4294967296,Do=fv(0),nm=fv(1),Bw=fv(16777216);ne=Ge.prototype;ne.ea=function(){if($n(this))return-Kt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:tm+i)*e,e*=tm}return t};ne.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if($i(this))return"0";if($n(this))return"-"+Kt(this).toString(t);for(var e=_i(Math.pow(t,6)),n=this,i="";;){var r=gh(n,e).g;n=mh(n,r.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=r,$i(n))return s+i;for(;6>s.length;)s="0"+s;i=s+i}};ne.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function $i(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function $n(t){return t.h==-1}ne.X=function(t){return t=mh(this,t),$n(t)?-1:$i(t)?0:1};function Kt(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new Ge(n,~t.h).add(nm)}ne.abs=function(){return $n(this)?Kt(this):this};ne.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(this.D(r)&65535)+(t.D(r)&65535),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Ge(n,n[n.length-1]&-2147483648?-1:0)};function mh(t,e){return t.add(Kt(e))}ne.R=function(t){if($i(this)||$i(t))return Do;if($n(this))return $n(t)?Kt(this).R(Kt(t)):Kt(Kt(this).R(t));if($n(t))return Kt(this.R(Kt(t)));if(0>this.X(Bw)&&0>t.X(Bw))return _i(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=this.D(i)&65535,a=t.D(r)>>>16,l=t.D(r)&65535;n[2*i+2*r]+=o*l,nu(n,2*i+2*r),n[2*i+2*r+1]+=s*l,nu(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,nu(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,nu(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new Ge(n,0)};function nu(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Oa(t,e){this.g=t,this.h=e}function gh(t,e){if($i(e))throw Error("division by zero");if($i(t))return new Oa(Do,Do);if($n(t))return e=gh(Kt(t),e),new Oa(Kt(e.g),Kt(e.h));if($n(e))return e=gh(t,Kt(e)),new Oa(Kt(e.g),e.h);if(30<t.g.length){if($n(t)||$n(e))throw Error("slowDivide_ only works with positive integers.");for(var n=nm,i=e;0>=i.X(t);)n=$w(n),i=$w(i);var r=oo(n,1),s=oo(i,1);for(i=oo(i,2),n=oo(n,2);!$i(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=oo(i,1),n=oo(n,1)}return e=mh(t,r.R(e)),new Oa(r,e)}for(r=Do;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=Math.ceil(Math.log(n)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),s=_i(n),o=s.R(e);$n(o)||0<o.X(t);)n-=i,s=_i(n),o=s.R(e);$i(s)&&(s=nm),r=r.add(s),t=mh(t,o)}return new Oa(r,t)}ne.gb=function(t){return gh(this,t).h};ne.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new Ge(n,this.h&t.h)};ne.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new Ge(n,this.h|t.h)};ne.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new Ge(n,this.h^t.h)};function $w(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new Ge(n,t.h)}function oo(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ge(r,t.h)}ph.prototype.createWebChannel=ph.prototype.g;Mn.prototype.send=Mn.prototype.u;Mn.prototype.open=Mn.prototype.m;Mn.prototype.close=Mn.prototype.close;_d.NO_ERROR=0;_d.TIMEOUT=8;_d.HTTP_ERROR=6;XS.COMPLETE="complete";JS.EventType=vc;vc.OPEN="a";vc.CLOSE="b";vc.ERROR="c";vc.MESSAGE="d";$t.prototype.listen=$t.prototype.O;ft.prototype.listenOnce=ft.prototype.P;ft.prototype.getLastError=ft.prototype.Sa;ft.prototype.getLastErrorCode=ft.prototype.Ia;ft.prototype.getStatus=ft.prototype.da;ft.prototype.getResponseJson=ft.prototype.Wa;ft.prototype.getResponseText=ft.prototype.ja;ft.prototype.send=ft.prototype.ha;ft.prototype.setWithCredentials=ft.prototype.Oa;ai.prototype.digest=ai.prototype.l;ai.prototype.reset=ai.prototype.reset;ai.prototype.update=ai.prototype.j;Ge.prototype.add=Ge.prototype.add;Ge.prototype.multiply=Ge.prototype.R;Ge.prototype.modulo=Ge.prototype.gb;Ge.prototype.compare=Ge.prototype.X;Ge.prototype.toNumber=Ge.prototype.ea;Ge.prototype.toString=Ge.prototype.toString;Ge.prototype.getBits=Ge.prototype.D;Ge.fromNumber=_i;Ge.fromString=OC;var $$=function(){return new ph},q$=function(){return yd()},Of=_d,U$=XS,V$=Gs,qw={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},z$=wc,iu=JS,j$=ft,H$=ai,Oo=Ge;const Uw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ya="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr=new ha("@firebase/firestore");function im(){return xr.logLevel}function K$(t){xr.setLogLevel(t)}function z(t,...e){if(xr.logLevel<=Ne.DEBUG){const n=e.map(pv);xr.debug(`Firestore (${ya}): ${t}`,...n)}}function yt(t,...e){if(xr.logLevel<=Ne.ERROR){const n=e.map(pv);xr.error(`Firestore (${ya}): ${t}`,...n)}}function li(t,...e){if(xr.logLevel<=Ne.WARN){const n=e.map(pv);xr.warn(`Firestore (${ya}): ${t}`,...n)}}function pv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t="Unexpected state"){const e=`FIRESTORE (${ya}) INTERNAL ASSERTION FAILED: `+t;throw yt(e),new Error(e)}function he(t,e){t||oe()}function W$(t,e){t||oe()}function te(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends ui{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G${getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ot.UNAUTHENTICATED))}shutdown(){}}class Q${constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Y${constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let i=this.i;const r=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let s=new Bt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Bt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Bt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(he(typeof i.accessToken=="string"),new PC(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new Ot(e)}}class X${constructor(e,n,i){this.h=e,this.l=n,this.m=i,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class J${constructor(e,n,i){this.h=e,this.l=n,this.m=i}getToken(){return Promise.resolve(new X$(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Z${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eq{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const i=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?r(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.T=n.token,new Z$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tq(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const r=tq(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=e.charAt(r[s]%e.length))}return i}}function be(t,e){return t<e?-1:t>e?1:0}function Ho(t,e,n){return t.length===e.length&&t.every((i,r)=>n(i,e[r]))}function LC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new U(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ot.fromMillis(Date.now())}static fromDate(e){return ot.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*n));return new ot(n,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new ot(0,0))}static max(){return new ue(new ot(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,n,i){n===void 0?n=0:n>e.length&&oe(),i===void 0?i=e.length-n:i>e.length-n&&oe(),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return Ul.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ul?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let r=0;r<i;r++){const s=e.get(r),o=n.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Le extends Ul{construct(e,n,i){return new Le(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new U(D.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new Le(n)}static emptyPath(){return new Le([])}}const nq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _t extends Ul{construct(e,n,i){return new _t(e,n,i)}static isValidIdentifier(e){return nq.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _t(["__name__"])}static fromServerFormat(e){const n=[];let i="",r=0;const s=()=>{if(i.length===0)throw new U(D.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new U(D.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new U(D.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _t(n)}static emptyPath(){return new _t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z{constructor(e){this.path=e}static fromPath(e){return new Z(Le.fromString(e))}static fromName(e){return new Z(Le.fromString(e).popFirst(5))}static empty(){return new Z(Le.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Le.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Le.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new Le(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e,n,i,r){this.indexId=e,this.collectionGroup=n,this.fields=i,this.indexState=r}}function rm(t){return t.fields.find(e=>e.kind===2)}function Zr(t){return t.fields.filter(e=>e.kind!==2)}FC.UNKNOWN_ID=-1;class iq{constructor(e,n){this.fieldPath=e,this.kind=n}}class vh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new vh(0,Ln.min())}}function BC(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=ue.fromTimestamp(i===1e9?new ot(n+1,0):new ot(n,i));return new Ln(r,Z.empty(),e)}function $C(t){return new Ln(t.readTime,t.key,-1)}class Ln{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ln(ue.min(),Z.empty(),-1)}static max(){return new Ln(ue.max(),Z.empty(),-1)}}function mv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Z.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ur(t){if(t.code!==D.FAILED_PRECONDITION||t.message!==qC)throw t;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new x((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(n,s).next(i,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof x?n:x.resolve(n)}catch(n){return x.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):x.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):x.reject(n)}static resolve(e){return new x((n,i)=>{n(e)})}static reject(e){return new x((n,i)=>{i(e)})}static waitFor(e){return new x((n,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&n()},l=>i(l))}),o=!0,s===r&&n()})}static or(e){let n=x.resolve(!1);for(const i of e)n=n.next(r=>r?x.resolve(r):i());return n}static forEach(e,n){const i=[];return e.forEach((r,s)=>{i.push(n.call(this,r,s))}),this.waitFor(i)}static mapArray(e,n){return new x((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===s&&i(o)},u=>r(u))}})}static doWhile(e,n){return new x((i,r)=>{const s=()=>{e()===!0?n().next(()=>{s()},r):i()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.v=new Bt,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{n.error?this.v.reject(new cl(e,n.error)):this.v.resolve()},this.transaction.onerror=i=>{const r=gv(i.target.error);this.v.reject(new cl(e,r))}}static open(e,n,i,r){try{return new kd(n,e.transaction(r,i))}catch(s){throw new cl(n,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new sq(n)}}class ti{constructor(e,n,i){this.name=e,this.version=n,this.V=i,ti.S(kt())===12.2&&yt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return z("SimpleDb","Removing database:",e),rs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!hg())return!1;if(ti.C())return!0;const e=kt(),n=ti.S(e),i=0<n&&n<10,r=ti.N(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.k)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static N(e){const n=e.match(/Android ([\d.]+)/i),i=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(i)}async $(e){return this.db||(z("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{const o=s.target.result;n(o)},r.onblocked=()=>{i(new cl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{const o=s.target.error;o.name==="VersionError"?i(new U(D.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new U(D.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new cl(e,o))},r.onupgradeneeded=s=>{z("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.V.O(o,r.transaction,s.oldVersion,this.version).next(()=>{z("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=n=>this.F(n)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,i,r){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.$(e);const a=kd.open(this.db,e,s?"readonly":"readwrite",i),l=r(a).next(c=>(a.P(),c)).catch(c=>(a.abort(c),x.reject(c))).toPromise();return l.catch(()=>{}),await a.R,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(z("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}class rq{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return rs(this.L.delete())}}class cl extends U{constructor(e,n){super(D.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Vr(t){return t.name==="IndexedDbTransactionError"}class sq{constructor(e){this.store=e}put(e,n){let i;return n!==void 0?(z("SimpleDb","PUT",this.store.name,e,n),i=this.store.put(n,e)):(z("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),rs(i)}add(e){return z("SimpleDb","ADD",this.store.name,e,e),rs(this.store.add(e))}get(e){return rs(this.store.get(e)).next(n=>(n===void 0&&(n=null),z("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return z("SimpleDb","DELETE",this.store.name,e),rs(this.store.delete(e))}count(){return z("SimpleDb","COUNT",this.store.name),rs(this.store.count())}j(e,n){const i=this.options(e,n);if(i.index||typeof this.store.getAll!="function"){const r=this.cursor(i),s=[];return this.W(r,(o,a)=>{s.push(a)}).next(()=>s)}{const r=this.store.getAll(i.range);return new x((s,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{s(a.target.result)}})}}H(e,n){const i=this.store.getAll(e,n===null?void 0:n);return new x((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}J(e,n){z("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,n);i.Y=!1;const r=this.cursor(i);return this.W(r,(s,o,a)=>a.delete())}X(e,n){let i;n?i=e:(i={},n=e);const r=this.cursor(i);return this.W(r,n)}Z(e){const n=this.cursor({});return new x((i,r)=>{n.onerror=s=>{const o=gv(s.target.error);r(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():i()}):i()}})}W(e,n){const i=[];return new x((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const l=new rq(a),c=n(a.primaryKey,a.value,l);if(c instanceof x){const u=c.catch(h=>(l.done(),x.reject(h)));i.push(u)}l.isDone?r():l.K===null?a.continue():a.continue(l.K)}}).next(()=>x.waitFor(i))}options(e,n){let i;return e!==void 0&&(typeof e=="string"?i=e:n=e),{index:i,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const i=this.store.index(e.index);return e.Y?i.openKeyCursor(e.range,n):i.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function rs(t){return new x((e,n)=>{t.onsuccess=i=>{const r=i.target.result;e(r)},t.onerror=i=>{const r=gv(i.target.error);n(r)}})}let Vw=!1;function gv(t){const e=ti.S(kt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const i=new U("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Vw||(Vw=!0,setTimeout(()=>{throw i},0)),i}}return t}class oq{constructor(e,n){this.asyncQueue=e,this.tt=n,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}et(e){z("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{z("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(n){Vr(n)?z("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Ur(n)}await this.et(6e4)})}}class aq{constructor(e,n){this.localStore=e,this.persistence=n}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.st(n,e))}st(e,n){const i=new Set;let r=n,s=!0;return x.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!i.has(o))return z("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,r).next(a=>{r-=a,i.add(o)});s=!1})).next(()=>n-r)}it(e,n,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,i).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(r,s)).next(a=>(z("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}rt(e,n){let i=e;return n.changes.forEach((r,s)=>{const o=$C(s);mv(o,i)>0&&(i=o)}),new Ln(i.readTime,i.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}bn.ct=-1;function Ic(t){return t==null}function Vl(t){return t===0&&1/t==-1/0}function VC(t){return typeof t=="number"&&Number.isInteger(t)&&!Vl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=zw(e)),e=lq(t.get(n),e);return zw(e)}function lq(t,e){let n=e;const i=t.length;for(let r=0;r<i;r++){const s=t.charAt(r);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function zw(t){return t+""}function wi(t){const e=t.length;if(he(e>=2),e===2)return he(t.charAt(0)===""&&t.charAt(1)===""),Le.emptyPath();const n=e-2,i=[];let r="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&oe(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;r.length===0?l=a:(r+=a,l=r,r=""),i.push(l);break;case"":r+=t.substring(s,o),r+="\0";break;case"":r+=t.substring(s,o+1);break;default:oe()}s=o+2}return new Le(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t,e){return[t,vn(e)]}function zC(t,e,n){return[t,vn(e),n]}const cq={},uq=["prefixPath","collectionGroup","readTime","documentId"],hq=["prefixPath","collectionGroup","documentId"],dq=["collectionGroup","readTime","prefixPath","documentId"],fq=["canonicalId","targetId"],pq=["targetId","path"],mq=["path","targetId"],gq=["collectionId","parent"],vq=["indexId","uid"],yq=["uid","sequenceNumber"],_q=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],wq=["indexId","uid","orderedDocumentKey"],bq=["userId","collectionPath","documentId"],Eq=["userId","collectionPath","largestBatchId"],Iq=["userId","collectionGroup","largestBatchId"],jC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Tq=[...jC,"documentOverlays"],HC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],KC=HC,Sq=[...KC,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm extends UC{constructor(e,n){super(),this.ht=e,this.currentSequenceNumber=n}}function Ut(t,e){const n=te(t);return ti.M(n.ht,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Qs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function WC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new et(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new et(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){const e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ru(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ru(this.root,e,this.comparator,!1)}getReverseIterator(){return new ru(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ru(this.root,e,this.comparator,!0)}}class ru{constructor(e,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?i(e.key,n):1,n&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??jt.RED,this.left=r??jt.EMPTY,this.right=s??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,r,s){return new jt(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return jt.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(t,e,n,i,r){return this}insert(t,e,n){return new jt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new et(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Kw(this.data.getIterator())}getIteratorFrom(e){return new Kw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new at(this.comparator);return n.data=e,n}}class Kw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ao(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.fields=e,e.sort(_t.comparator)}static empty(){return new En([])}unionWith(e){let n=new at(_t.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new En(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cq(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new GC("Invalid base64 string: "+r):r}}(e);return new xt(n)}static fromUint8Array(e){const n=function(i){let r="";for(let s=0;s<i.length;++s)r+=String.fromCharCode(i[s]);return r}(e);return new xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xt.EMPTY_BYTE_STRING=new xt("");const kq=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(t){if(he(!!t),typeof t=="string"){let e=0;const n=kq.exec(t);if(he(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Rr(t){return typeof t=="string"?xt.fromBase64String(t):xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vv(t){const e=t.mapValue.fields.__previous_value__;return xd(e)?vv(e):e}function zl(t){const e=Ar(t.mapValue.fields.__local_write_time__.timestampValue);return new ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e,n,i,r,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Nr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Nr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ru={nullValue:"NULL_VALUE"};function Os(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xd(t)?4:QC(t)?9007199254740991:10:oe()}function Ri(t,e){if(t===e)return!0;const n=Os(t);if(n!==Os(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zl(t).isEqual(zl(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const s=Ar(i.timestampValue),o=Ar(r.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,r){return Rr(i.bytesValue).isEqual(Rr(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,r){return dt(i.geoPointValue.latitude)===dt(r.geoPointValue.latitude)&&dt(i.geoPointValue.longitude)===dt(r.geoPointValue.longitude)}(t,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return dt(i.integerValue)===dt(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const s=dt(i.doubleValue),o=dt(r.doubleValue);return s===o?Vl(s)===Vl(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Ho(t.arrayValue.values||[],e.arrayValue.values||[],Ri);case 10:return function(i,r){const s=i.mapValue.fields||{},o=r.mapValue.fields||{};if(Hw(s)!==Hw(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!Ri(s[a],o[a])))return!1;return!0}(t,e);default:return oe()}}function jl(t,e){return(t.values||[]).find(n=>Ri(n,e))!==void 0}function Dr(t,e){if(t===e)return 0;const n=Os(t),i=Os(e);if(n!==i)return be(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(r,s){const o=dt(r.integerValue||r.doubleValue),a=dt(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Ww(t.timestampValue,e.timestampValue);case 4:return Ww(zl(t),zl(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(r,s){const o=Rr(r),a=Rr(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,s){const o=r.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=be(o[l],a[l]);if(c!==0)return c}return be(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,s){const o=be(dt(r.latitude),dt(s.latitude));return o!==0?o:be(dt(r.longitude),dt(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,s){const o=r.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=Dr(o[l],a[l]);if(c)return c}return be(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===gr.mapValue&&s===gr.mapValue)return 0;if(r===gr.mapValue)return 1;if(s===gr.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),l=s.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const h=be(a[u],c[u]);if(h!==0)return h;const d=Dr(o[a[u]],l[c[u]]);if(d!==0)return d}return be(a.length,c.length)}(t.mapValue,e.mapValue);default:throw oe()}}function Ww(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=Ar(t),i=Ar(e),r=be(n.seconds,i.seconds);return r!==0?r:be(n.nanos,i.nanos)}function Ko(t){return om(t)}function om(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(i){const r=Ar(i);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Rr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Z.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(i){let r="[",s=!0;for(const o of i.values||[])s?s=!1:r+=",",r+=om(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(i){const r=Object.keys(i.fields||{}).sort();let s="{",o=!0;for(const a of r)o?o=!1:s+=",",s+=`${a}:${om(i.fields[a])}`;return s+"}"}(t.mapValue):oe();var e,n}function Ps(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function am(t){return!!t&&"integerValue"in t}function Hl(t){return!!t&&"arrayValue"in t}function Gw(t){return!!t&&"nullValue"in t}function Qw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nu(t){return!!t&&"mapValue"in t}function ul(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Qs(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=ul(i)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ul(t.arrayValue.values[n]);return e}return Object.assign({},t)}function QC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Aq(t){return"nullValue"in t?Ru:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ps(Nr.empty(),Z.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:oe()}function Rq(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ps(Nr.empty(),Z.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?gr:oe()}function Yw(t,e){const n=Dr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Xw(t,e){const n=Dr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.value=e}static empty(){return new Gt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Nu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ul(n)}setAll(e){let n=_t.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,i,r),i={},r=[],n=a.popLast()}o?i[a.lastSegment()]=ul(o):r.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,i,r)}delete(e){const n=this.field(e.popLast());Nu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ri(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=n.mapValue.fields[e.get(i)];Nu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,i){Qs(n,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Gt(ul(this.value))}}function YC(t){const e=[];return Qs(t.fields,(n,i)=>{const r=new _t([n]);if(Nu(i)){const s=YC(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new En(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,n,i,r,s,o,a){this.key=e,this.documentType=n,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new st(e,0,ue.min(),ue.min(),ue.min(),Gt.empty(),0)}static newFoundDocument(e,n,i,r){return new st(e,1,n,ue.min(),i,r,0)}static newNoDocument(e,n){return new st(e,2,n,ue.min(),ue.min(),Gt.empty(),0)}static newUnknownDocument(e,n){return new st(e,3,n,ue.min(),ue.min(),Gt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof st&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new st(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,n){this.position=e,this.inclusive=n}}function Jw(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(s.field.isKeyField()?i=Z.comparator(Z.fromName(o.referenceValue),n.key):i=Dr(o,n.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function Zw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e,n="asc"){this.field=e,this.dir=n}}function Nq(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{}class Re extends XC{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new Dq(e,n,i):n==="array-contains"?new Mq(e,i):n==="in"?new ik(e,i):n==="not-in"?new Lq(e,i):n==="array-contains-any"?new Fq(e,i):new Re(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new Oq(e,i):new Pq(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Dr(n,this.value)):n!==null&&Os(this.value)===Os(n)&&this.matchesComparison(Dr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class We extends XC{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new We(e,n)}matches(e){return Wo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Wo(t){return t.op==="and"}function lm(t){return t.op==="or"}function yv(t){return JC(t)&&Wo(t)}function JC(t){for(const e of t.filters)if(e instanceof We)return!1;return!0}function cm(t){if(t instanceof Re)return t.field.canonicalString()+t.op.toString()+Ko(t.value);if(yv(t))return t.filters.map(e=>cm(e)).join(",");{const e=t.filters.map(n=>cm(n)).join(",");return`${t.op}(${e})`}}function ZC(t,e){return t instanceof Re?function(n,i){return i instanceof Re&&n.op===i.op&&n.field.isEqual(i.field)&&Ri(n.value,i.value)}(t,e):t instanceof We?function(n,i){return i instanceof We&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((r,s,o)=>r&&ZC(s,i.filters[o]),!0):!1}(t,e):void oe()}function ek(t,e){const n=t.filters.concat(e);return We.create(n,t.op)}function tk(t){return t instanceof Re?function(e){return`${e.field.canonicalString()} ${e.op} ${Ko(e.value)}`}(t):t instanceof We?function(e){return e.op.toString()+" {"+e.getFilters().map(tk).join(" ,")+"}"}(t):"Filter"}class Dq extends Re{constructor(e,n,i){super(e,n,i),this.key=Z.fromName(i.referenceValue)}matches(e){const n=Z.comparator(e.key,this.key);return this.matchesComparison(n)}}class Oq extends Re{constructor(e,n){super(e,"in",n),this.keys=nk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Pq extends Re{constructor(e,n){super(e,"not-in",n),this.keys=nk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function nk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(i=>Z.fromName(i.referenceValue))}class Mq extends Re{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hl(n)&&jl(n.arrayValue,this.value)}}class ik extends Re{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jl(this.value.arrayValue,n)}}class Lq extends Re{constructor(e,n){super(e,"not-in",n)}matches(e){if(jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!jl(this.value.arrayValue,n)}}class Fq extends Re{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>jl(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bq{constructor(e,n=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function um(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Bq(t,e,n,i,r,s,o)}function Ms(t){const e=te(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(i=>cm(i)).join(","),n+="|ob:",n+=e.orderBy.map(i=>function(r){return r.field.canonicalString()+r.dir}(i)).join(","),Ic(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>Ko(i)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>Ko(i)).join(",")),e.dt=n}return e.dt}function Tc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Nq(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ZC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Zw(t.startAt,e.startAt)&&Zw(t.endAt,e.endAt)}function yh(t){return Z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function _h(t,e){return t.filters.filter(n=>n instanceof Re&&n.field.isEqual(e))}function e0(t,e,n){let i=Ru,r=!0;for(const s of _h(t,e)){let o=Ru,a=!0;switch(s.op){case"<":case"<=":o=Aq(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ru}Yw({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Yw({value:i,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(i=o,r=n.inclusive);break}}return{value:i,inclusive:r}}function t0(t,e,n){let i=gr,r=!0;for(const s of _h(t,e)){let o=gr,a=!0;switch(s.op){case">=":case">":o=Rq(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=gr}Xw({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Xw({value:i,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(i=o,r=n.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,n=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.wt=null,this._t=null,this.startAt,this.endAt}}function rk(t,e,n,i,r,s,o,a){return new Qi(t,e,n,i,r,s,o,a)}function _a(t){return new Qi(t)}function n0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _v(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ad(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function wv(t){return t.collectionGroup!==null}function bs(t){const e=te(t);if(e.wt===null){e.wt=[];const n=Ad(e),i=_v(e);if(n!==null&&i===null)n.isKeyField()||e.wt.push(new Po(n)),e.wt.push(new Po(_t.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Po(_t.keyField(),s))}}}return e.wt}function Sn(t){const e=te(t);if(!e._t)if(e.limitType==="F")e._t=um(e.path,e.collectionGroup,bs(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of bs(e)){const o=s.dir==="desc"?"asc":"desc";n.push(new Po(s.field,o))}const i=e.endAt?new Or(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Or(e.startAt.position,e.startAt.inclusive):null;e._t=um(e.path,e.collectionGroup,n,e.filters,e.limit,i,r)}return e._t}function hm(t,e){e.getFirstInequalityField(),Ad(t);const n=t.filters.concat([e]);return new Qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function wh(t,e,n){return new Qi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sc(t,e){return Tc(Sn(t),Sn(e))&&t.limitType===e.limitType}function sk(t){return`${Ms(Sn(t))}|lt:${t.limitType}`}function dm(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(i=>tk(i)).join(", ")}]`),Ic(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(i=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(i)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>Ko(i)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>Ko(i)).join(",")),`Target(${n})`}(Sn(t))}; limitType=${t.limitType})`}function Cc(t,e){return e.isFoundDocument()&&function(n,i){const r=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):Z.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,i){for(const r of bs(n))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const r of n.filters)if(!r.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(r,s,o){const a=Jw(r,s,o);return r.inclusive?a<=0:a<0}(n.startAt,bs(n),i)||n.endAt&&!function(r,s,o){const a=Jw(r,s,o);return r.inclusive?a>=0:a>0}(n.endAt,bs(n),i))}(t,e)}function ok(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ak(t){return(e,n)=>{let i=!1;for(const r of bs(t)){const s=$q(r,e,n);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function $q(t,e,n){const i=t.field.isKeyField()?Z.comparator(e.key,n.key):function(r,s,o){const a=s.data.field(r),l=o.data.field(r);return a!==null&&l!==null?Dr(a,l):oe()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[n]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qs(this.inner,(n,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return WC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=new et(Z.comparator);function In(){return qq}const lk=new et(Z.comparator);function Qa(...t){let e=lk;for(const n of t)e=e.insert(n.key,n);return e}function ck(t){let e=lk;return t.forEach((n,i)=>e=e.insert(n,i.overlayedDocument)),e}function bi(){return hl()}function uk(){return hl()}function hl(){return new zr(t=>t.toString(),(t,e)=>t.isEqual(e))}const Uq=new et(Z.comparator),Vq=new at(Z.comparator);function Ie(...t){let e=Vq;for(const n of t)e=e.add(n);return e}const zq=new at(be);function bv(){return zq}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vl(e)?"-0":e}}function dk(t){return{integerValue:""+t}}function fk(t,e){return VC(e)?dk(e):hk(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(){this._=void 0}}function jq(t,e,n){return t instanceof Go?function(i,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&xd(r)&&(r=vv(r)),r&&(s.fields.__previous_value__=r),{mapValue:s}}(n,e):t instanceof Ls?mk(t,e):t instanceof Fs?gk(t,e):function(i,r){const s=pk(i,r),o=i0(s)+i0(i.gt);return am(s)&&am(i.gt)?dk(o):hk(i.serializer,o)}(t,e)}function Hq(t,e,n){return t instanceof Ls?mk(t,e):t instanceof Fs?gk(t,e):n}function pk(t,e){return t instanceof Qo?am(n=e)||function(i){return!!i&&"doubleValue"in i}(n)?e:{integerValue:0}:null;var n}class Go extends Rd{}class Ls extends Rd{constructor(e){super(),this.elements=e}}function mk(t,e){const n=vk(e);for(const i of t.elements)n.some(r=>Ri(r,i))||n.push(i);return{arrayValue:{values:n}}}class Fs extends Rd{constructor(e){super(),this.elements=e}}function gk(t,e){let n=vk(e);for(const i of t.elements)n=n.filter(r=>!Ri(r,i));return{arrayValue:{values:n}}}class Qo extends Rd{constructor(e,n){super(),this.serializer=e,this.gt=n}}function i0(t){return dt(t.integerValue||t.doubleValue)}function vk(t){return Hl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,n){this.field=e,this.transform=n}}function Kq(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Ls&&i instanceof Ls||n instanceof Fs&&i instanceof Fs?Ho(n.elements,i.elements,Ri):n instanceof Qo&&i instanceof Qo?Ri(n.gt,i.gt):n instanceof Go&&i instanceof Go}(t.transform,e.transform)}class Wq{constructor(e,n){this.version=e,this.transformResults=n}}class ht{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ht}static exists(e){return new ht(void 0,e)}static updateTime(e){return new ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Du(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nd{}function yk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ba(t.key,ht.none()):new wa(t.key,t.data,ht.none());{const n=t.data,i=Gt.empty();let r=new at(_t.comparator);for(let s of e.fields)if(!r.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Yi(t.key,i,new En(r.toArray()),ht.none())}}function Gq(t,e,n){t instanceof wa?function(i,r,s){const o=i.value.clone(),a=s0(i.fieldTransforms,r,s.transformResults);o.setAll(a),r.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Yi?function(i,r,s){if(!Du(i.precondition,r))return void r.convertToUnknownDocument(s.version);const o=s0(i.fieldTransforms,r,s.transformResults),a=r.data;a.setAll(_k(i)),a.setAll(o),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):function(i,r,s){r.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function dl(t,e,n,i){return t instanceof wa?function(r,s,o,a){if(!Du(r.precondition,s))return o;const l=r.value.clone(),c=o0(r.fieldTransforms,a,s);return l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,n,i):t instanceof Yi?function(r,s,o,a){if(!Du(r.precondition,s))return o;const l=o0(r.fieldTransforms,a,s),c=s.data;return c.setAll(_k(r)),c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,n,i):function(r,s,o){return Du(r.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,n)}function Qq(t,e){let n=null;for(const i of t.fieldTransforms){const r=e.data.field(i.field),s=pk(i.transform,r||null);s!=null&&(n===null&&(n=Gt.empty()),n.set(i.field,s))}return n||null}function r0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ho(n,i,(r,s)=>Kq(r,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wa extends Nd{constructor(e,n,i,r=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Yi extends Nd{constructor(e,n,i,r,s=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function _k(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function s0(t,e,n){const i=new Map;he(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Hq(o,a,n[r]))}return i}function o0(t,e,n){const i=new Map;for(const r of t){const s=r.transform,o=n.data.field(r.field);i.set(r.field,jq(s,o,e))}return i}class ba extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ev extends Nd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e,n,i,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Gq(s,e,i[r])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=dl(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=dl(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=uk();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(r.key)?null:a;const l=yk(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ue.min())}),i}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,(n,i)=>r0(n,i))&&Ho(this.baseMutations,e.baseMutations,(n,i)=>r0(n,i))}}class Tv{constructor(e,n,i,r){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=r}static from(e,n,i){he(e.mutations.length===i.length);let r=Uq;const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new Tv(e,n,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St,Oe;function wk(t){switch(t){default:return oe();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0}}function bk(t){if(t===void 0)return yt("GRPC error has no .code"),D.UNKNOWN;switch(t){case St.OK:return D.OK;case St.CANCELLED:return D.CANCELLED;case St.UNKNOWN:return D.UNKNOWN;case St.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case St.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case St.INTERNAL:return D.INTERNAL;case St.UNAVAILABLE:return D.UNAVAILABLE;case St.UNAUTHENTICATED:return D.UNAUTHENTICATED;case St.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case St.NOT_FOUND:return D.NOT_FOUND;case St.ALREADY_EXISTS:return D.ALREADY_EXISTS;case St.PERMISSION_DENIED:return D.PERMISSION_DENIED;case St.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case St.ABORTED:return D.ABORTED;case St.OUT_OF_RANGE:return D.OUT_OF_RANGE;case St.UNIMPLEMENTED:return D.UNIMPLEMENTED;case St.DATA_LOSS:return D.DATA_LOSS;default:return oe()}}(Oe=St||(St={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return su}static getOrCreateInstance(){return su===null&&(su=new Cv),su}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let su=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xq=new Oo([4294967295,4294967295],0);function a0(t){const e=Ek().encode(t),n=new H$;return n.update(e),new Uint8Array(n.digest())}function l0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Oo([n,i],0),new Oo([r,s],0)]}class kv{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Ya(`Invalid padding: ${n}`);if(i<0)throw new Ya(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ya(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Ya(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=Oo.fromNumber(this.It)}Et(e,n,i){let r=e.add(n.multiply(Oo.fromNumber(i)));return r.compare(Xq)===1&&(r=new Oo([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=a0(e),[i,r]=l0(n);for(let s=0;s<this.hashCount;s++){const o=this.Et(i,r,s);if(!this.At(o))return!1}return!0}static create(e,n,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new kv(s,r,n);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const n=a0(e),[i,r]=l0(n);for(let s=0;s<this.hashCount;s++){const o=this.Et(i,r,s);this.Rt(o)}}Rt(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Ya extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n,i,r,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const r=new Map;return r.set(e,Ac.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new xc(ue.min(),r,new et(be),In(),Ie())}}class Ac{constructor(e,n,i,r,s){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new Ac(i,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n,i,r){this.Pt=e,this.removedTargetIds=n,this.key=i,this.bt=r}}class Ik{constructor(e,n){this.targetId=e,this.Vt=n}}class Tk{constructor(e,n,i=xt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=r}}class c0{constructor(){this.St=0,this.Dt=h0(),this.Ct=xt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Ie(),n=Ie(),i=Ie();return this.Dt.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:i=i.add(r);break;default:oe()}}),new Ac(this.Ct,this.xt,e,n,i)}Ft(){this.Nt=!1,this.Dt=h0()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Jq{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=In(),this.zt=u0(),this.Wt=new et(be)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const i=this.Zt(n);switch(e.state){case 0:this.te(n)&&i.$t(e.resumeToken);break;case 1:i.Ut(),i.kt||i.Ft(),i.$t(e.resumeToken);break;case 2:i.Ut(),i.kt||this.removeTarget(n);break;case 3:this.te(n)&&(i.Kt(),i.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),i.$t(e.resumeToken));break;default:oe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((i,r)=>{this.te(r)&&n(r)})}ne(e){var n;const i=e.targetId,r=e.Vt.count,s=this.se(i);if(s){const o=s.target;if(yh(o))if(r===0){const a=new Z(o.path);this.Yt(i,a,st.newNoDocument(a,ue.min()))}else he(r===1);else{const a=this.ie(i);if(a!==r){const l=this.re(e,a);if(l!==0){this.ee(i);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(i,c)}(n=Cv.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(c,u,h){var d,f,p,m,g,w;const v={localCacheCount:u,existenceFilterCount:h.count},b=h.unchangedNames;return b&&(v.bloomFilter={applied:c===0,hashCount:(d=b==null?void 0:b.hashCount)!==null&&d!==void 0?d:0,bitmapLength:(m=(p=(f=b==null?void 0:b.bits)===null||f===void 0?void 0:f.bitmap)===null||p===void 0?void 0:p.length)!==null&&m!==void 0?m:0,padding:(w=(g=b==null?void 0:b.bits)===null||g===void 0?void 0:g.padding)!==null&&w!==void 0?w:0}),v}(l,a,e.Vt))}}}}re(e,n){const{unchangedNames:i,count:r}=e.Vt;if(!i||!i.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=i;let l,c;try{l=Rr(s).toUint8Array()}catch(u){if(u instanceof GC)return li("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{c=new kv(l,o,a)}catch(u){return li(u instanceof Ya?"BloomFilter error: ":"Applying bloom filter failed: ",u),1}return c.It===0?1:r!==n-this.oe(e.targetId,c)?2:0}oe(e,n){const i=this.Gt.getRemoteKeysForTarget(e);let r=0;return i.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;n.vt(a)||(this.Yt(e,s,null),r++)}),r}ce(e){const n=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&yh(a.target)){const l=new Z(a.target.path);this.jt.get(l)!==null||this.ae(o,l)||this.Yt(o,l,st.newNoDocument(l,e))}s.Mt&&(n.set(o,s.Ot()),s.Ft())}});let i=Ie();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.se(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const r=new xc(e,n,this.Wt,this.jt,i);return this.jt=In(),this.zt=u0(),this.Wt=new et(be),r}Jt(e,n){if(!this.te(e))return;const i=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,i),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,i){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,n)?r.Bt(n,1):r.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),i&&(this.jt=this.jt.insert(n,i))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new c0,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new at(be),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||z("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new c0),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function u0(){return new et(Z.comparator)}function h0(){return new et(Z.comparator)}const Zq=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),eU=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),tU=(()=>({and:"AND",or:"OR"}))();class nU{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function fm(t,e){return t.useProto3Json||Ic(e)?e:{value:e}}function Yo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function iU(t,e){return Yo(t,e.toTimestamp())}function wt(t){return he(!!t),ue.fromTimestamp(function(e){const n=Ar(e);return new ot(n.seconds,n.nanos)}(t))}function xv(t,e){return function(n){return new Le(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Ck(t){const e=Le.fromString(t);return he(Mk(e)),e}function Kl(t,e){return xv(t.databaseId,e.path)}function Si(t,e){const n=Ck(e);if(n.get(1)!==t.databaseId.projectId)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new U(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Z(xk(n))}function pm(t,e){return xv(t.databaseId,e)}function kk(t){const e=Ck(t);return e.length===4?Le.emptyPath():xk(e)}function Wl(t){return new Le(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function xk(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function d0(t,e,n){return{name:Kl(t,e),fields:n.value.mapValue.fields}}function Ak(t,e,n){const i=Si(t,e.name),r=wt(e.updateTime),s=e.createTime?wt(e.createTime):ue.min(),o=new Gt({mapValue:{fields:e.fields}}),a=st.newFoundDocument(i,r,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function rU(t,e){return"found"in e?function(n,i){he(!!i.found),i.found.name,i.found.updateTime;const r=Si(n,i.found.name),s=wt(i.found.updateTime),o=i.found.createTime?wt(i.found.createTime):ue.min(),a=new Gt({mapValue:{fields:i.found.fields}});return st.newFoundDocument(r,s,o,a)}(t,e):"missing"in e?function(n,i){he(!!i.missing),he(!!i.readTime);const r=Si(n,i.missing),s=wt(i.readTime);return st.newNoDocument(r,s)}(t,e):oe()}function sU(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(l,c){return l.useProto3Json?(he(c===void 0||typeof c=="string"),xt.fromBase64String(c||"")):(he(c===void 0||c instanceof Uint8Array),xt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?D.UNKNOWN:bk(l.code);return new U(c,l.message||"")}(o);n=new Tk(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Si(t,i.document.name),s=wt(i.document.updateTime),o=i.document.createTime?wt(i.document.createTime):ue.min(),a=new Gt({mapValue:{fields:i.document.fields}}),l=st.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Ou(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Si(t,i.document),s=i.readTime?wt(i.readTime):ue.min(),o=st.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Ou([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Si(t,i.document),s=i.removedTargetIds||[];n=new Ou([],s,r,null)}else{if(!("filter"in e))return oe();{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new Yq(r,s),a=i.targetId;n=new Ik(a,o)}}return n}function Gl(t,e){let n;if(e instanceof wa)n={update:d0(t,e.key,e.value)};else if(e instanceof ba)n={delete:Kl(t,e.key)};else if(e instanceof Yi)n={update:d0(t,e.key,e.data),updateMask:hU(e.fieldMask)};else{if(!(e instanceof Ev))return oe();n={verify:Kl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(i=>function(r,s){const o=s.transform;if(o instanceof Go)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ls)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Fs)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Qo)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw oe()}(0,i))),e.precondition.isNone||(n.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:iU(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:oe()}(t,e.precondition)),n}function mm(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?ht.updateTime(wt(r.updateTime)):r.exists!==void 0?ht.exists(r.exists):ht.none()}(e.currentDocument):ht.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(s,o){let a=null;if("setToServerValue"in o)he(o.setToServerValue==="REQUEST_TIME"),a=new Go;else if("appendMissingElements"in o){const c=o.appendMissingElements.values||[];a=new Ls(c)}else if("removeAllFromArray"in o){const c=o.removeAllFromArray.values||[];a=new Fs(c)}else"increment"in o?a=new Qo(s,o.increment):oe();const l=_t.fromServerFormat(o.fieldPath);return new kc(l,a)}(t,r)):[];if(e.update){e.update.name;const r=Si(t,e.update.name),s=new Gt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const l=a.fieldPaths||[];return new En(l.map(c=>_t.fromServerFormat(c)))}(e.updateMask);return new Yi(r,s,o,n,i)}return new wa(r,s,n,i)}if(e.delete){const r=Si(t,e.delete);return new ba(r,n)}if(e.verify){const r=Si(t,e.verify);return new Ev(r,n)}return oe()}function oU(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(i,r){let s=i.updateTime?wt(i.updateTime):wt(r);return s.isEqual(ue.min())&&(s=wt(r)),new Wq(s,i.transformResults||[])}(n,e))):[]}function Rk(t,e){return{documents:[pm(t,e.path)]}}function Nk(t,e){const n={structuredQuery:{}},i=e.path;e.collectionGroup!==null?(n.parent=pm(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=pm(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(l){if(l.length!==0)return Pk(We.create(l,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const s=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:po(u.field),direction:lU(u.dir)}}(c))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=fm(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function Dk(t){let e=kk(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){he(i===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=function(u){const h=Ok(u);return h instanceof We&&yv(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new Po(mo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Ic(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(u){const h=!!u.before,d=u.values||[];return new Or(d,h)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const h=!u.before,d=u.values||[];return new Or(d,h)}(n.endAt)),rk(e,r,o,s,a,"F",l,c)}function aU(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ok(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=mo(e.unaryFilter.field);return Re.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=mo(e.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=mo(e.unaryFilter.field);return Re.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=mo(e.unaryFilter.field);return Re.create(s,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(t):t.fieldFilter!==void 0?function(e){return Re.create(mo(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return We.create(e.compositeFilter.filters.map(n=>Ok(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return oe()}}(e.compositeFilter.op))}(t):oe()}function lU(t){return Zq[t]}function cU(t){return eU[t]}function uU(t){return tU[t]}function po(t){return{fieldPath:t.canonicalString()}}function mo(t){return _t.fromServerFormat(t.fieldPath)}function Pk(t){return t instanceof Re?function(e){if(e.op==="=="){if(Qw(e.value))return{unaryFilter:{field:po(e.field),op:"IS_NAN"}};if(Gw(e.value))return{unaryFilter:{field:po(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Qw(e.value))return{unaryFilter:{field:po(e.field),op:"IS_NOT_NAN"}};if(Gw(e.value))return{unaryFilter:{field:po(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:po(e.field),op:cU(e.op),value:e.value}}}(t):t instanceof We?function(e){const n=e.getFilters().map(i=>Pk(i));return n.length===1?n[0]:{compositeFilter:{op:uU(e.op),filters:n}}}(t):oe()}function hU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Mk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,n,i,r,s=ue.min(),o=ue.min(),a=xt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e){this.fe=e}}function dU(t,e){let n;if(e.document)n=Ak(t.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Z.fromSegments(e.noDocument.path),r=$s(e.noDocument.readTime);n=st.newNoDocument(i,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return oe();{const i=Z.fromSegments(e.unknownDocument.path),r=$s(e.unknownDocument.version);n=st.newUnknownDocument(i,r)}}return e.readTime&&n.setReadTime(function(i){const r=new ot(i[0],i[1]);return ue.fromTimestamp(r)}(e.readTime)),n}function f0(t,e){const n=e.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:bh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(r,s){return{name:Kl(r,s.key),fields:s.data.value.mapValue.fields,updateTime:Yo(r,s.version.toTimestamp()),createTime:Yo(r,s.createTime.toTimestamp())}}(t.fe,e);else if(e.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:Bs(e.version)};else{if(!e.isUnknownDocument())return oe();i.unknownDocument={path:n.path.toArray(),version:Bs(e.version)}}return i}function bh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Bs(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $s(t){const e=new ot(t.seconds,t.nanoseconds);return ue.fromTimestamp(e)}function ss(t,e){const n=(e.baseMutations||[]).map(s=>mm(t.fe,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const i=e.mutations.map(s=>mm(t.fe,s)),r=ot.fromMillis(e.localWriteTimeMs);return new Iv(e.batchId,r,n,i)}function Xa(t){const e=$s(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?$s(t.lastLimboFreeSnapshotVersion):ue.min();let i;var r;return t.query.documents!==void 0?(he((r=t.query).documents.length===1),i=Sn(_a(kk(r.documents[0])))):i=function(s){return Sn(Dk(s))}(t.query),new qi(i,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,xt.fromBase64String(t.resumeToken))}function Fk(t,e){const n=Bs(e.snapshotVersion),i=Bs(e.lastLimboFreeSnapshotVersion);let r;r=yh(e.target)?Rk(t.fe,e.target):Nk(t.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ms(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Av(t){const e=Dk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wh(e,e.limit,"L"):e}function Pf(t,e){return new Sv(e.largestBatchId,mm(t.fe,e.overlayMutation))}function p0(t,e){const n=e.path.lastSegment();return[t,vn(e.path.popLast()),n]}function m0(t,e,n,i){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Bs(i.readTime),documentKey:vn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{getBundleMetadata(e,n){return g0(e).get(n).next(i=>{if(i)return{id:(r=i).bundleId,createTime:$s(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return g0(e).put({bundleId:(i=n).id,createTime:Bs(wt(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return v0(e).get(n).next(i=>{if(i)return{name:(r=i).name,query:Av(r.bundledQuery),readTime:$s(r.readTime)};var r})}saveNamedQuery(e,n){return v0(e).put(function(i){return{name:i.name,readTime:Bs(wt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function g0(t){return Ut(t,"bundles")}function v0(t){return Ut(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,n){this.serializer=e,this.userId=n}static de(e,n){const i=n.uid||"";return new Dd(e,i)}getOverlay(e,n){return Pa(e).get(p0(this.userId,n)).next(i=>i?Pf(this.serializer,i):null)}getOverlays(e,n){const i=bi();return x.forEach(n,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,n,i){const r=[];return i.forEach((s,o)=>{const a=new Sv(n,o);r.push(this.we(e,a))}),x.waitFor(r)}removeOverlaysForBatchId(e,n,i){const r=new Set;n.forEach(o=>r.add(vn(o.getCollectionPath())));const s=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Pa(e).J("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,n,i){const r=bi(),s=vn(n),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Pa(e).j("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Pf(this.serializer,l);r.set(c.getKey(),c)}return r})}getOverlaysForCollectionGroup(e,n,i,r){const s=bi();let o;const a=IDBKeyRange.bound([this.userId,n,i],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Pa(e).X({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{const h=Pf(this.serializer,c);s.size()<r||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}we(e,n){return Pa(e).put(function(i,r,s){const[o,a,l]=p0(r,s.mutation.key);return{userId:r,collectionPath:a,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Gl(i.fe,s.mutation)}}(this.serializer,this.userId,n))}}function Pa(t){return Ut(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(){}_e(e,n){this.me(e,n),n.ge()}me(e,n){if("nullValue"in e)this.ye(n,5);else if("booleanValue"in e)this.ye(n,10),n.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(n,15),n.pe(dt(e.integerValue));else if("doubleValue"in e){const i=dt(e.doubleValue);isNaN(i)?this.ye(n,13):(this.ye(n,15),Vl(i)?n.pe(0):n.pe(i))}else if("timestampValue"in e){const i=e.timestampValue;this.ye(n,20),typeof i=="string"?n.Ie(i):(n.Ie(`${i.seconds||""}`),n.pe(i.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,n),this.Ee(n);else if("bytesValue"in e)this.ye(n,30),n.Ae(Rr(e.bytesValue)),this.Ee(n);else if("referenceValue"in e)this.ve(e.referenceValue,n);else if("geoPointValue"in e){const i=e.geoPointValue;this.ye(n,45),n.pe(i.latitude||0),n.pe(i.longitude||0)}else"mapValue"in e?QC(e)?this.ye(n,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,n),this.Ee(n)):"arrayValue"in e?(this.Pe(e.arrayValue,n),this.Ee(n)):oe()}Te(e,n){this.ye(n,25),this.be(e,n)}be(e,n){n.Ie(e)}Re(e,n){const i=e.fields||{};this.ye(n,55);for(const r of Object.keys(i))this.Te(r,n),this.me(i[r],n)}Pe(e,n){const i=e.values||[];this.ye(n,50);for(const r of i)this.me(r,n)}ve(e,n){this.ye(n,37),Z.fromName(e).path.forEach(i=>{this.ye(n,60),this.be(i,n)})}ye(e,n){e.pe(n)}Ee(e){e.pe(2)}}os.Ve=new os;function pU(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function y0(t){const e=64-function(n){let i=0;for(let r=0;r<8;++r){const s=pU(255&n[r]);if(i+=s,s!==8)break}return i}(t);return Math.ceil(e/8)}class mU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const n=e[Symbol.iterator]();let i=n.next();for(;!i.done;)this.De(i.value),i=n.next();this.Ce()}xe(e){const n=e[Symbol.iterator]();let i=n.next();for(;!i.done;)this.Ne(i.value),i=n.next();this.ke()}Me(e){for(const n of e){const i=n.charCodeAt(0);if(i<128)this.De(i);else if(i<2048)this.De(960|i>>>6),this.De(128|63&i);else if(n<"\uD800"||"\uDBFF"<n)this.De(480|i>>>12),this.De(128|63&i>>>6),this.De(128|63&i);else{const r=n.codePointAt(0);this.De(240|r>>>18),this.De(128|63&r>>>12),this.De(128|63&r>>>6),this.De(128|63&r)}}this.Ce()}$e(e){for(const n of e){const i=n.charCodeAt(0);if(i<128)this.Ne(i);else if(i<2048)this.Ne(960|i>>>6),this.Ne(128|63&i);else if(n<"\uD800"||"\uDBFF"<n)this.Ne(480|i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i);else{const r=n.codePointAt(0);this.Ne(240|r>>>18),this.Ne(128|63&r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r)}}this.ke()}Oe(e){const n=this.Fe(e),i=y0(n);this.Be(1+i),this.buffer[this.position++]=255&i;for(let r=n.length-i;r<n.length;++r)this.buffer[this.position++]=255&n[r]}Le(e){const n=this.Fe(e),i=y0(n);this.Be(1+i),this.buffer[this.position++]=~(255&i);for(let r=n.length-i;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const n=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),i=(128&n[0])!=0;n[0]^=i?255:128;for(let r=1;r<n.length;++r)n[r]^=i?255:0;return n}De(e){const n=255&e;n===0?(this.Ue(0),this.Ue(255)):n===255?(this.Ue(255),this.Ue(0)):this.Ue(n)}Ne(e){const n=255&e;n===0?(this.Ge(0),this.Ge(255)):n===255?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const n=e+this.position;if(n<=this.buffer.length)return;let i=2*this.buffer.length;i<n&&(i=n);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class gU{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class vU{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Ma{constructor(){this.je=new mU,this.ze=new gU(this.je),this.We=new vU(this.je)}seed(e){this.je.seed(e)}He(e){return e===0?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n,i,r){this.indexId=e,this.documentKey=n,this.arrayValue=i,this.directionalValue=r}Je(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(n);return i.set(this.directionalValue,0),n!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new as(this.indexId,this.documentKey,this.arrayValue,i)}}function nr(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=_0(t.arrayValue,e.arrayValue),n!==0?n:(n=_0(t.directionalValue,e.directionalValue),n!==0?n:Z.comparator(t.documentKey,e.documentKey)))}function _0(t,e){for(let n=0;n<t.length&&n<e.length;++n){const i=t[n]-e[n];if(i!==0)return i}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const n of e.filters){const i=n;i.isInequality()?this.Ze=i:this.Xe.push(i)}}tn(e){he(e.collectionGroup===this.collectionId);const n=rm(e);if(n!==void 0&&!this.en(n))return!1;const i=Zr(e);let r=new Set,s=0,o=0;for(;s<i.length&&this.en(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Ze!==void 0){if(!r.has(this.Ze.field.canonicalString())){const a=i[s];if(!this.nn(this.Ze,a)||!this.sn(this.Ye[o++],a))return!1}++s}for(;s<i.length;++s){const a=i[s];if(o>=this.Ye.length||!this.sn(this.Ye[o++],a))return!1}return!0}en(e){for(const n of this.Xe)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===i}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(t){var e,n;if(he(t instanceof Re||t instanceof We),t instanceof Re){if(t instanceof ik){const r=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Re.create(t.field,"==",s)))||[];return We.create(r,"or")}return t}const i=t.filters.map(r=>Bk(r));return We.create(i,t.op)}function _U(t){if(t.getFilters().length===0)return[];const e=ym(Bk(t));return he($k(e)),gm(e)||vm(e)?[e]:e.getFilters()}function gm(t){return t instanceof Re}function vm(t){return t instanceof We&&yv(t)}function $k(t){return gm(t)||vm(t)||function(e){if(e instanceof We&&lm(e)){for(const n of e.getFilters())if(!gm(n)&&!vm(n))return!1;return!0}return!1}(t)}function ym(t){if(he(t instanceof Re||t instanceof We),t instanceof Re)return t;if(t.filters.length===1)return ym(t.filters[0]);const e=t.filters.map(i=>ym(i));let n=We.create(e,t.op);return n=Eh(n),$k(n)?n:(he(n instanceof We),he(Wo(n)),he(n.filters.length>1),n.filters.reduce((i,r)=>Rv(i,r)))}function Rv(t,e){let n;return he(t instanceof Re||t instanceof We),he(e instanceof Re||e instanceof We),n=t instanceof Re?e instanceof Re?function(i,r){return We.create([i,r],"and")}(t,e):w0(t,e):e instanceof Re?w0(e,t):function(i,r){if(he(i.filters.length>0&&r.filters.length>0),Wo(i)&&Wo(r))return ek(i,r.getFilters());const s=lm(i)?i:r,o=lm(i)?r:i,a=s.filters.map(l=>Rv(l,o));return We.create(a,"or")}(t,e),Eh(n)}function w0(t,e){if(Wo(e))return ek(e,t.getFilters());{const n=e.filters.map(i=>Rv(t,i));return We.create(n,"or")}}function Eh(t){if(he(t instanceof Re||t instanceof We),t instanceof Re)return t;const e=t.getFilters();if(e.length===1)return Eh(e[0]);if(JC(t))return t;const n=e.map(r=>Eh(r)),i=[];return n.forEach(r=>{r instanceof Re?i.push(r):r instanceof We&&(r.op===t.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:We.create(i,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(){this.rn=new Nv}addToCollectionParentIndex(e,n){return this.rn.add(n),x.resolve()}getCollectionParents(e,n){return x.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return x.resolve()}deleteFieldIndex(e,n){return x.resolve()}getDocumentsMatchingTarget(e,n){return x.resolve(null)}getIndexType(e,n){return x.resolve(0)}getFieldIndexes(e,n){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,n){return x.resolve(Ln.min())}getMinOffsetFromCollectionGroup(e,n){return x.resolve(Ln.min())}updateCollectionGroup(e,n,i){return x.resolve()}updateIndexEntries(e,n){return x.resolve()}}class Nv{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n]||new at(Le.comparator),s=!r.has(i);return this.index[n]=r.add(i),s}has(e){const n=e.lastSegment(),i=e.popLast(),r=this.index[n];return r&&r.has(i)}getEntries(e){return(this.index[e]||new at(Le.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ou=new Uint8Array(0);class bU{constructor(e,n){this.user=e,this.databaseId=n,this.on=new Nv,this.un=new zr(i=>Ms(i),(i,r)=>Tc(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.on.has(n)){const i=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.on.add(n)});const s={collectionId:i,parent:vn(r)};return b0(e).put(s)}return x.resolve()}getCollectionParents(e,n){const i=[],r=IDBKeyRange.bound([n,""],[LC(n),""],!1,!0);return b0(e).j(r).next(s=>{for(const o of s){if(o.collectionId!==n)break;i.push(wi(o.parent))}return i})}addFieldIndex(e,n){const i=au(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const s=i.add(r);if(n.indexState){const o=Fa(e);return s.next(a=>{o.put(m0(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const i=au(e),r=Fa(e),s=La(e);return i.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const i=La(e);let r=!0;const s=new Map;return x.forEach(this.cn(n),o=>this.an(e,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=Ie();const a=[];return x.forEach(s,(l,c)=>{var u;z("IndexedDbIndexManager",`Using index ${u=l,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(b=>`${b.fieldPath}:${b.kind}`).join(",")}`} to execute ${Ms(n)}`);const h=function(b,E){const P=rm(E);if(P===void 0)return null;for(const C of _h(b,P.fieldPath))switch(C.op){case"array-contains-any":return C.value.arrayValue.values||[];case"array-contains":return[C.value]}return null}(c,l),d=function(b,E){const P=new Map;for(const C of Zr(E))for(const B of _h(b,C.fieldPath))switch(B.op){case"==":case"in":P.set(C.fieldPath.canonicalString(),B.value);break;case"not-in":case"!=":return P.set(C.fieldPath.canonicalString(),B.value),Array.from(P.values())}return null}(c,l),f=function(b,E){const P=[];let C=!0;for(const B of Zr(E)){const N=B.kind===0?e0(b,B.fieldPath,b.startAt):t0(b,B.fieldPath,b.startAt);P.push(N.value),C&&(C=N.inclusive)}return new Or(P,C)}(c,l),p=function(b,E){const P=[];let C=!0;for(const B of Zr(E)){const N=B.kind===0?t0(b,B.fieldPath,b.endAt):e0(b,B.fieldPath,b.endAt);P.push(N.value),C&&(C=N.inclusive)}return new Or(P,C)}(c,l),m=this.hn(l,c,f),g=this.hn(l,c,p),w=this.ln(l,c,d),v=this.fn(l.indexId,h,m,f.inclusive,g,p.inclusive,w);return x.forEach(v,b=>i.H(b,n.limit).next(E=>{E.forEach(P=>{const C=Z.fromSegments(P.documentKey);o.has(C)||(o=o.add(C),a.push(C))})}))}).next(()=>a)}return x.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=_U(We.create(e.filters,"and")).map(i=>um(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}fn(e,n,i,r,s,o,a){const l=(n!=null?n.length:1)*Math.max(i.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const d=n?this.dn(n[h/c]):ou,f=this.wn(e,d,i[h%c],r),p=this._n(e,d,s[h%c],o),m=a.map(g=>this.wn(e,d,g,!0));u.push(...this.createRange(f,p,m))}return u}wn(e,n,i,r){const s=new as(e,Z.empty(),n,i);return r?s:s.Je()}_n(e,n,i,r){const s=new as(e,Z.empty(),n,i);return r?s.Je():s}an(e,n){const i=new yU(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(const a of s)i.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let i=2;const r=this.cn(n);return x.forEach(r,s=>this.an(e,s).next(o=>{o?i!==0&&o.fields.length<function(a){let l=new at(_t.comparator),c=!1;for(const u of a.filters)for(const h of u.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?c=!0:l=l.add(h.field));for(const u of a.orderBy)u.field.isKeyField()||(l=l.add(u.field));return l.size+(c?1:0)}(s)&&(i=1):i=0})).next(()=>function(s){return s.limit!==null}(n)&&r.length>1&&i===2?1:i)}mn(e,n){const i=new Ma;for(const r of Zr(e)){const s=n.data.field(r.fieldPath);if(s==null)return null;const o=i.He(r.kind);os.Ve._e(s,o)}return i.Qe()}dn(e){const n=new Ma;return os.Ve._e(e,n.He(0)),n.Qe()}gn(e,n){const i=new Ma;return os.Ve._e(Ps(this.databaseId,n),i.He(function(r){const s=Zr(r);return s.length===0?0:s[s.length-1].kind}(e))),i.Qe()}ln(e,n,i){if(i===null)return[];let r=[];r.push(new Ma);let s=0;for(const o of Zr(e)){const a=i[s++];for(const l of r)if(this.yn(n,o.fieldPath)&&Hl(a))r=this.pn(r,o,a);else{const c=l.He(o.kind);os.Ve._e(a,c)}}return this.In(r)}hn(e,n,i){return this.ln(e,n,i.position)}In(e){const n=[];for(let i=0;i<e.length;++i)n[i]=e[i].Qe();return n}pn(e,n,i){const r=[...e],s=[];for(const o of i.arrayValue.values||[])for(const a of r){const l=new Ma;l.seed(a.Qe()),os.Ve._e(o,l.He(n.kind)),s.push(l)}return s}yn(e,n){return!!e.filters.find(i=>i instanceof Re&&i.field.isEqual(n)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,n){const i=au(e),r=Fa(e);return(n?i.j("collectionGroupIndex",IDBKeyRange.bound(n,n)):i.j()).next(s=>{const o=[];return x.forEach(s,a=>r.get([a.indexId,this.uid]).next(l=>{o.push(function(c,u){const h=u?new vh(u.sequenceNumber,new Ln($s(u.readTime),new Z(wi(u.documentKey)),u.largestBatchId)):vh.empty(),d=c.fields.map(([f,p])=>new iq(_t.fromServerFormat(f),p));return new FC(c.indexId,c.collectionGroup,d,h)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((i,r)=>{const s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:be(i.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,i){const r=au(e),s=Fa(e);return this.Tn(e).next(o=>r.j("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>x.forEach(a,l=>s.put(m0(l.indexId,this.user,o,i)))))}updateIndexEntries(e,n){const i=new Map;return x.forEach(n,(r,s)=>{const o=i.get(r.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(i.set(r.collectionGroup,a),x.forEach(a,l=>this.En(e,r,l).next(c=>{const u=this.An(s,l);return c.isEqual(u)?x.resolve():this.vn(e,s,l,c,u)}))))})}Rn(e,n,i,r){return La(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(i,n.key),documentKey:n.key.path.toArray()})}Pn(e,n,i,r){return La(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(i,n.key),n.key.path.toArray()])}En(e,n,i){const r=La(e);let s=new at(nr);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.gn(i,n)])},(o,a)=>{s=s.add(new as(i.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}An(e,n){let i=new at(nr);const r=this.mn(n,e);if(r==null)return i;const s=rm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Hl(o))for(const a of o.arrayValue.values||[])i=i.add(new as(n.indexId,e.key,this.dn(a),r))}else i=i.add(new as(n.indexId,e.key,ou,r));return i}vn(e,n,i,r,s){z("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,l,c,u,h){const d=a.getIterator(),f=l.getIterator();let p=ao(d),m=ao(f);for(;p||m;){let g=!1,w=!1;if(p&&m){const v=c(p,m);v<0?w=!0:v>0&&(g=!0)}else p!=null?w=!0:g=!0;g?(u(m),m=ao(f)):w?(h(p),p=ao(d)):(p=ao(d),m=ao(f))}}(r,s,nr,a=>{o.push(this.Rn(e,n,i,a))},a=>{o.push(this.Pn(e,n,i,a))}),x.waitFor(o)}Tn(e){let n=1;return Fa(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,i){i=i.sort((o,a)=>nr(o,a)).filter((o,a,l)=>!a||nr(o,l[a-1])!==0);const r=[];r.push(e);for(const o of i){const a=nr(o,e),l=nr(o,n);if(a===0)r[0]=e.Je();else if(a>0&&l<0)r.push(o),r.push(o.Je());else if(l>0)break}r.push(n);const s=[];for(let o=0;o<r.length;o+=2){if(this.bn(r[o],r[o+1]))return[];const a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,ou,[]],l=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,ou,[]];s.push(IDBKeyRange.bound(a,l))}return s}bn(e,n){return nr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(E0)}getMinOffset(e,n){return x.mapArray(this.cn(n),i=>this.an(e,i).next(r=>r||oe())).next(E0)}}function b0(t){return Ut(t,"collectionParents")}function La(t){return Ut(t,"indexEntries")}function au(t){return Ut(t,"indexConfiguration")}function Fa(t){return Ut(t,"indexState")}function E0(t){he(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let i=1;i<t.length;i++){const r=t[i].indexState.offset;mv(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Ln(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class _n{constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new _n(e,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(t,e,n){const i=t.store("mutations"),r=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=i.X({range:o},(u,h,d)=>(a++,d.delete()));s.push(l.next(()=>{he(a===1)}));const c=[];for(const u of n.mutations){const h=zC(e,u.key.path,n.batchId);s.push(r.delete(h)),c.push(u.key)}return x.waitFor(s).next(()=>c)}function Ih(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw oe();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_n.DEFAULT_COLLECTION_PERCENTILE=10,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_n.DEFAULT=new _n(41943040,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_n.DISABLED=new _n(-1,0,0);class Od{constructor(e,n,i,r){this.userId=e,this.serializer=n,this.indexManager=i,this.referenceDelegate=r,this.Vn={}}static de(e,n,i,r){he(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Od(s,n,i,r)}checkEmpty(e){let n=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ir(e).X({index:"userMutationsIndex",range:i},(r,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,i,r){const s=go(e),o=ir(e);return o.add({}).next(a=>{he(typeof a=="number");const l=new Iv(a,n,i,r),c=function(d,f,p){const m=p.baseMutations.map(w=>Gl(d.fe,w)),g=p.mutations.map(w=>Gl(d.fe,w));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:m,mutations:g}}(this.serializer,this.userId,l),u=[];let h=new at((d,f)=>be(d.canonicalString(),f.canonicalString()));for(const d of r){const f=zC(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(c)),u.push(s.put(f,cq))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Vn[a]=l.keys()}),x.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return ir(e).get(n).next(i=>i?(he(i.userId===this.userId),ss(this.serializer,i)):null)}Sn(e,n){return this.Vn[n]?x.resolve(this.Vn[n]):this.lookupMutationBatch(e,n).next(i=>{if(i){const r=i.keys();return this.Vn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const i=n+1,r=IDBKeyRange.lowerBound([this.userId,i]);let s=null;return ir(e).X({index:"userMutationsIndex",range:r},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=i),s=ss(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return ir(e).X({index:"userMutationsIndex",range:n,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ir(e).j("userMutationsIndex",n).next(i=>i.map(r=>ss(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const i=Au(this.userId,n.path),r=IDBKeyRange.lowerBound(i),s=[];return go(e).X({range:r},(o,a,l)=>{const[c,u,h]=o,d=wi(u);if(c===this.userId&&n.path.isEqual(d))return ir(e).get(h).next(f=>{if(!f)throw oe();he(f.userId===this.userId),s.push(ss(this.serializer,f))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new at(be);const r=[];return n.forEach(s=>{const o=Au(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=go(e).X({range:a},(c,u,h)=>{const[d,f,p]=c,m=wi(f);d===this.userId&&s.path.isEqual(m)?i=i.add(p):h.done()});r.push(l)}),x.waitFor(r).next(()=>this.Dn(e,i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,r=i.length+1,s=Au(this.userId,i),o=IDBKeyRange.lowerBound(s);let a=new at(be);return go(e).X({range:o},(l,c,u)=>{const[h,d,f]=l,p=wi(d);h===this.userId&&i.isPrefixOf(p)?p.length===r&&(a=a.add(f)):u.done()}).next(()=>this.Dn(e,a))}Dn(e,n){const i=[],r=[];return n.forEach(s=>{r.push(ir(e).get(s).next(o=>{if(o===null)throw oe();he(o.userId===this.userId),i.push(ss(this.serializer,o))}))}),x.waitFor(r).next(()=>i)}removeMutationBatch(e,n){return qk(e.ht,this.userId,n).next(i=>(e.addOnCommittedListener(()=>{this.Cn(n.batchId)}),x.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return x.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return go(e).X({range:i},(s,o,a)=>{if(s[0]===this.userId){const l=wi(s[1]);r.push(l)}else a.done()}).next(()=>{he(r.length===0)})})}containsKey(e,n){return Uk(e,this.userId,n)}xn(e){return Vk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Uk(t,e,n){const i=Au(e,n.path),r=i[1],s=IDBKeyRange.lowerBound(i);let o=!1;return go(t).X({range:s,Y:!0},(a,l,c)=>{const[u,h,d]=a;u===e&&h===r&&(o=!0),c.done()}).next(()=>o)}function ir(t){return Ut(t,"mutations")}function go(t){return Ut(t,"documentMutations")}function Vk(t){return Ut(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new qs(0)}static Mn(){return new qs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.$n(e).next(n=>{const i=new qs(n.highestTargetId);return n.highestTargetId=i.next(),this.On(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(n=>ue.fromTimestamp(new ot(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,i){return this.$n(e).next(r=>(r.highestListenSequenceNumber=n,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.On(e,r)))}addTargetData(e,n){return this.Fn(e,n).next(()=>this.$n(e).next(i=>(i.targetCount+=1,this.Bn(n,i),this.On(e,i))))}updateTargetData(e,n){return this.Fn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>lo(e).delete(n.targetId)).next(()=>this.$n(e)).next(i=>(he(i.targetCount>0),i.targetCount-=1,this.On(e,i)))}removeTargets(e,n,i){let r=0;const s=[];return lo(e).X((o,a)=>{const l=Xa(a);l.sequenceNumber<=n&&i.get(l.targetId)===null&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>x.waitFor(s)).next(()=>r)}forEachTarget(e,n){return lo(e).X((i,r)=>{const s=Xa(r);n(s)})}$n(e){return T0(e).get("targetGlobalKey").next(n=>(he(n!==null),n))}On(e,n){return T0(e).put("targetGlobalKey",n)}Fn(e,n){return lo(e).put(Fk(this.serializer,n))}Bn(e,n){let i=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,i=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.$n(e).next(n=>n.targetCount)}getTargetData(e,n){const i=Ms(n),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let s=null;return lo(e).X({range:r,index:"queryTargetsIndex"},(o,a,l)=>{const c=Xa(a);Tc(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,i){const r=[],s=dr(e);return n.forEach(o=>{const a=vn(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(e,i,o))}),x.waitFor(r)}removeMatchingKeys(e,n,i){const r=dr(e);return x.forEach(n,s=>{const o=vn(s.path);return x.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,n){const i=dr(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,n){const i=IDBKeyRange.bound([n],[n+1],!1,!0),r=dr(e);let s=Ie();return r.X({range:i,Y:!0},(o,a,l)=>{const c=wi(o[1]),u=new Z(c);s=s.add(u)}).next(()=>s)}containsKey(e,n){const i=vn(n.path),r=IDBKeyRange.bound([i],[LC(i)],!1,!0);let s=0;return dr(e).X({index:"documentTargetsIndex",Y:!0,range:r},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}le(e,n){return lo(e).get(n).next(i=>i?Xa(i):null)}}function lo(t){return Ut(t,"targets")}function T0(t){return Ut(t,"targetGlobal")}function dr(t){return Ut(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0([t,e],[n,i]){const r=be(t,n);return r===0?be(e,i):r}class IU{constructor(e){this.Ln=e,this.buffer=new at(S0),this.qn=0}Un(){return++this.qn}Kn(e){const n=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();S0(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class TU{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}Qn(e){z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Vr(n)?z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Ur(n)}await this.Qn(3e5)})}}class SU{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.zn(e).next(i=>Math.floor(n/100*i))}nthSequenceNumber(e,n){if(n===0)return x.resolve(bn.ct);const i=new IU(n);return this.jn.forEachTarget(e,r=>i.Kn(r.sequenceNumber)).next(()=>this.jn.Wn(e,r=>i.Kn(r))).next(()=>i.maxValue)}removeTargets(e,n,i){return this.jn.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(I0)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),I0):this.Hn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,n){let i,r,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(i=h,a=Date.now(),this.removeTargets(e,i,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(h=>(c=Date.now(),im()<=Ne.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:h})))}}function CU(t,e){return new SU(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e,n){this.db=e,this.garbageCollector=CU(this,n)}zn(e){const n=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(i=>n.next(r=>i+r))}Jn(e){let n=0;return this.Wn(e,i=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Wn(e,n){return this.Yn(e,(i,r)=>n(r))}addReference(e,n,i){return lu(e,i)}removeReference(e,n,i){return lu(e,i)}removeTargets(e,n,i){return this.db.getTargetCache().removeTargets(e,n,i)}markPotentiallyOrphaned(e,n){return lu(e,n)}Xn(e,n){return function(i,r){let s=!1;return Vk(i).Z(o=>Uk(i,o,r).next(a=>(a&&(s=!0),x.resolve(!a)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Yn(e,(o,a)=>{if(a<=n){const l=this.Xn(e,o).next(c=>{if(!c)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,ue.min()),dr(e).delete([0,vn(o.path)])))});r.push(l)}}).next(()=>x.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,n){return lu(e,n)}Yn(e,n){const i=dr(e);let r,s=bn.ct;return i.X({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==bn.ct&&n(new Z(wi(r)),s),s=c,r=l):s=bn.ct}).next(()=>{s!==bn.ct&&n(new Z(wi(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lu(t,e){return dr(t).put(function(n,i){return{targetId:0,path:vn(n.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.changes=new zr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,st.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?x.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,i){return Qr(e).put(i)}removeEntry(e,n,i){return Qr(e).delete(function(r,s){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],bh(s),o[o.length-1]]}(n,i))}updateMetadata(e,n){return this.getMetadata(e).next(i=>(i.byteSize+=n,this.Zn(e,i)))}getEntry(e,n){let i=st.newInvalidDocument(n);return Qr(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ba(n))},(r,s)=>{i=this.ts(n,s)}).next(()=>i)}es(e,n){let i={size:0,document:st.newInvalidDocument(n)};return Qr(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ba(n))},(r,s)=>{i={document:this.ts(n,s),size:Ih(s)}}).next(()=>i)}getEntries(e,n){let i=In();return this.ns(e,n,(r,s)=>{const o=this.ts(r,s);i=i.insert(r,o)}).next(()=>i)}ss(e,n){let i=In(),r=new et(Z.comparator);return this.ns(e,n,(s,o)=>{const a=this.ts(s,o);i=i.insert(s,a),r=r.insert(s,Ih(o))}).next(()=>({documents:i,rs:r}))}ns(e,n,i){if(n.isEmpty())return x.resolve();let r=new at(x0);n.forEach(l=>r=r.add(l));const s=IDBKeyRange.bound(Ba(r.first()),Ba(r.last())),o=r.getIterator();let a=o.getNext();return Qr(e).X({index:"documentKeyIndex",range:s},(l,c,u)=>{const h=Z.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&x0(a,h)<0;)i(a,null),a=o.getNext();a&&a.isEqual(h)&&(i(a,c),a=o.hasNext()?o.getNext():null),a?u.G(Ba(a)):u.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,i,r){const s=n.path,o=[s.popLast().toArray(),s.lastSegment(),bh(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qr(e).j(IDBKeyRange.bound(o,a,!0)).next(l=>{let c=In();for(const u of l){const h=this.ts(Z.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);h.isFoundDocument()&&(Cc(n,h)||r.has(h.key))&&(c=c.insert(h.key,h))}return c})}getAllFromCollectionGroup(e,n,i,r){let s=In();const o=k0(n,i),a=k0(n,Ln.max());return Qr(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.ts(Z.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===r&&u.done()}).next(()=>s)}newChangeBuffer(e){return new AU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return C0(e).get("remoteDocumentGlobalKey").next(n=>(he(!!n),n))}Zn(e,n){return C0(e).put("remoteDocumentGlobalKey",n)}ts(e,n){if(n){const i=dU(this.serializer,n);if(!(i.isNoDocument()&&i.version.isEqual(ue.min())))return i}return st.newInvalidDocument(e)}}function jk(t){return new xU(t)}class AU extends zk{constructor(e,n){super(),this.os=e,this.trackRemovals=n,this.us=new zr(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){const n=[];let i=0,r=new at((s,o)=>be(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.us.get(s);if(n.push(this.os.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=f0(this.os.serializer,o);r=r.add(s.path.popLast());const c=Ih(l);i+=c-a.size,n.push(this.os.addEntry(e,s,l))}else if(i-=a.size,this.trackRemovals){const l=f0(this.os.serializer,o.convertToNoDocument(ue.min()));n.push(this.os.addEntry(e,s,l))}}),r.forEach(s=>{n.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.os.updateMetadata(e,i)),x.waitFor(n)}getFromCache(e,n){return this.os.es(e,n).next(i=>(this.us.set(n,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,n){return this.os.ss(e,n).next(({documents:i,rs:r})=>(r.forEach((s,o)=>{this.us.set(s,{size:o,readTime:i.get(s).readTime})}),i))}}function C0(t){return Ut(t,"remoteDocumentGlobal")}function Qr(t){return Ut(t,"remoteDocumentsV14")}function Ba(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function k0(t,e){const n=e.documentKey.path.toArray();return[t,bh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function x0(t,e){const n=t.path.toArray(),i=e.path.toArray();let r=0;for(let s=0;s<n.length-2&&s<i.length-2;++s)if(r=be(n[s],i[s]),r)return r;return r=be(n.length,i.length),r||(r=be(n[n.length-2],i[i.length-2]),r||be(n[n.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,n,i,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(i!==null&&dl(i.mutation,r,En.empty(),ot.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.getLocalViewOfDocuments(e,i,Ie()).next(()=>i))}getLocalViewOfDocuments(e,n,i=Ie()){const r=bi();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,i).next(s=>{let o=Qa();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const i=bi();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,Ie()))}populateOverlays(e,n,i){const r=[];return i.forEach(s=>{n.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,i,r){let s=In();const o=hl(),a=hl();return n.forEach((l,c)=>{const u=i.get(c.key);r.has(c.key)&&(u===void 0||u.mutation instanceof Yi)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),dl(u.mutation,c,u.mutation.getFieldMask(),ot.now())):o.set(c.key,En.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var h;return a.set(c,new RU(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const i=hl();let r=new et((o,a)=>o-a),s=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=i.get(l)||En.empty();u=a.applyToLocalView(c,u),i.set(l,u);const h=(r.get(a.batchId)||Ie()).add(l);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=uk();u.forEach(d=>{if(!s.has(d)){const f=yk(n.get(d),i.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return x.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,n,i){return function(r){return Z.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i):this.getDocumentsMatchingCollectionQuery(e,n,i)}getNextDocuments(e,n,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,r-s.size):x.resolve(bi());let a=-1,l=s;return o.next(c=>x.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?x.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Ie())).next(u=>({batchId:a,changes:ck(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Z(n)).next(i=>{let r=Qa();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,i){const r=n.collectionGroup;let s=Qa();return this.indexManager.getCollectionParents(e,r).next(o=>x.forEach(o,a=>{const l=function(c,u){return new Qi(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,l,i).next(c=>{c.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next(s=>(r=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,r))).next(s=>{r.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,st.newInvalidDocument(c)))});let o=Qa();return s.forEach((a,l)=>{const c=r.get(a);c!==void 0&&dl(c.mutation,l,En.empty(),ot.now()),Cc(n,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return x.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var i;return this.cs.set(n.id,{id:(i=n).id,version:i.version,createTime:wt(i.createTime)}),x.resolve()}getNamedQuery(e,n){return x.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(i){return{name:i.name,query:Av(i.bundledQuery),readTime:wt(i.readTime)}}(n)),x.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(){this.overlays=new et(Z.comparator),this.ls=new Map}getOverlay(e,n){return x.resolve(this.overlays.get(n))}getOverlays(e,n){const i=bi();return x.forEach(n,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,n,i){return i.forEach((r,s)=>{this.we(e,n,s)}),x.resolve()}removeOverlaysForBatchId(e,n,i){const r=this.ls.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(i)),x.resolve()}getOverlaysForCollection(e,n,i){const r=bi(),s=n.length+1,o=new Z(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return x.resolve(r)}getOverlaysForCollectionGroup(e,n,i,r){let s=new et((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>i){let u=s.get(c.largestBatchId);u===null&&(u=bi(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=bi(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=r)););return x.resolve(a)}we(e,n,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.ls.get(r.largestBatchId).delete(i.key);this.ls.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Sv(n,i));let s=this.ls.get(n);s===void 0&&(s=Ie(),this.ls.set(n,s)),this.ls.set(n,s.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(){this.fs=new at(Nt.ds),this.ws=new at(Nt._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const i=new Nt(e,n);this.fs=this.fs.add(i),this.ws=this.ws.add(i)}gs(e,n){e.forEach(i=>this.addReference(i,n))}removeReference(e,n){this.ys(new Nt(e,n))}ps(e,n){e.forEach(i=>this.removeReference(i,n))}Is(e){const n=new Z(new Le([])),i=new Nt(n,e),r=new Nt(n,e+1),s=[];return this.ws.forEachInRange([i,r],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new Z(new Le([])),i=new Nt(n,e),r=new Nt(n,e+1);let s=Ie();return this.ws.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Nt(e,0),i=this.fs.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class Nt{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return Z.comparator(e.key,n.key)||be(e.As,n.As)}static _s(e,n){return be(e.As,n.As)||Z.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new at(Nt.ds)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,r){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Iv(s,n,i,r);this.mutationQueue.push(o);for(const a of r)this.Rs=this.Rs.add(new Nt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,n){return x.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,r=this.bs(i),s=r<0?0:r;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new Nt(n,0),r=new Nt(n,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([i,r],o=>{const a=this.Ps(o.As);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new at(be);return n.forEach(r=>{const s=new Nt(r,0),o=new Nt(r,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{i=i.add(a.As)})}),x.resolve(this.Vs(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,r=i.length+1;let s=i;Z.isDocumentKey(s)||(s=s.child(""));const o=new Nt(new Z(s),0);let a=new at(be);return this.Rs.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.As)),!0)},o),x.resolve(this.Vs(a))}Vs(e){const n=[];return e.forEach(i=>{const r=this.Ps(i);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){he(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let i=this.Rs;return x.forEach(n.mutations,r=>{const s=new Nt(r.key,n.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=i})}Cn(e){}containsKey(e,n){const i=new Nt(n,0),r=this.Rs.firstAfterOrEqual(i);return x.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e){this.Ds=e,this.docs=new et(Z.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,r=this.docs.get(i),s=r?r.size:0,o=this.Ds(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return x.resolve(i?i.document.mutableCopy():st.newInvalidDocument(n))}getEntries(e,n){let i=In();return n.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():st.newInvalidDocument(r))}),x.resolve(i)}getDocumentsMatchingQuery(e,n,i,r){let s=In();const o=n.path,a=new Z(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||mv($C(u),i)<=0||(r.has(u.key)||Cc(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,n,i,r){oe()}Cs(e,n){return x.forEach(this.docs,i=>n(i))}newChangeBuffer(e){return new MU(this)}getSize(e){return x.resolve(this.size)}}class MU extends zk{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?n.push(this.os.addEntry(e,r)):this.os.removeEntry(i)}),x.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e){this.persistence=e,this.xs=new zr(n=>Ms(n),Tc),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Dv,this.targetCount=0,this.Ms=qs.kn()}forEachTarget(e,n){return this.xs.forEach((i,r)=>n(r)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.Ns&&(this.Ns=n),x.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new qs(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,x.resolve()}updateTargetData(e,n){return this.Fn(n),x.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,n,i){let r=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=n&&i.get(a.targetId)===null&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),x.waitFor(s).next(()=>r)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,n){const i=this.xs.get(n)||null;return x.resolve(i)}addMatchingKeys(e,n,i){return this.ks.gs(n,i),x.resolve()}removeMatchingKeys(e,n,i){this.ks.ps(n,i);const r=this.persistence.referenceDelegate,s=[];return r&&n.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),x.resolve()}getMatchingKeysForTargetId(e,n){const i=this.ks.Es(n);return x.resolve(i)}containsKey(e,n){return x.resolve(this.ks.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n){this.$s={},this.overlays={},this.Os=new bn(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new LU(this),this.indexManager=new wU,this.remoteDocumentCache=function(i){return new PU(i)}(i=>this.referenceDelegate.Ls(i)),this.serializer=new Lk(n),this.qs=new NU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new DU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.$s[e.toKey()];return i||(i=new OU(n,this.referenceDelegate),this.$s[e.toKey()]=i),i}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,i){z("MemoryPersistence","Starting transaction:",e);const r=new FU(this.Os.next());return this.referenceDelegate.Us(),i(r).next(s=>this.referenceDelegate.Ks(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Gs(e,n){return x.or(Object.values(this.$s).map(i=>()=>i.containsKey(e,n)))}}class FU extends UC{constructor(e){super(),this.currentSequenceNumber=e}}class Pd{constructor(e){this.persistence=e,this.Qs=new Dv,this.js=null}static zs(e){return new Pd(e)}get Ws(){if(this.js)return this.js;throw oe()}addReference(e,n,i){return this.Qs.addReference(i,n),this.Ws.delete(i.toString()),x.resolve()}removeReference(e,n,i){return this.Qs.removeReference(i,n),this.Ws.add(i.toString()),x.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),x.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(r=>this.Ws.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(s=>this.Ws.add(s.toString()))}).next(()=>i.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Ws,i=>{const r=Z.fromPath(i);return this.Hs(e,r).next(s=>{s||n.removeEntry(r,ue.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(i=>{i?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return x.or([()=>x.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.serializer=e}O(e,n,i,r){const s=new kd("createOrUpgrade",n);i<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jw,{unique:!0}),a.createObjectStore("documentMutations")}(e),A0(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return i<3&&r>=3&&(i!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),A0(e)),o=o.next(()=>function(a){const l=a.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ue.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",c)}(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>function(a,l){return l.store("mutations").j().next(c=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jw,{unique:!0});const u=l.store("mutations"),h=c.map(d=>u.put(d));return x.waitFor(h)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),i<5&&r>=5&&(o=o.next(()=>this.Ys(s))),i<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),i<7&&r>=7&&(o=o.next(()=>this.Zs(s))),i<8&&r>=8&&(o=o.next(()=>this.ti(e,s))),i<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&r>=10&&(o=o.next(()=>this.ei(s))),i<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{(function(a){const l=a.createObjectStore("documentOverlays",{keyPath:bq});l.createIndex("collectionPathOverlayIndex",Eq,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",Iq,{unique:!1})})(e)})),i<13&&r>=13&&(o=o.next(()=>function(a){const l=a.createObjectStore("remoteDocumentsV14",{keyPath:uq});l.createIndex("documentKeyIndex",hq),l.createIndex("collectionGroupIndex",dq)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.si(e,s))),i<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:vq}).createIndex("sequenceNumberIndex",yq,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:_q}).createIndex("documentKeyIndex",wq,{unique:!1})}(e))),o}Xs(e){let n=0;return e.store("remoteDocuments").X((i,r)=>{n+=Ih(r)}).next(()=>{const i={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Ys(e){const n=e.store("mutationQueues"),i=e.store("mutations");return n.j().next(r=>x.forEach(r,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.j("userMutationsIndex",o).next(a=>x.forEach(a,l=>{he(l.userId===s.userId);const c=ss(this.serializer,l);return qk(e,s.userId,c).next(()=>{})}))}))}Zs(e){const n=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return i.X((o,a)=>{const l=new Le(o),c=function(u){return[0,vn(u)]}(l);s.push(n.get(c).next(u=>u?x.resolve():(h=>n.put({targetId:0,path:vn(h),sequenceNumber:r.highestListenSequenceNumber}))(l)))}).next(()=>x.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:gq});const i=n.store("collectionParents"),r=new Nv,s=o=>{if(r.add(o)){const a=o.lastSegment(),l=o.popLast();return i.put({collectionId:a,parent:vn(l)})}};return n.store("remoteDocuments").X({Y:!0},(o,a)=>{const l=new Le(o);return s(l.popLast())}).next(()=>n.store("documentMutations").X({Y:!0},([o,a,l],c)=>{const u=wi(a);return s(u.popLast())}))}ei(e){const n=e.store("targets");return n.X((i,r)=>{const s=Xa(r),o=Fk(this.serializer,s);return n.put(o)})}ni(e,n){const i=n.store("remoteDocuments"),r=[];return i.X((s,o)=>{const a=n.store("remoteDocumentsV14"),l=(c=o,c.document?new Z(Le.fromString(c.document.name).popFirst(5)):c.noDocument?Z.fromSegments(c.noDocument.path):c.unknownDocument?Z.fromSegments(c.unknownDocument.path):oe()).path.toArray();var c;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>x.waitFor(r))}si(e,n){const i=n.store("mutations"),r=jk(this.serializer),s=new Kk(Pd.zs,this.serializer.fe);return i.j().next(o=>{const a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:Ie();ss(this.serializer,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),x.forEach(a,(l,c)=>{const u=new Ot(c),h=Dd.de(this.serializer,u),d=s.getIndexManager(u),f=Od.de(u,this.serializer,d,s.referenceDelegate);return new Hk(r,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new sm(n,bn.ct),l).next()})})}}function A0(t){t.createObjectStore("targetDocuments",{keyPath:pq}).createIndex("documentTargetsIndex",mq,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",fq,{unique:!0}),t.createObjectStore("targetGlobal")}const Mf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ov{constructor(e,n,i,r,s,o,a,l,c,u,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=i,this.ii=s,this.window=o,this.document=a,this.ri=c,this.oi=u,this.ui=h,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=d=>Promise.resolve(),!Ov.D())throw new U(D.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kU(this,r),this.di=n+"main",this.serializer=new Lk(l),this.wi=new ti(this.di,this.ui,new BU(this.serializer)),this.Bs=new EU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=jk(this.serializer),this.qs=new fU,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,u===!1&&yt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new U(D.FAILED_PRECONDITION,Mf);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new bn(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>cu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(n=>{n||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(n=>this.isPrimary&&!n?this.Ai(e).next(()=>!1):!!n&&this.vi(e).next(()=>!0))).catch(e=>{if(Vr(e))return z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return $a(e).get("owner").next(n=>x.resolve(this.Ri(n)))}Pi(e){return cu(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const i=Ut(n,"clientMetadata");return i.j().next(r=>{const s=this.Si(r,18e5),o=r.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this._i)for(const n of e)this._i.removeItem(this.Di(n.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?x.resolve(!0):$a(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)){if(this.Ri(n)&&this.networkEnabled)return!0;if(!this.Ri(n)){if(!n.allowTabSynchronization)throw new U(D.FAILED_PRECONDITION,Mf);return!1}}return!(!this.networkEnabled||!this.inForeground)||cu(e).j().next(i=>this.Si(i,5e3).find(r=>{if(this.clientId!==r.clientId){const s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&z("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new sm(e,bn.ct);return this.Ai(n).next(()=>this.Pi(n))}),this.wi.close(),this.Mi()}Si(e,n){return e.filter(i=>this.Vi(i.updateTimeMs,n)&&!this.Ci(i.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>cu(e).j().next(n=>this.Si(n,18e5).map(i=>i.clientId)))}get started(){return this.Fs}getMutationQueue(e,n){return Od.de(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bU(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Dd.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,n,i){z("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",s=(o=this.ui)===15?Sq:o===14?KC:o===13?HC:o===12?Tq:o===11?jC:void oe();var o;let a;return this.wi.runTransaction(e,r,s,l=>(a=new sm(l,this.Os?this.Os.next():bn.ct),n==="readwrite-primary"?this.Ti(a).next(c=>!!c||this.Ei(a)).next(c=>{if(!c)throw yt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new U(D.FAILED_PRECONDITION,qC);return i(a)}).next(c=>this.vi(a).next(()=>c)):this.Oi(a).next(()=>i(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Oi(e){return $a(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)&&!this.Ri(n)&&!(this.oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new U(D.FAILED_PRECONDITION,Mf)})}vi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return $a(e).put("owner",n)}static D(){return ti.D()}Ai(e){const n=$a(e);return n.get("owner").next(i=>this.Ri(i)?(z("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):x.resolve())}Vi(e,n){const i=Date.now();return!(e<i-n)&&(!(e>i)||(yt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground=this.document.visibilityState==="visible")}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const n=/(?:Version|Mobile)\/1[456]/;ZN()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var n;try{const i=((n=this._i)===null||n===void 0?void 0:n.getItem(this.Di(e)))!==null;return z("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return yt("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){yt("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function $a(t){return Ut(t,"owner")}function cu(t){return Ut(t,"clientMetadata")}function Pv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,i,r){this.targetId=e,this.fromCache=n,this.Fi=i,this.Bi=r}static Li(e,n){let i=Ie(),r=Ie();for(const s of n.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Mv(e,n.fromCache,i,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,i,r){return this.Ki(e,n).next(s=>s||this.Gi(e,n,r,i)).next(s=>s||this.Qi(e,n))}Ki(e,n){if(n0(n))return x.resolve(null);let i=Sn(n);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=wh(n,null,"F"),i=Sn(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=Ie(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const c=this.ji(n,a);return this.zi(n,c,o,l.readTime)?this.Ki(e,wh(n,null,"F")):this.Wi(e,c,n,l)}))})))}Gi(e,n,i,r){return n0(n)||r.isEqual(ue.min())?this.Qi(e,n):this.Ui.getDocuments(e,i).next(s=>{const o=this.ji(n,s);return this.zi(n,o,i,r)?this.Qi(e,n):(im()<=Ne.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),dm(n)),this.Wi(e,o,n,BC(r,-1)))})}ji(e,n){let i=new at(ak(e));return n.forEach((r,s)=>{Cc(e,s)&&(i=i.add(s))}),i}zi(e,n,i,r){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Qi(e,n){return im()<=Ne.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",dm(n)),this.Ui.getDocumentsMatchingQuery(e,n,Ln.min())}Wi(e,n,i,r){return this.Ui.getDocumentsMatchingQuery(e,i,r).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e,n,i,r){this.persistence=e,this.Hi=n,this.serializer=r,this.Ji=new et(be),this.Yi=new zr(s=>Ms(s),Tc),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(i)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hk(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function Gk(t,e,n,i){return new $U(t,e,n,i)}async function Qk(t,e){const n=te(t);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let r;return n.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,n.tr(e),n.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=Ie();for(const c of r){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(i,l).next(c=>({er:c,removedBatchIds:o,addedBatchIds:a}))})})}function qU(t,e){const n=te(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=n.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,h=u.keys();let d=x.resolve();return h.forEach(f=>{d=d.next(()=>c.getEntry(a,f)).next(p=>{const m=l.docVersions.get(f);he(m!==null),p.version.compareTo(m)<0&&(u.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),c.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,i,e,s).next(()=>s.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let a=Ie();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(i,r))})}function Yk(t){const e=te(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function UU(t,e){const n=te(t),i=e.snapshotVersion;let r=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Zi.newChangeBuffer({trackRemovals:!0});r=n.Ji;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(n.Bs.removeMatchingKeys(s,u.removedDocuments,h).next(()=>n.Bs.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(xt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,i)),r=r.insert(h,f),function(p,m,g){return p.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:g.addedDocuments.size+g.modifiedDocuments.size+g.removedDocuments.size>0}(d,f,u)&&a.push(n.Bs.updateTargetData(s,f))});let l=In(),c=Ie();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(Xk(s,o,e.documentUpdates).next(u=>{l=u.nr,c=u.sr})),!i.isEqual(ue.min())){const u=n.Bs.getLastRemoteSnapshotVersion(s).next(h=>n.Bs.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(u)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Ji=r,s))}function Xk(t,e,n){let i=Ie(),r=Ie();return n.forEach(s=>i=i.add(s)),e.getEntries(t,i).next(s=>{let o=In();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ue.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{nr:o,sr:r}})}function VU(t,e){const n=te(t);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Xo(t,e){const n=te(t);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return n.Bs.getTargetData(i,e).next(s=>s?(r=s,x.resolve(r)):n.Bs.allocateTargetId(i).next(o=>(r=new qi(e,o,"TargetPurposeListen",i.currentSequenceNumber),n.Bs.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=n.Ji.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(i.targetId,i),n.Yi.set(e,i.targetId)),i})}async function Jo(t,e,n){const i=te(t),r=i.Ji.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Vr(o))throw o;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ji=i.Ji.remove(e),i.Yi.delete(r.target)}function Th(t,e,n){const i=te(t);let r=ue.min(),s=Ie();return i.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=te(a),h=u.Yi.get(c);return h!==void 0?x.resolve(u.Ji.get(h)):u.Bs.getTargetData(l,c)}(i,o,Sn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.Hi.getDocumentsMatchingQuery(o,e,n?r:ue.min(),n?s:Ie())).next(a=>(ex(i,ok(e),a),{documents:a,ir:s})))}function Jk(t,e){const n=te(t),i=te(n.Bs),r=n.Ji.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",s=>i.le(s,e).next(o=>o?o.target:null))}function Zk(t,e){const n=te(t),i=n.Xi.get(e)||ue.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Zi.getAllFromCollectionGroup(r,e,BC(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(ex(n,e,r),r))}function ex(t,e,n){let i=t.Xi.get(e)||ue.min();n.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),t.Xi.set(e,i)}async function zU(t,e,n,i){const r=te(t);let s=Ie(),o=In();for(const c of n){const u=e.rr(c.metadata.name);c.document&&(s=s.add(u));const h=e.ur(c);h.setReadTime(e.cr(c.metadata.readTime)),o=o.insert(u,h)}const a=r.Zi.newChangeBuffer({trackRemovals:!0}),l=await Xo(r,function(c){return Sn(_a(Le.fromString(`__bundle__/docs/${c}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",c=>Xk(c,a,o).next(u=>(a.apply(c),u)).next(u=>r.Bs.removeMatchingKeysForTargetId(c,l.targetId).next(()=>r.Bs.addMatchingKeys(c,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(c,u.nr,u.sr)).next(()=>u.nr)))}async function jU(t,e,n=Ie()){const i=await Xo(t,Sn(Av(e.bundledQuery))),r=te(t);return r.persistence.runTransaction("Save named query","readwrite",s=>{const o=wt(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return r.qs.saveNamedQuery(s,e);const a=i.withResumeToken(xt.EMPTY_BYTE_STRING,o);return r.Ji=r.Ji.insert(a.targetId,a),r.Bs.updateTargetData(s,a).next(()=>r.Bs.removeMatchingKeysForTargetId(s,i.targetId)).next(()=>r.Bs.addMatchingKeys(s,n,i.targetId)).next(()=>r.qs.saveNamedQuery(s,e))})}function R0(t,e){return`firestore_clients_${t}_${e}`}function N0(t,e,n){let i=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Lf(t,e){return`firestore_targets_${t}_${e}`}class Sh{constructor(e,n,i,r){this.user=e,this.batchId=n,this.state=i,this.error=r}static ar(e,n,i){const r=JSON.parse(i);let s,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new U(r.error.code,r.error.message))),o?new Sh(e,n,r.state,s):(yt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${i}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fl{constructor(e,n,i){this.targetId=e,this.state=n,this.error=i}static ar(e,n){const i=JSON.parse(n);let r,s=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(r=new U(i.error.code,i.error.message))),s?new fl(e,i.state,r):(yt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ch{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static ar(e,n){const i=JSON.parse(n);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=bv();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=VC(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new Ch(e,s):(yt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Lv{constructor(e,n){this.clientId=e,this.onlineState=n}static ar(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Lv(n.clientId,n.onlineState):(yt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class _m{constructor(){this.activeTargetIds=bv()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ff{constructor(e,n,i,r,s){this.window=e,this.ii=n,this.persistenceKey=i,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new et(be),this.started=!1,this.yr=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=R0(this.persistenceKey,this.wr),this.Ir=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new _m),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.Rr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.$i();for(const i of e){if(i===this.wr)continue;const r=this.getItem(R0(this.persistenceKey,i));if(r){const s=Ch.ar(i,r);s&&(this.gr=this.gr.insert(s.clientId,s))}}this.Pr();const n=this.storage.getItem(this.vr);if(n){const i=this.br(n);i&&this.Vr(i)}for(const i of this.yr)this.mr(i);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let n=!1;return this.gr.forEach((i,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,n,i){this.Dr(e,n,i),this.Cr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Lf(this.persistenceKey,e));if(i){const r=fl.ar(e,i);r&&(n=r.state)}}return this.Nr.lr(e),this.Pr(),n}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Lf(this.persistenceKey,e))}updateQueryState(e,n,i){this.kr(e,n,i)}handleUserChange(e,n,i){n.forEach(r=>{this.Cr(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return z("SharedClientState","READ",e,n),n}setItem(e,n){z("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){z("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){const n=e;if(n.storageArea===this.storage){if(z("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void yt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Tr.test(n.key)){if(n.newValue==null){const i=this.Or(n.key);return this.Fr(i,null)}{const i=this.Br(n.key,n.newValue);if(i)return this.Fr(i.clientId,i)}}else if(this.Er.test(n.key)){if(n.newValue!==null){const i=this.Lr(n.key,n.newValue);if(i)return this.qr(i)}}else if(this.Ar.test(n.key)){if(n.newValue!==null){const i=this.Ur(n.key,n.newValue);if(i)return this.Kr(i)}}else if(n.key===this.vr){if(n.newValue!==null){const i=this.br(n.newValue);if(i)return this.Vr(i)}}else if(n.key===this.Ir){const i=function(r){let s=bn.ct;if(r!=null)try{const o=JSON.parse(r);he(typeof o=="number"),s=o}catch(o){yt("SharedClientState","Failed to read sequence number from WebStorage",o)}return s}(n.newValue);i!==bn.ct&&this.sequenceNumberHandler(i)}else if(n.key===this.Rr){const i=this.Gr(n.newValue);await Promise.all(i.map(r=>this.syncEngine.Qr(r)))}}}else this.yr.push(n)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,n,i){const r=new Sh(this.currentUser,e,n,i),s=N0(this.persistenceKey,this.currentUser,e);this.setItem(s,r.hr())}Cr(e){const n=N0(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Mr(e){const n={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(n))}kr(e,n,i){const r=Lf(this.persistenceKey,e),s=new fl(e,n,i);this.setItem(r,s.hr())}$r(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Rr,n)}Or(e){const n=this.Tr.exec(e);return n?n[1]:null}Br(e,n){const i=this.Or(e);return Ch.ar(i,n)}Lr(e,n){const i=this.Er.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return Sh.ar(new Ot(s),r,n)}Ur(e,n){const i=this.Ar.exec(e),r=Number(i[1]);return fl.ar(r,n)}br(e){return Lv.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);z("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,n){const i=n?this.gr.insert(e,n):this.gr.remove(e),r=this.Sr(this.gr),s=this.Sr(i),o=[],a=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.Wr(o,a).then(()=>{this.gr=i})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let n=bv();return e.forEach((i,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class tx{constructor(){this.Hr=new _m,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,i){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new _m,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uu=null;function Bf(){return uu===null?uu=268435456+Math.round(2147483648*Math.random()):uu++,"0x"+uu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class GU extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,i,r,s){const o=Bf(),a=this.To(e,n);z("RestConnection",`Sending RPC '${e}' ${o}:`,a,i);const l={};return this.Eo(l,r,s),this.Ao(e,a,l,i).then(c=>(z("RestConnection",`Received RPC '${e}' ${o}: `,c),c),c=>{throw li("RestConnection",`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",i),c})}vo(e,n,i,r,s,o){return this.Io(e,n,i,r,s)}Eo(e,n,i){e["X-Goog-Api-Client"]="gl-js/ fire/"+ya,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}To(e,n){const i=KU[e];return`${this.mo}/v1/${n}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,i,r){const s=Bf();return new Promise((o,a)=>{const l=new j$;l.setWithCredentials(!0),l.listenOnce(U$.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Of.NO_ERROR:const u=l.getResponseJson();z(Zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),o(u);break;case Of.TIMEOUT:z(Zt,`RPC '${e}' ${s} timed out`),a(new U(D.DEADLINE_EXCEEDED,"Request time out"));break;case Of.HTTP_ERROR:const h=l.getStatus();if(z(Zt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const p=function(m){const g=m.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(g)>=0?g:D.UNKNOWN}(f.status);a(new U(p,f.message))}else a(new U(D.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new U(D.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{z(Zt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(r);z(Zt,`RPC '${e}' ${s} sending request:`,r),l.send(n,"POST",c,i,15)})}Ro(e,n,i){const r=Bf(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$$(),a=q$(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new z$({})),this.Eo(l.initMessageHeaders,n,i),l.encodeInitMessageHeaders=!0;const u=s.join("");z(Zt,`Creating RPC '${e}' stream ${r}: ${u}`,l);const h=o.createWebChannel(u,l);let d=!1,f=!1;const p=new WU({ro:g=>{f?z(Zt,`Not sending because RPC '${e}' stream ${r} is closed:`,g):(d||(z(Zt,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),z(Zt,`RPC '${e}' stream ${r} sending:`,g),h.send(g))},oo:()=>h.close()}),m=(g,w,v)=>{g.listen(w,b=>{try{v(b)}catch(E){setTimeout(()=>{throw E},0)}})};return m(h,iu.EventType.OPEN,()=>{f||z(Zt,`RPC '${e}' stream ${r} transport opened.`)}),m(h,iu.EventType.CLOSE,()=>{f||(f=!0,z(Zt,`RPC '${e}' stream ${r} transport closed`),p.wo())}),m(h,iu.EventType.ERROR,g=>{f||(f=!0,li(Zt,`RPC '${e}' stream ${r} transport errored:`,g),p.wo(new U(D.UNAVAILABLE,"The operation could not be completed")))}),m(h,iu.EventType.MESSAGE,g=>{var w;if(!f){const v=g.data[0];he(!!v);const b=v,E=b.error||((w=b[0])===null||w===void 0?void 0:w.error);if(E){z(Zt,`RPC '${e}' stream ${r} received error:`,E);const P=E.status;let C=function(N){const S=St[N];if(S!==void 0)return bk(S)}(P),B=E.message;C===void 0&&(C=D.INTERNAL,B="Unknown error status: "+P+" with message "+E.message),f=!0,p.wo(new U(C,B)),h.close()}else z(Zt,`RPC '${e}' stream ${r} received:`,v),p._o(v)}}),m(a,V$.STAT_EVENT,g=>{g.stat===qw.PROXY?z(Zt,`RPC '${e}' stream ${r} detected buffering proxy`):g.stat===qw.NOPROXY&&z(Zt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{p.fo()},0),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(){return typeof window<"u"?window:null}function Pu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(t){return new nU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n,i=1e3,r=1.5,s=6e4){this.ii=e,this.timerId=n,this.Po=i,this.bo=r,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),i=Math.max(0,Date.now()-this.Co),r=Math.max(0,n-i);r>0&&z("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,n,i,r,s,o,a,l){this.ii=e,this.$o=i,this.Oo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Fv(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===D.RESOURCE_EXHAUSTED?(yt(n.toString()),yt("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===D.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Fo===n&&this.Zo(i,r)},i=>{e(()=>{const r=new U(D.UNKNOWN,"Fetching auth token failed: "+i.message);return this.tu(r)})})}Zo(e,n){const i=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{i(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(r=>{i(()=>this.tu(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QU extends ix{constructor(e,n,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=sU(this.serializer,e),i=function(r){if(!("targetChange"in r))return ue.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?ue.min():s.readTime?wt(s.readTime):ue.min()}(e);return this.listener.nu(n,i)}su(e){const n={};n.database=Wl(this.serializer),n.addTarget=function(r,s){let o;const a=s.target;if(o=yh(a)?{documents:Rk(r,a)}:{query:Nk(r,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=Sk(r,s.resumeToken);const l=fm(r,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(ue.min())>0){o.readTime=Yo(r,s.snapshotVersion.toTimestamp());const l=fm(r,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const i=aU(this.serializer,e);i&&(n.labels=i),this.Wo(n)}iu(e){const n={};n.database=Wl(this.serializer),n.removeTarget=e,this.Wo(n)}}class YU extends ix{constructor(e,n,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,r,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=oU(e.writeResults,e.commitTime),i=wt(e.commitTime);return this.listener.cu(i,n)}return he(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Wl(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(i=>Gl(this.serializer,i))};this.Wo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU extends class{}{constructor(e,n,i,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.Io(e,n,i,r,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new U(D.UNKNOWN,r.toString())})}vo(e,n,i,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,n,i,s,o,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===D.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(D.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class JU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(yt(n),this.mu=!1):z("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e,n,i,r,s){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(o=>{i.enqueueAndForget(async()=>{jr(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=te(a);l.vu.add(4),await Ea(l),l.bu.set("Unknown"),l.vu.delete(4),await Nc(l)}(this))})}),this.bu=new JU(i,r)}}async function Nc(t){if(jr(t))for(const e of t.Ru)await e(!0)}async function Ea(t){for(const e of t.Ru)await e(!1)}function Md(t,e){const n=te(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),qv(n)?$v(n):Ta(n).Ko()&&Bv(n,e))}function Ql(t,e){const n=te(t),i=Ta(n);n.Au.delete(e),i.Ko()&&rx(n,e),n.Au.size===0&&(i.Ko()?i.jo():jr(n)&&n.bu.set("Unknown"))}function Bv(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ta(t).su(e)}function rx(t,e){t.Vu.qt(e),Ta(t).iu(e)}function $v(t){t.Vu=new Jq({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),Ta(t).start(),t.bu.gu()}function qv(t){return jr(t)&&!Ta(t).Uo()&&t.Au.size>0}function jr(t){return te(t).vu.size===0}function sx(t){t.Vu=void 0}async function eV(t){t.Au.forEach((e,n)=>{Bv(t,e)})}async function tV(t,e){sx(t),qv(t)?(t.bu.Iu(e),$v(t)):t.bu.set("Unknown")}async function nV(t,e,n){if(t.bu.set("Online"),e instanceof Tk&&e.state===2&&e.cause)try{await async function(i,r){const s=r.cause;for(const o of r.targetIds)i.Au.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Au.delete(o),i.Vu.removeTarget(o))}(t,e)}catch(i){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await kh(t,i)}else if(e instanceof Ou?t.Vu.Ht(e):e instanceof Ik?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(ue.min()))try{const i=await Yk(t.localStore);n.compareTo(i)>=0&&await function(r,s){const o=r.Vu.ce(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=r.Au.get(l);c&&r.Au.set(l,c.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,l)=>{const c=r.Au.get(a);if(!c)return;r.Au.set(a,c.withResumeToken(xt.EMPTY_BYTE_STRING,c.snapshotVersion)),rx(r,a);const u=new qi(c.target,a,l,c.sequenceNumber);Bv(r,u)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(i){z("RemoteStore","Failed to raise snapshot:",i),await kh(t,i)}}async function kh(t,e,n){if(!Vr(e))throw e;t.vu.add(1),await Ea(t),t.bu.set("Offline"),n||(n=()=>Yk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await Nc(t)})}function ox(t,e){return e().catch(n=>kh(t,n,e))}async function Ia(t){const e=te(t),n=Pr(e);let i=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;iV(e);)try{const r=await VU(e.localStore,i);if(r===null){e.Eu.length===0&&n.jo();break}i=r.batchId,rV(e,r)}catch(r){await kh(e,r)}ax(e)&&lx(e)}function iV(t){return jr(t)&&t.Eu.length<10}function rV(t,e){t.Eu.push(e);const n=Pr(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function ax(t){return jr(t)&&!Pr(t).Uo()&&t.Eu.length>0}function lx(t){Pr(t).start()}async function sV(t){Pr(t).hu()}async function oV(t){const e=Pr(t);for(const n of t.Eu)e.uu(n.mutations)}async function aV(t,e,n){const i=t.Eu.shift(),r=Tv.from(i,e,n);await ox(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Ia(t)}async function lV(t,e){e&&Pr(t).ou&&await async function(n,i){if(r=i.code,wk(r)&&r!==D.ABORTED){const s=n.Eu.shift();Pr(n).Qo(),await ox(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Ia(n)}var r}(t,e),ax(t)&&lx(t)}async function O0(t,e){const n=te(t);n.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const i=jr(n);n.vu.add(3),await Ea(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await Nc(n)}async function wm(t,e){const n=te(t);e?(n.vu.delete(2),await Nc(n)):e||(n.vu.add(2),await Ea(n),n.bu.set("Unknown"))}function Ta(t){return t.Su||(t.Su=function(e,n,i){const r=te(e);return r.fu(),new QU(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{uo:eV.bind(null,t),ao:tV.bind(null,t),nu:nV.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),qv(t)?$v(t):t.bu.set("Unknown")):(await t.Su.stop(),sx(t))})),t.Su}function Pr(t){return t.Du||(t.Du=function(e,n,i){const r=te(e);return r.fu(),new YU(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{uo:sV.bind(null,t),ao:lV.bind(null,t),au:oV.bind(null,t),cu:aV.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await Ia(t)):(await t.Du.stop(),t.Eu.length>0&&(z("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,i,r,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new Bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,i,r,s){const o=Date.now()+i,a=new Uv(e,n,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(D.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Sa(t,e){if(yt("AsyncQueue",`${e}: ${t}`),Vr(t))return new U(D.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.comparator=e?(n,i)=>e(n,i)||Z.comparator(n.key,i.key):(n,i)=>Z.comparator(n.key,i.key),this.keyedMap=Qa(),this.sortedSet=new et(this.comparator)}static emptySet(e){return new Mo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,i)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Mo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(){this.Cu=new et(Z.comparator)}track(e){const n=e.doc.key,i=this.Cu.get(n);i?e.type!==0&&i.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&i.type!==1?this.Cu=this.Cu.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.Cu=this.Cu.remove(n):e.type===1&&i.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):oe():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,i)=>{e.push(i)}),e}}class Zo{constructor(e,n,i,r,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,i,r,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Zo(e,n,Mo.emptySet(n),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==i[r].type||!n[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this.Nu=void 0,this.listeners=[]}}class uV{constructor(){this.queries=new zr(e=>sk(e),Sc),this.onlineState="Unknown",this.ku=new Set}}async function Vv(t,e){const n=te(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new cV),r)try{s.Nu=await n.onListen(i)}catch(o){const a=Sa(o,`Initialization of query '${dm(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.listeners.push(e),e.Mu(n.onlineState),s.Nu&&e.$u(s.Nu)&&jv(n)}async function zv(t,e){const n=te(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),r=s.listeners.length===0)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function hV(t,e){const n=te(t);let i=!1;for(const r of e){const s=r.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.$u(r)&&(i=!0);o.Nu=r}}i&&jv(n)}function dV(t,e,n){const i=te(t),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(n);i.queries.delete(e)}function jv(t){t.ku.forEach(e=>{e.next()})}class Hv{constructor(e,n,i){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=i||{}}$u(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Zo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const i=n!=="Offline";return(!this.options.Ku||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=Zo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e,n){this.Gu=e,this.byteLength=n}Qu(){return"metadata"in this.Gu}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.serializer=e}rr(e){return Si(this.serializer,e)}ur(e){return e.metadata.exists?Ak(this.serializer,e.document,!1):st.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return wt(e)}}class pV{constructor(e,n,i){this.ju=e,this.localStore=n,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=cx(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++n;const i=Le.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}Wu(e){const n=new Map,i=new M0(this.serializer);for(const r of e)if(r.metadata.queries){const s=i.rr(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||Ie()).add(s);n.set(o,a)}}return n}async complete(){const e=await zU(this.localStore,new M0(this.serializer),this.documents,this.ju.id),n=this.Wu(this.documents);for(const i of this.queries)await jU(this.localStore,i,n.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}}function cx(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e){this.key=e}}class hx{constructor(e){this.key=e}}class dx{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Ie(),this.mutatedKeys=Ie(),this.tc=ak(e),this.ec=new Mo(this.tc)}get nc(){return this.Yu}sc(e,n){const i=n?n.ic:new P0,r=n?n.ec:this.ec;let s=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=Cc(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let g=!1;d&&f?d.data.isEqual(f.data)?p!==m&&(i.track({type:3,doc:f}),g=!0):this.rc(d,f)||(i.track({type:2,doc:f}),g=!0,(l&&this.tc(f,l)>0||c&&this.tc(f,c)<0)&&(a=!0)):!d&&f?(i.track({type:0,doc:f}),g=!0):d&&!f&&(i.track({type:1,doc:d}),g=!0,(l||c)&&(a=!0)),g&&(f?(o=o.add(f),s=m?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{ec:o,ic:i,zi:a,mutatedKeys:s}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((c,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return f(h)-f(d)}(c.type,u.type)||this.tc(c.doc,u.doc)),this.oc(i);const o=n?this.uc():[],a=this.Zu.size===0&&this.current?1:0,l=a!==this.Xu;return this.Xu=a,s.length!==0||l?{snapshot:new Zo(this.query,e.ec,r,s,e.mutatedKeys,a===0,l,!1,!!i&&i.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new P0,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Ie(),this.ec.forEach(i=>{this.ac(i.key)&&(this.Zu=this.Zu.add(i.key))});const n=[];return e.forEach(i=>{this.Zu.has(i)||n.push(new hx(i))}),this.Zu.forEach(i=>{e.has(i)||n.push(new ux(i))}),n}hc(e){this.Yu=e.ir,this.Zu=Ie();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return Zo.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class mV{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class gV{constructor(e){this.key=e,this.fc=!1}}class vV{constructor(e,n,i,r,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new zr(a=>sk(a),Sc),this._c=new Map,this.mc=new Set,this.gc=new et(Z.comparator),this.yc=new Map,this.Ic=new Dv,this.Tc={},this.Ec=new Map,this.Ac=qs.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function yV(t,e){const n=Yv(t);let i,r;const s=n.wc.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.lc();else{const o=await Xo(n.localStore,Sn(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,r=await Kv(n,e,i,a==="current",o.resumeToken),n.isPrimaryClient&&Md(n.remoteStore,o)}return r}async function Kv(t,e,n,i,r){t.Rc=(h,d,f)=>async function(p,m,g,w){let v=m.view.sc(g);v.zi&&(v=await Th(p.localStore,m.query,!1).then(({documents:P})=>m.view.sc(P,v)));const b=w&&w.targetChanges.get(m.targetId),E=m.view.applyChanges(v,p.isPrimaryClient,b);return bm(p,m.targetId,E.cc),E.snapshot}(t,h,d,f);const s=await Th(t.localStore,e,!0),o=new dx(e,s.ir),a=o.sc(s.documents),l=Ac.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",r),c=o.applyChanges(a,t.isPrimaryClient,l);bm(t,n,c.cc);const u=new mV(e,n,o);return t.wc.set(e,u),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),c.snapshot}async function _V(t,e){const n=te(t),i=n.wc.get(e),r=n._c.get(i.targetId);if(r.length>1)return n._c.set(i.targetId,r.filter(s=>!Sc(s,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Jo(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),Ql(n.remoteStore,i.targetId),ea(n,i.targetId)}).catch(Ur)):(ea(n,i.targetId),await Jo(n.localStore,i.targetId,!0))}async function wV(t,e,n){const i=Xv(t);try{const r=await function(s,o){const a=te(s),l=ot.now(),c=o.reduce((d,f)=>d.add(f.key),Ie());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=In(),p=Ie();return a.Zi.getEntries(d,c).next(m=>{f=m,f.forEach((g,w)=>{w.isValidDocument()||(p=p.add(g))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(m=>{u=m;const g=[];for(const w of o){const v=Qq(w,u.get(w.key).overlayedDocument);v!=null&&g.push(new Yi(w.key,v,YC(v.value.mapValue),ht.exists(!0)))}return a.mutationQueue.addMutationBatch(d,l,g,o)}).next(m=>{h=m;const g=m.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,m.batchId,g)})}).then(()=>({batchId:h.batchId,changes:ck(u)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(s,o,a){let l=s.Tc[s.currentUser.toKey()];l||(l=new et(be)),l=l.insert(o,a),s.Tc[s.currentUser.toKey()]=l}(i,r.batchId,n),await Xi(i,r.changes),await Ia(i.remoteStore)}catch(r){const s=Sa(r,"Failed to persist write");n.reject(s)}}async function fx(t,e){const n=te(t);try{const i=await UU(n.localStore,e);e.targetChanges.forEach((r,s)=>{const o=n.yc.get(s);o&&(he(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.fc=!0:r.modifiedDocuments.size>0?he(o.fc):r.removedDocuments.size>0&&(he(o.fc),o.fc=!1))}),await Xi(n,i,e)}catch(i){await Ur(i)}}function L0(t,e,n){const i=te(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const r=[];i.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&r.push(a.snapshot)}),function(s,o){const a=te(s);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const h of u.listeners)h.Mu(o)&&(l=!0)}),l&&jv(a)}(i.eventManager,e),r.length&&i.dc.nu(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function bV(t,e,n){const i=te(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.yc.get(e),s=r&&r.key;if(s){let o=new et(Z.comparator);o=o.insert(s,st.newNoDocument(s,ue.min()));const a=Ie().add(s),l=new xc(ue.min(),new Map,new et(be),o,a);await fx(i,l),i.gc=i.gc.remove(s),i.yc.delete(e),Qv(i)}else await Jo(i.localStore,e,!1).then(()=>ea(i,e,n)).catch(Ur)}async function EV(t,e){const n=te(t),i=e.batch.batchId;try{const r=await qU(n.localStore,e);Gv(n,i,null),Wv(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Xi(n,r)}catch(r){await Ur(r)}}async function IV(t,e,n){const i=te(t);try{const r=await function(s,o){const a=te(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(he(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(i.localStore,e);Gv(i,e,n),Wv(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Xi(i,r)}catch(r){await Ur(r)}}async function TV(t,e){const n=te(t);jr(n.remoteStore)||z("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await function(s){const o=te(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(i===-1)return void e.resolve();const r=n.Ec.get(i)||[];r.push(e),n.Ec.set(i,r)}catch(i){const r=Sa(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function Wv(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function Gv(t,e,n){const i=te(t);let r=i.Tc[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(n?s.reject(n):s.resolve(),r=r.remove(e)),i.Tc[i.currentUser.toKey()]=r}}function ea(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t._c.get(e))t.wc.delete(i),n&&t.dc.Pc(i,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(i=>{t.Ic.containsKey(i)||px(t,i)})}function px(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(Ql(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),Qv(t))}function bm(t,e,n){for(const i of n)i instanceof ux?(t.Ic.addReference(i.key,e),SV(t,i)):i instanceof hx?(z("SyncEngine","Document no longer in limbo: "+i.key),t.Ic.removeReference(i.key,e),t.Ic.containsKey(i.key)||px(t,i.key)):oe()}function SV(t,e){const n=e.key,i=n.path.canonicalString();t.gc.get(n)||t.mc.has(i)||(z("SyncEngine","New document in limbo: "+n),t.mc.add(i),Qv(t))}function Qv(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new Z(Le.fromString(e)),i=t.Ac.next();t.yc.set(i,new gV(n)),t.gc=t.gc.insert(n,i),Md(t.remoteStore,new qi(Sn(_a(n.path)),i,"TargetPurposeLimboResolution",bn.ct))}}async function Xi(t,e,n){const i=te(t),r=[],s=[],o=[];i.wc.isEmpty()||(i.wc.forEach((a,l)=>{o.push(i.Rc(l,e,n).then(c=>{if((c||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){r.push(c);const u=Mv.Li(l.targetId,c);s.push(u)}}))}),await Promise.all(o),i.dc.nu(r),await async function(a,l){const c=te(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>x.forEach(l,h=>x.forEach(h.Fi,d=>c.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>x.forEach(h.Bi,d=>c.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!Vr(u))throw u;z("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const h=u.targetId;if(!u.fromCache){const d=c.Ji.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);c.Ji=c.Ji.insert(h,p)}}}(i.localStore,s))}async function CV(t,e){const n=te(t);if(!n.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());const i=await Qk(n.localStore,e);n.currentUser=e,function(r,s){r.Ec.forEach(o=>{o.forEach(a=>{a.reject(new U(D.CANCELLED,s))})}),r.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Xi(n,i.er)}}function kV(t,e){const n=te(t),i=n.yc.get(e);if(i&&i.fc)return Ie().add(i.key);{let r=Ie();const s=n._c.get(e);if(!s)return r;for(const o of s){const a=n.wc.get(o);r=r.unionWith(a.view.nc)}return r}}async function xV(t,e){const n=te(t),i=await Th(n.localStore,e.query,!0),r=e.view.hc(i);return n.isPrimaryClient&&bm(n,e.targetId,r.cc),r}async function AV(t,e){const n=te(t);return Zk(n.localStore,e).then(i=>Xi(n,i))}async function RV(t,e,n,i){const r=te(t),s=await function(o,a){const l=te(o),c=te(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",u=>c.Sn(u,a).next(h=>h?l.localDocuments.getDocuments(u,h):x.resolve(null)))}(r.localStore,e);s!==null?(n==="pending"?await Ia(r.remoteStore):n==="acknowledged"||n==="rejected"?(Gv(r,e,i||null),Wv(r,e),function(o,a){te(te(o).mutationQueue).Cn(a)}(r.localStore,e)):oe(),await Xi(r,s)):z("SyncEngine","Cannot apply mutation batch with id: "+e)}async function NV(t,e){const n=te(t);if(Yv(n),Xv(n),e===!0&&n.vc!==!0){const i=n.sharedClientState.getAllActiveQueryTargets(),r=await F0(n,i.toArray());n.vc=!0,await wm(n.remoteStore,!0);for(const s of r)Md(n.remoteStore,s)}else if(e===!1&&n.vc!==!1){const i=[];let r=Promise.resolve();n._c.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(ea(n,o),Jo(n.localStore,o,!0))),Ql(n.remoteStore,o)}),await r,await F0(n,i),function(s){const o=te(s);o.yc.forEach((a,l)=>{Ql(o.remoteStore,l)}),o.Ic.Ts(),o.yc=new Map,o.gc=new et(Z.comparator)}(n),n.vc=!1,await wm(n.remoteStore,!1)}}async function F0(t,e,n){const i=te(t),r=[],s=[];for(const o of e){let a;const l=i._c.get(o);if(l&&l.length!==0){a=await Xo(i.localStore,Sn(l[0]));for(const c of l){const u=i.wc.get(c),h=await xV(i,u);h.snapshot&&s.push(h.snapshot)}}else{const c=await Jk(i.localStore,o);a=await Xo(i.localStore,c),await Kv(i,mx(c),o,!1,a.resumeToken)}r.push(a)}return i.dc.nu(s),r}function mx(t){return rk(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function DV(t){const e=te(t);return te(te(e.localStore).persistence).$i()}async function OV(t,e,n,i){const r=te(t);if(r.vc)return void z("SyncEngine","Ignoring unexpected query state notification.");const s=r._c.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await Zk(r.localStore,ok(s[0])),a=xc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",xt.EMPTY_BYTE_STRING);await Xi(r,o,a);break}case"rejected":await Jo(r.localStore,e,!0),ea(r,e,i);break;default:oe()}}async function PV(t,e,n){const i=Yv(t);if(i.vc){for(const r of e){if(i._c.has(r)){z("SyncEngine","Adding an already active target "+r);continue}const s=await Jk(i.localStore,r),o=await Xo(i.localStore,s);await Kv(i,mx(s),o.targetId,!1,o.resumeToken),Md(i.remoteStore,o)}for(const r of n)i._c.has(r)&&await Jo(i.localStore,r,!1).then(()=>{Ql(i.remoteStore,r),ea(i,r)}).catch(Ur)}}function Yv(t){const e=te(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=fx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bV.bind(null,e),e.dc.nu=hV.bind(null,e.eventManager),e.dc.Pc=dV.bind(null,e.eventManager),e}function Xv(t){const e=te(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IV.bind(null,e),e}function MV(t,e,n){const i=te(t);(async function(r,s,o){try{const a=await s.getMetadata();if(await function(h,d){const f=te(h),p=wt(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",m=>f.qs.getBundleMetadata(m,d.id)).then(m=>!!m&&m.createTime.compareTo(p)>=0)}(r.localStore,a))return await s.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(cx(a));const l=new pV(a,r.localStore,s.serializer);let c=await s.bc();for(;c;){const h=await l.zu(c);h&&o._updateProgress(h),c=await s.bc()}const u=await l.complete();return await Xi(r,u.Ju,void 0),await function(h,d){const f=te(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.qs.saveBundleMetadata(p,d))}(r.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Hu)}catch(a){return li("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(i,e,n).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}class Em{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Rc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Gk(this.persistence,new Wk,e.initialUser,this.serializer)}createPersistence(e){return new Kk(Pd.zs,this.serializer)}createSharedClientState(e){return new tx}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class gx extends Em{constructor(e,n,i){super(),this.Vc=e,this.cacheSizeBytes=n,this.forceOwnership=i,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await Xv(this.Vc.syncEngine),await Ia(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return Gk(this.persistence,new Wk,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const i=this.persistence.referenceDelegate.garbageCollector;return new TU(i,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const i=new aq(n,this.persistence);return new oq(e.asyncQueue,i)}createPersistence(e){const n=Pv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new Ov(this.synchronizeTabs,n,e.clientId,i,e.asyncQueue,nx(),Pu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new tx}}class LV extends gx{constructor(e,n){super(e,n,!1),this.Vc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Vc.syncEngine;this.sharedClientState instanceof Ff&&(this.sharedClientState.syncEngine={jr:RV.bind(null,n),zr:OV.bind(null,n),Wr:PV.bind(null,n),$i:DV.bind(null,n),Qr:AV.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ii(async i=>{await NV(this.Vc.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=nx();if(!Ff.D(n))throw new U(D.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Pv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ff(n,e.asyncQueue,i,e.clientId,e.initialUser)}}class Jv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>L0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=CV.bind(null,this.syncEngine),await wm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new uV}createDatastore(e){const n=Rc(e.databaseInfo.databaseId),i=(r=e.databaseInfo,new GU(r));var r;return function(s,o,a,l){return new XU(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return n=this.localStore,i=this.datastore,r=e.asyncQueue,s=a=>L0(this.syncEngine,a,0),o=D0.D()?new D0:new HU,new ZU(n,i,r,s,o);var n,i,r,s,o}createSyncEngine(e,n){return function(i,r,s,o,a,l,c){const u=new vV(i,r,s,o,a,l);return c&&(u.vc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=te(e);z("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await Ea(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):yt("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,n){this.Cc=e,this.serializer=n,this.metadata=new Bt,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(i=>{i&&i.Qu()?this.metadata.resolve(i.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.Gu)}`))},i=>this.metadata.reject(i))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){const e=await this.kc();if(e===null)return null;const n=this.xc.decode(e),i=Number(n);isNaN(i)&&this.Mc(`length string (${n}) is not valid number`);const r=await this.$c(i);return new fV(JSON.parse(r),e.length+i)}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async kc(){for(;this.Oc()<0&&!await this.Fc(););if(this.buffer.length===0)return null;const e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");const n=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){const e=await this.Cc.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new U(D.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(i,r){const s=te(i),o=Wl(s.serializer)+"/documents",a={documents:r.map(h=>Kl(s.serializer,h))},l=await s.vo("BatchGetDocuments",o,a,r.length),c=new Map;l.forEach(h=>{const d=rU(s.serializer,h);c.set(d.key.toString(),d)});const u=[];return r.forEach(h=>{const d=c.get(h.toString());he(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(i=>this.recordVersion(i)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new ba(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,i)=>{const r=Z.fromPath(i);this.mutations.push(new Ev(r,this.precondition(r)))}),await async function(n,i){const r=te(n),s=Wl(r.serializer)+"/documents",o={writes:i.map(a=>Gl(r.serializer,a))};await r.Io("Commit",s,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw oe();n=ue.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!n.isEqual(i))throw new U(D.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ue.min())?ht.exists(!1):ht.updateTime(n):ht.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ue.min()))throw new U(D.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ht.updateTime(n)}return ht.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,n,i,r,s){this.asyncQueue=e,this.datastore=n,this.options=i,this.updateFunction=r,this.deferred=s,this.Bc=i.maxAttempts,this.qo=new Fv(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new BV(this.datastore),n=this.qc(e);n&&n.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.Uc(r)}))}).catch(i=>{this.Uc(i)})})}qc(e){try{const n=this.updateFunction(e);return!Ic(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!wk(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,n,i,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=Ot.UNAUTHENTICATED,this.clientId=MC.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async s=>{z("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(i,s=>(z("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new U(D.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=Sa(n,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Mu(t,e){t.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async r=>{i.isEqual(r)||(await Qk(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Im(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Zv(t);z("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener(r=>O0(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>O0(e.remoteStore,s)),t._onlineComponents=e}function vx(t){return t.name==="FirebaseError"?t.code===D.FAILED_PRECONDITION||t.code===D.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Zv(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Mu(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!vx(n))throw n;li("Error using user provided cache. Falling back to memory cache: "+n),await Mu(t,new Em)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Mu(t,new Em);return t._offlineComponents}async function Fd(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await Im(t,t._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await Im(t,new Jv))),t._onlineComponents}function yx(t){return Zv(t).then(e=>e.persistence)}function ey(t){return Zv(t).then(e=>e.localStore)}function _x(t){return Fd(t).then(e=>e.remoteStore)}function ty(t){return Fd(t).then(e=>e.syncEngine)}function UV(t){return Fd(t).then(e=>e.datastore)}async function ta(t){const e=await Fd(t),n=e.eventManager;return n.onListen=yV.bind(null,e.syncEngine),n.onUnlisten=_V.bind(null,e.syncEngine),n}function VV(t){return t.asyncQueue.enqueue(async()=>{const e=await yx(t),n=await _x(t);return e.setNetworkEnabled(!0),function(i){const r=te(i);return r.vu.delete(0),Nc(r)}(n)})}function zV(t){return t.asyncQueue.enqueue(async()=>{const e=await yx(t),n=await _x(t);return e.setNetworkEnabled(!1),async function(i){const r=te(i);r.vu.add(0),await Ea(r),r.bu.set("Offline")}(n)})}function jV(t,e){const n=new Bt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,r,s){try{const o=await function(a,l){const c=te(a);return c.persistence.runTransaction("read document","readonly",u=>c.localDocuments.getDocument(u,l))}(i,r);o.isFoundDocument()?s.resolve(o):o.isNoDocument()?s.resolve(null):s.reject(new U(D.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Sa(o,`Failed to get document '${r} from cache`);s.reject(a)}}(await ey(t),e,n)),n.promise}function wx(t,e,n={}){const i=new Bt;return t.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new Ld({next:h=>{s.enqueueAndForget(()=>zv(r,u));const d=h.docs.has(o);!d&&h.fromCache?l.reject(new U(D.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?l.reject(new U(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new Hv(_a(o.path),c,{includeMetadataChanges:!0,Ku:!0});return Vv(r,u)}(await ta(t),t.asyncQueue,e,n,i)),i.promise}function HV(t,e){const n=new Bt;return t.asyncQueue.enqueueAndForget(async()=>async function(i,r,s){try{const o=await Th(i,r,!0),a=new dx(r,o.ir),l=a.sc(o.documents),c=a.applyChanges(l,!1);s.resolve(c.snapshot)}catch(o){const a=Sa(o,`Failed to execute query '${r} against cache`);s.reject(a)}}(await ey(t),e,n)),n.promise}function bx(t,e,n={}){const i=new Bt;return t.asyncQueue.enqueueAndForget(async()=>function(r,s,o,a,l){const c=new Ld({next:h=>{s.enqueueAndForget(()=>zv(r,u)),h.fromCache&&a.source==="server"?l.reject(new U(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new Hv(o,c,{includeMetadataChanges:!0,Ku:!0});return Vv(r,u)}(await ta(t),t.asyncQueue,e,n,i)),i.promise}function KV(t,e){const n=new Ld(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,r){te(i).ku.add(r),r.next()}(await ta(t),n)),()=>{n.Dc(),t.asyncQueue.enqueueAndForget(async()=>function(i,r){te(i).ku.delete(r)}(await ta(t),n))}}function WV(t,e,n,i){const r=function(s,o){let a;return a=typeof s=="string"?Ek().encode(s):s,function(l,c){return new FV(l,c)}(function(l,c){if(l instanceof Uint8Array)return B0(l,c);if(l instanceof ArrayBuffer)return B0(new Uint8Array(l),c);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Rc(e));t.asyncQueue.enqueueAndForget(async()=>{MV(await ty(t),r,i)})}function GV(t,e){return t.asyncQueue.enqueue(async()=>function(n,i){const r=te(n);return r.persistence.runTransaction("Get named query","readonly",s=>r.qs.getNamedQuery(s,i))}(await ey(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e,n){if(!n)throw new U(D.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ix(t,e,n,i){if(e===!0&&i===!0)throw new U(D.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function q0(t){if(!Z.isDocumentKey(t))throw new U(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function U0(t){if(Z.isDocumentKey(t))throw new U(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe()}function Be(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new U(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bd(t);throw new U(D.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Tx(t,e){if(e<=0)throw new U(D.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e){var n,i;if(e.host===void 0){if(e.ssl!==void 0)throw new U(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new U(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ix("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ex((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new U(D.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,i=e.experimentalLongPollingOptions,n.timeoutSeconds===i.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,i}}class Dc{constructor(e,n,i,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new V0({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new U(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new U(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new V0(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new G$;switch(n.type){case"firstParty":return new J$(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new U(D.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=$0.get(e);n&&(z("ComponentProvider","Removing Datastore"),$0.delete(e),n.terminate())}(this),Promise.resolve()}}function Sx(t,e,n,i={}){var r;const s=(t=Be(t,Dc))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=Ot.MOCK_USER;else{a=gI(i.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new U(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ot(c)}t._authCredentials=new Q$(new PC(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ci(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new lt(this.firestore,e,this._key)}}class Jt{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Jt(this.firestore,e,this._query)}}class Ci extends Jt{constructor(e,n,i){super(e,n,_a(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new lt(this.firestore,null,new Z(e))}withConverter(e){return new Ci(this.firestore,e,this._path)}}function Us(t,e,...n){if(t=Ve(t),ny("collection","path",e),t instanceof Dc){const i=Le.fromString(e,...n);return U0(i),new Ci(t,null,i)}{if(!(t instanceof lt||t instanceof Ci))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Le.fromString(e,...n));return U0(i),new Ci(t.firestore,null,i)}}function QV(t,e){if(t=Be(t,Dc),ny("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new U(D.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Jt(t,null,function(n){return new Qi(Le.emptyPath(),n)}(e))}function mn(t,e,...n){if(t=Ve(t),arguments.length===1&&(e=MC.A()),ny("doc","path",e),t instanceof Dc){const i=Le.fromString(e,...n);return q0(i),new lt(t,null,new Z(i))}{if(!(t instanceof lt||t instanceof Ci))throw new U(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Le.fromString(e,...n));return q0(i),new lt(t.firestore,t instanceof Ci?t.converter:null,new Z(i))}}function Cx(t,e){return t=Ve(t),e=Ve(e),(t instanceof lt||t instanceof Ci)&&(e instanceof lt||e instanceof Ci)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function kx(t,e){return t=Ve(t),e=Ve(e),t instanceof Jt&&e instanceof Jt&&t.firestore===e.firestore&&Sc(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Fv(this,"async_queue_retry"),this.Xc=()=>{const n=Pu();n&&z("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=Pu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=Pu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new Bt;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Vr(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(i=>{this.Wc=i,this.Hc=!1;const r=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(i);throw yt("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Hc=!1,i))));return this.Gc=n,n}enqueueAfterDelay(e,n,i){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const r=Uv.createAndSchedule(this,e,n,i,s=>this.na(s));return this.zc.push(r),r}Zc(){this.Wc&&oe()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function Tm(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const i=e;for(const r of n)if(r in i&&typeof i[r]=="function")return!0;return!1}(t,["next","error","complete"])}class XV{constructor(){this._progressObserver={},this._taskCompletionResolver=new Bt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,i){this._progressObserver={next:e,error:n,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV=-1;class pt extends Dc{constructor(e,n,i,r){super(e,n,i,r),this.type="firestore",this._queue=new YV,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||xx(this),this._firestoreClient.terminate()}}function ZV(t,e){const n=typeof t=="object"?t:ic(),i=typeof t=="string"?t:e||"(default)",r=da(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=fI("firestore");s&&Sx(r,...s)}return r}function Vt(t){return t._firestoreClient||xx(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function xx(t){var e,n,i;const r=t._freezeSettings(),s=function(o,a,l,c){return new xq(o,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Ex(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new qV(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=r.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.cache)===null||i===void 0)&&i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}function e2(t,e){Rx(t=Be(t,pt));const n=Vt(t);if(n._uninitializedComponentsProvider)throw new U(D.FAILED_PRECONDITION,"SDK cache is already specified.");li("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=t._freezeSettings(),r=new Jv;return Ax(n,r,new gx(r,i.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function t2(t){Rx(t=Be(t,pt));const e=Vt(t);if(e._uninitializedComponentsProvider)throw new U(D.FAILED_PRECONDITION,"SDK cache is already specified.");li("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),i=new Jv;return Ax(e,i,new LV(i,n.cacheSizeBytes))}function Ax(t,e,n){const i=new Bt;return t.asyncQueue.enqueue(async()=>{try{await Mu(t,n),await Im(t,e),i.resolve()}catch(r){const s=r;if(!vx(s))throw s;li("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}}).then(()=>i.promise)}function n2(t){if(t._initialized&&!t._terminated)throw new U(D.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Bt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!ti.D())return Promise.resolve();const i=n+"main";await ti.delete(i)}(Pv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function i2(t){return function(e){const n=new Bt;return e.asyncQueue.enqueueAndForget(async()=>TV(await ty(e),n)),n.promise}(Vt(t=Be(t,pt)))}function r2(t){return VV(Vt(t=Be(t,pt)))}function s2(t){return zV(Vt(t=Be(t,pt)))}function o2(t,e){const n=Vt(t=Be(t,pt)),i=new XV;return WV(n,t._databaseId,e,i),i}function a2(t,e){return GV(Vt(t=Be(t,pt)),e).then(n=>n?new Jt(t,null,n.query):null)}function Rx(t){if(t._initialized||t._terminated)throw new U(D.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ni(xt.fromBase64String(e))}catch(n){throw new U(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ni(xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new U(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new U(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new U(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=/^__.*__$/;class c2{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Yi(e,this.data,this.fieldMask,n,this.fieldTransforms):new wa(e,this.data,n,this.fieldTransforms)}}class Nx{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Yi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Dx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class $d{constructor(e,n,i,r,s,o){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new $d(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.aa({path:i,la:!1});return r.fa(e),r}da(e){var n;const i=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.aa({path:i,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return xh(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(Dx(this.ca)&&l2.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class u2{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Rc(e)}ya(e,n,i,r=!1){return new $d({ca:e,methodName:n,ga:i,path:_t.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xs(t){const e=t._freezeSettings(),n=Rc(t._databaseId);return new u2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function qd(t,e,n,i,r,s={}){const o=t.ya(s.merge||s.mergeFields?2:0,e,n,r);oy("Data must be an object, but it was:",o,i);const a=Mx(i,o);let l,c;if(s.merge)l=new En(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=Sm(e,h,n);if(!o.contains(d))throw new U(D.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Fx(u,d)||u.push(d)}l=new En(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new c2(new Gt(a),l,c)}class Pc extends Ys{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pc}}function Ox(t,e,n){return new $d({ca:3,ga:e.settings.ga,methodName:t._methodName,la:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class iy extends Ys{_toFieldTransform(e){return new kc(e.path,new Go)}isEqual(e){return e instanceof iy}}class h2 extends Ys{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=Ox(this,e,!0),i=this.pa.map(s=>Js(s,n)),r=new Ls(i);return new kc(e.path,r)}isEqual(e){return this===e}}class d2 extends Ys{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=Ox(this,e,!0),i=this.pa.map(s=>Js(s,n)),r=new Fs(i);return new kc(e.path,r)}isEqual(e){return this===e}}class f2 extends Ys{constructor(e,n){super(e),this.Ia=n}_toFieldTransform(e){const n=new Qo(e.serializer,fk(e.serializer,this.Ia));return new kc(e.path,n)}isEqual(e){return this===e}}function ry(t,e,n,i){const r=t.ya(1,e,n);oy("Data must be an object, but it was:",r,i);const s=[],o=Gt.empty();Qs(i,(l,c)=>{const u=ay(e,l,n);c=Ve(c);const h=r.da(u);if(c instanceof Pc)s.push(u);else{const d=Js(c,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new En(s);return new Nx(o,a,r.fieldTransforms)}function sy(t,e,n,i,r,s){const o=t.ya(1,e,n),a=[Sm(e,i,n)],l=[r];if(s.length%2!=0)throw new U(D.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Sm(e,s[d])),l.push(s[d+1]);const c=[],u=Gt.empty();for(let d=a.length-1;d>=0;--d)if(!Fx(c,a[d])){const f=a[d];let p=l[d];p=Ve(p);const m=o.da(f);if(p instanceof Pc)c.push(f);else{const g=Js(p,m);g!=null&&(c.push(f),u.set(f,g))}}const h=new En(c);return new Nx(u,h,o.fieldTransforms)}function Px(t,e,n,i=!1){return Js(n,t.ya(i?4:3,e))}function Js(t,e){if(Lx(t=Ve(t)))return oy("Unsupported field value:",e,t),Mx(t,e);if(t instanceof Ys)return function(n,i){if(!Dx(i.ca))throw i._a(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i._a(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,i){const r=[];let s=0;for(const o of n){let a=Js(o,i.wa(s));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),s++}return{arrayValue:{values:r}}}(t,e)}return function(n,i){if((n=Ve(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return fk(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=ot.fromDate(n);return{timestampValue:Yo(i.serializer,r)}}if(n instanceof ot){const r=new ot(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Yo(i.serializer,r)}}if(n instanceof Oc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ni)return{bytesValue:Sk(i.serializer,n._byteString)};if(n instanceof lt){const r=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(r))throw i._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:xv(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i._a(`Unsupported field value: ${Bd(n)}`)}(t,e)}function Mx(t,e){const n={};return WC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qs(t,(i,r)=>{const s=Js(r,e.ha(i));s!=null&&(n[i]=s)}),{mapValue:{fields:n}}}function Lx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ot||t instanceof Oc||t instanceof Ni||t instanceof lt||t instanceof Ys)}function oy(t,e,n){if(!Lx(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const i=Bd(n);throw i==="an object"?e._a(t+" a custom object"):e._a(t+" "+i)}}function Sm(t,e,n){if((e=Ve(e))instanceof Mr)return e._internalPath;if(typeof e=="string")return ay(t,e);throw xh("Field path arguments must be of type string or ",t,!1,void 0,n)}const p2=new RegExp("[~\\*/\\[\\]]");function ay(t,e,n){if(e.search(p2)>=0)throw xh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Mr(...e.split("."))._internalPath}catch{throw xh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xh(t,e,n,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new U(D.INVALID_ARGUMENT,a+t+l)}function Fx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n,i,r,s){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new m2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ud("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class m2 extends Yl{data(){return super.data()}}function Ud(t,e){return typeof e=="string"?ay(t,e):e instanceof Mr?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new U(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ly{}class Mc extends ly{}function xn(t,e,...n){let i=[];e instanceof ly&&i.push(e),i=i.concat(n),function(r){const s=r.filter(a=>a instanceof cy).length,o=r.filter(a=>a instanceof Vd).length;if(s>1||s>0&&o>0)throw new U(D.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)t=r._apply(t);return t}class Vd extends Mc{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new Vd(e,n,i)}_apply(e){const n=this._parse(e);return qx(e._query,n),new Jt(e.firestore,e.converter,hm(e._query,n))}_parse(e){const n=Xs(e.firestore);return function(r,s,o,a,l,c,u){let h;if(l.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new U(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){j0(u,c);const d=[];for(const f of u)d.push(z0(a,r,f));h={arrayValue:{values:d}}}else h=z0(a,r,u)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||j0(u,c),h=Px(o,s,u,c==="in"||c==="not-in");return Re.create(l,c,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Lo(t,e,n){const i=e,r=Ud("where",t);return Vd._create(r,i,n)}class cy extends ly{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cy(e,n)}_parse(e){const n=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:We.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,r){let s=i;const o=r.getFlattenedFilters();for(const a of o)qx(s,a),s=hm(s,a)}(e._query,n),new Jt(e.firestore,e.converter,hm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class uy extends Mc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new uy(e,n)}_apply(e){const n=function(i,r,s){if(i.startAt!==null)throw new U(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new U(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Po(r,s);return function(a,l){if(_v(a)===null){const c=Ad(a);c!==null&&Ux(a,c,l.field)}}(i,o),o}(e._query,this._field,this._direction);return new Jt(e.firestore,e.converter,function(i,r){const s=i.explicitOrderBy.concat([r]);return new Qi(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function g2(t,e="asc"){const n=e,i=Ud("orderBy",t);return uy._create(i,n)}class zd extends Mc{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new zd(e,n,i)}_apply(e){return new Jt(e.firestore,e.converter,wh(e._query,this._limit,this._limitType))}}function v2(t){return Tx("limit",t),zd._create("limit",t,"F")}function y2(t){return Tx("limitToLast",t),zd._create("limitToLast",t,"L")}class jd extends Mc{constructor(e,n,i){super(),this.type=e,this._docOrFields=n,this._inclusive=i}static _create(e,n,i){return new jd(e,n,i)}_apply(e){const n=$x(e,this.type,this._docOrFields,this._inclusive);return new Jt(e.firestore,e.converter,function(i,r){return new Qi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,r,i.endAt)}(e._query,n))}}function _2(...t){return jd._create("startAt",t,!0)}function w2(...t){return jd._create("startAfter",t,!1)}class Hd extends Mc{constructor(e,n,i){super(),this.type=e,this._docOrFields=n,this._inclusive=i}static _create(e,n,i){return new Hd(e,n,i)}_apply(e){const n=$x(e,this.type,this._docOrFields,this._inclusive);return new Jt(e.firestore,e.converter,function(i,r){return new Qi(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,r)}(e._query,n))}}function b2(...t){return Hd._create("endBefore",t,!1)}function E2(...t){return Hd._create("endAt",t,!0)}function $x(t,e,n,i){if(n[0]=Ve(n[0]),n[0]instanceof Yl)return function(r,s,o,a,l){if(!a)throw new U(D.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const c=[];for(const u of bs(r))if(u.field.isKeyField())c.push(Ps(s,a.key));else{const h=a.data.field(u.field);if(xd(h))throw new U(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new U(D.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}c.push(h)}return new Or(c,l)}(t._query,t.firestore._databaseId,e,n[0]._document,i);{const r=Xs(t.firestore);return function(s,o,a,l,c,u){const h=s.explicitOrderBy;if(c.length>h.length)throw new U(D.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<c.length;f++){const p=c[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new U(D.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof p}`);if(!wv(s)&&p.indexOf("/")!==-1)throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${p}' contains a slash.`);const m=s.path.child(Le.fromString(p));if(!Z.isDocumentKey(m))throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);const g=new Z(m);d.push(Ps(o,g))}else{const m=Px(a,l,p);d.push(m)}}return new Or(d,u)}(t._query,t.firestore._databaseId,r,e,n,i)}}function z0(t,e,n){if(typeof(n=Ve(n))=="string"){if(n==="")throw new U(D.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wv(e)&&n.indexOf("/")!==-1)throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Le.fromString(n));if(!Z.isDocumentKey(i))throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ps(t,new Z(i))}if(n instanceof lt)return Ps(t,n._key);throw new U(D.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bd(n)}.`)}function j0(t,e){if(!Array.isArray(t)||t.length===0)throw new U(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qx(t,e){if(e.isInequality()){const i=Ad(t),r=e.field;if(i!==null&&!i.isEqual(r))throw new U(D.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${i.toString()}' and '${r.toString()}'`);const s=_v(t);s!==null&&Ux(t,r,s)}const n=function(i,r){for(const s of i)for(const o of s.getFlattenedFilters())if(r.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new U(D.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new U(D.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function Ux(t,e,n){if(!n.isEqual(e))throw new U(D.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class hy{convertValue(e,n="none"){switch(Os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Rr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw oe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Qs(e,(r,s)=>{i[r]=this.convertValue(s,n)}),i}convertGeoPoint(e){return new Oc(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":const i=vv(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(zl(e));default:return null}}convertTimestamp(e){const n=Ar(e);return new ot(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Le.fromString(e);he(Mk(i));const r=new Nr(i.get(1),i.get(3)),s=new Z(i.popFirst(5));return r.isEqual(n)||yt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class I2 extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new lt(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wi extends Yl{constructor(e,n,i,r,s,o){super(e,n,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new pl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(Ud("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}}class pl extends Wi{data(e={}){return super.data(e)}}class Lr{constructor(e,n,i,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new fs(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(i=>{e.call(n,new pl(this._firestore,this._userDataWriter,i.key,i,new fs(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new U(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const a=new pl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new fs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new pl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new fs(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,c=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),c=s.indexOf(o.doc.key)),{type:T2(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function T2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}function Vx(t,e){return t instanceof Wi&&e instanceof Wi?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Lr&&e instanceof Lr&&t._firestore===e._firestore&&kx(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t){t=Be(t,lt);const e=Be(t.firestore,pt);return wx(Vt(e),t._key).then(n=>dy(e,t,n))}class Zs extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new lt(this.firestore,null,n)}}function S2(t){t=Be(t,lt);const e=Be(t.firestore,pt),n=Vt(e),i=new Zs(e);return jV(n,t._key).then(r=>new Wi(e,i,t._key,r,new fs(r!==null&&r.hasLocalMutations,!0),t.converter))}function C2(t){t=Be(t,lt);const e=Be(t.firestore,pt);return wx(Vt(e),t._key,{source:"server"}).then(n=>dy(e,t,n))}function zi(t){t=Be(t,Jt);const e=Be(t.firestore,pt),n=Vt(e),i=new Zs(e);return Bx(t._query),bx(n,t._query).then(r=>new Lr(e,i,t,r))}function k2(t){t=Be(t,Jt);const e=Be(t.firestore,pt),n=Vt(e),i=new Zs(e);return HV(n,t._query).then(r=>new Lr(e,i,t,r))}function x2(t){t=Be(t,Jt);const e=Be(t.firestore,pt),n=Vt(e),i=new Zs(e);return bx(n,t._query,{source:"server"}).then(r=>new Lr(e,i,t,r))}function Es(t,e,n){t=Be(t,lt);const i=Be(t.firestore,pt),r=Kd(t.converter,e,n);return Bc(i,[qd(Xs(i),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,ht.none())])}function Ah(t,e,n,...i){t=Be(t,lt);const r=Be(t.firestore,pt),s=Xs(r);let o;return o=typeof(e=Ve(e))=="string"||e instanceof Mr?sy(s,"updateDoc",t._key,e,n,i):ry(s,"updateDoc",t._key,e),Bc(r,[o.toMutation(t._key,ht.exists(!0))])}function A2(t){return Bc(Be(t.firestore,pt),[new ba(t._key,ht.none())])}function R2(t,e){const n=Be(t.firestore,pt),i=mn(t),r=Kd(t.converter,e);return Bc(n,[qd(Xs(t.firestore),"addDoc",i._key,r,t.converter!==null,{}).toMutation(i._key,ht.exists(!1))]).then(()=>i)}function Fc(t,...e){var n,i,r;t=Ve(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Tm(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Tm(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(i=h.error)===null||i===void 0?void 0:i.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let l,c,u;if(t instanceof lt)c=Be(t.firestore,pt),u=_a(t._key.path),l={next:h=>{e[o]&&e[o](dy(c,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Be(t,Jt);c=Be(h.firestore,pt),u=h._query;const d=new Zs(c);l={next:f=>{e[o]&&e[o](new Lr(c,d,h,f))},error:e[o+1],complete:e[o+2]},Bx(t._query)}return function(h,d,f,p){const m=new Ld(p),g=new Hv(d,m,f);return h.asyncQueue.enqueueAndForget(async()=>Vv(await ta(h),g)),()=>{m.Dc(),h.asyncQueue.enqueueAndForget(async()=>zv(await ta(h),g))}}(Vt(c),u,a,l)}function N2(t,e){return KV(Vt(t=Be(t,pt)),Tm(e)?e:{next:e})}function Bc(t,e){return function(n,i){const r=new Bt;return n.asyncQueue.enqueueAndForget(async()=>wV(await ty(n),i,r)),r.promise}(Vt(t),e)}function dy(t,e,n){const i=n.docs.get(e._key),r=new Zs(t);return new Wi(t,r,e._key,i,new fs(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Xs(e)}set(e,n,i){this._verifyNotCommitted();const r=fr(e,this._firestore),s=Kd(r.converter,n,i),o=qd(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,ht.none())),this}update(e,n,i,...r){this._verifyNotCommitted();const s=fr(e,this._firestore);let o;return o=typeof(n=Ve(n))=="string"||n instanceof Mr?sy(this._dataReader,"WriteBatch.update",s._key,n,i,r):ry(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,ht.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=fr(e,this._firestore);return this._mutations=this._mutations.concat(new ba(n._key,ht.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new U(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function fr(t,e){if((t=Ve(t)).firestore!==e)throw new U(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Xs(e)}get(e){const n=fr(e,this._firestore),i=new I2(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return oe();const s=r[0];if(s.isFoundDocument())return new Yl(this._firestore,i,s.key,s,n.converter);if(s.isNoDocument())return new Yl(this._firestore,i,n._key,null,n.converter);throw oe()})}set(e,n,i){const r=fr(e,this._firestore),s=Kd(r.converter,n,i),o=qd(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,n,i,...r){const s=fr(e,this._firestore);let o;return o=typeof(n=Ve(n))=="string"||n instanceof Mr?sy(this._dataReader,"Transaction.update",s._key,n,i,r):ry(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=fr(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=fr(e,this._firestore),i=new Zs(this._firestore);return super.get(e).then(r=>new Wi(this._firestore,i,n._key,r._document,new fs(!1,!1),n.converter))}}function M2(t,e,n){t=Be(t,pt);const i=Object.assign(Object.assign({},D2),n);return function(r){if(r.maxAttempts<1)throw new U(D.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(r,s,o){const a=new Bt;return r.asyncQueue.enqueueAndForget(async()=>{const l=await UV(r);new $V(r.asyncQueue,l,o,s,a).run()}),a.promise}(Vt(t),r=>e(new P2(t,r)),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(){return new Pc("deleteField")}function Lu(){return new iy("serverTimestamp")}function F2(...t){return new h2("arrayUnion",t)}function B2(...t){return new d2("arrayRemove",t)}function $2(t){return new f2("increment",t)}(function(t,e=!0){(function(n){ya=n})(Oi),Kn(new Pn("firestore",(n,{instanceIdentifier:i,options:r})=>{const s=n.getProvider("app").getImmediate(),o=new pt(new Y$(n.getProvider("auth-internal")),new eq(n.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new U(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nr(a.options.projectId,l)}(s,i),s);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),an(Uw,"3.13.0",t),an(Uw,"3.13.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx="firebasestorage.googleapis.com",jx="storageBucket",q2=2*60*1e3,U2=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt extends ui{constructor(e,n,i=0){super($f(e),`Firebase Storage: ${n} (${$f(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $f(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var mt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(mt||(mt={}));function $f(t){return"storage/"+t}function fy(){const t="An unknown error occurred, please check the error payload for server response.";return new gt(mt.UNKNOWN,t)}function V2(t){return new gt(mt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function z2(t){return new gt(mt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function j2(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new gt(mt.UNAUTHENTICATED,t)}function H2(){return new gt(mt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function K2(t){return new gt(mt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function W2(){return new gt(mt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function G2(){return new gt(mt.CANCELED,"User canceled the upload/download.")}function Q2(t){return new gt(mt.INVALID_URL,"Invalid URL '"+t+"'.")}function Y2(t){return new gt(mt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function X2(){return new gt(mt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+jx+"' property when initializing the app?")}function J2(){return new gt(mt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Z2(){return new gt(mt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ez(t){return new gt(mt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Cm(t){return new gt(mt.INVALID_ARGUMENT,t)}function Hx(){return new gt(mt.APP_DELETED,"The Firebase app was deleted.")}function tz(t){return new gt(mt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ml(t,e){return new gt(mt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function qa(t){throw new gt(mt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=Dn.makeFromUrl(e,n)}catch{return new Dn(e,"")}if(i.path==="")return i;throw Y2(e)}static makeFromUrl(e,n){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(E){E.path_=decodeURIComponent(E.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},m=n===zx?"(?:storage.googleapis.com|storage.cloud.google.com)":n,g="([^?#]*)",w=new RegExp(`^https?://${m}/${r}/${g}`,"i"),b=[{regex:a,indices:l,postModify:s},{regex:f,indices:p,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let E=0;E<b.length;E++){const P=b[E],C=P.regex.exec(e);if(C){const B=C[P.indices.bucket];let N=C[P.indices.path];N||(N=""),i=new Dn(B,N),P.postModify(i);break}}if(i==null)throw Q2(e);return i}}class nz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(t,e,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...g){c||(c=!0,e.apply(null,g))}function h(g){r=setTimeout(()=>{r=null,t(f,l())},g)}function d(){s&&clearTimeout(s)}function f(g,...w){if(c){d();return}if(g){d(),u.call(null,g,...w);return}if(l()||o){d(),u.call(null,g,...w);return}i<64&&(i*=2);let b;a===1?(a=2,b=0):b=(i+Math.random())*1e3,h(b)}let p=!1;function m(g){p||(p=!0,d(),!c&&(r!==null?(g||(a=2),clearTimeout(r),h(0)):g||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}function rz(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sz(t){return t!==void 0}function oz(t){return typeof t=="object"&&!Array.isArray(t)}function py(t){return typeof t=="string"||t instanceof String}function H0(t){return my()&&t instanceof Blob}function my(){return typeof Blob<"u"&&!vI()}function K0(t,e,n,i){if(i<e)throw Cm(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw Cm(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function Kx(t){const e=encodeURIComponent;let n="?";for(const i in t)if(t.hasOwnProperty(i)){const r=e(i)+"="+e(t[i]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Is;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Is||(Is={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lz{constructor(e,n,i,r,s,o,a,l,c,u,h,d=!0){this.url_=e,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new hu(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Is.NO_ERROR,l=s.getStatus();if(!a||az(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Is.ABORT;i(!1,new hu(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;i(!0,new hu(c,s))})},n=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());sz(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=fy();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?Hx():G2();o(l)}else{const l=W2();o(l)}};this.canceled_?n(!1,new hu(!1,null,!0)):this.backoffId_=iz(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hu{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}}function cz(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function uz(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function hz(t,e){e&&(t["X-Firebase-GMPID"]=e)}function dz(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function fz(t,e,n,i,r,s,o=!0){const a=Kx(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return hz(c,e),cz(c,n),uz(c,s),dz(c,i),new lz(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function mz(...t){const e=pz();if(e!==void 0){const n=new e;for(let i=0;i<t.length;i++)n.append(t[i]);return n.getBlob()}else{if(my())return new Blob(t);throw new gt(mt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gz(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(t){if(typeof atob>"u")throw ez("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qf{constructor(e,n){this.data=e,this.contentType=n||null}}function yz(t,e){switch(t){case Ei.RAW:return new qf(Wx(e));case Ei.BASE64:case Ei.BASE64URL:return new qf(Gx(t,e));case Ei.DATA_URL:return new qf(wz(e),bz(e))}throw fy()}function Wx(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=i,o=t.charCodeAt(++n);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function _z(t){let e;try{e=decodeURIComponent(t)}catch{throw ml(Ei.DATA_URL,"Malformed data URL.")}return Wx(e)}function Gx(t,e){switch(t){case Ei.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw ml(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw ml(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=vz(e)}catch(r){throw r.message.includes("polyfill")?r:ml(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class Qx{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ml(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=n[1]||null;i!=null&&(this.base64=Ez(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function wz(t){const e=new Qx(t);return e.base64?Gx(Ei.BASE64,e.rest):_z(e.rest)}function bz(t){return new Qx(t).contentType}function Ez(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n){let i=0,r="";H0(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(H0(this.data_)){const i=this.data_,r=gz(i,e,n);return r===null?null:new pr(r)}else{const i=new Uint8Array(this.data_.buffer,e,n-e);return new pr(i,!0)}}static getBlob(...e){if(my()){const n=e.map(i=>i instanceof pr?i.data_:i);return new pr(mz.apply(null,n))}else{const n=e.map(o=>py(o)?yz(Ei.RAW,o).data:o.data_);let i=0;n.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new pr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(t){let e;try{e=JSON.parse(t)}catch{return null}return oz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iz(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Tz(t,e){const n=e.split("/").filter(i=>i.length>0).join("/");return t.length===0?n:t+"/"+n}function Xx(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(t,e){return e}class un{constructor(e,n,i,r){this.server=e,this.local=n||e,this.writable=!!i,this.xform=r||Sz}}let du=null;function Cz(t){return!py(t)||t.length<2?t:Xx(t)}function Jx(){if(du)return du;const t=[];t.push(new un("bucket")),t.push(new un("generation")),t.push(new un("metageneration")),t.push(new un("name","fullPath",!0));function e(s,o){return Cz(o)}const n=new un("name");n.xform=e,t.push(n);function i(s,o){return o!==void 0?Number(o):o}const r=new un("size");return r.xform=i,t.push(r),t.push(new un("timeCreated")),t.push(new un("updated")),t.push(new un("md5Hash",null,!0)),t.push(new un("cacheControl",null,!0)),t.push(new un("contentDisposition",null,!0)),t.push(new un("contentEncoding",null,!0)),t.push(new un("contentLanguage",null,!0)),t.push(new un("contentType",null,!0)),t.push(new un("metadata","customMetadata",!0)),du=t,du}function kz(t,e){function n(){const i=t.bucket,r=t.fullPath,s=new Dn(i,r);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function xz(t,e,n){const i={};i.type="file";const r=n.length;for(let s=0;s<r;s++){const o=n[s];i[o.local]=o.xform(i,e[o.server])}return kz(i,t),i}function Zx(t,e,n){const i=Yx(e);return i===null?null:xz(t,i,n)}function Az(t,e,n,i){const r=Yx(e);if(r===null||!py(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=gy(d,n,i),p=Kx({alt:"media",token:c});return f+p})[0]}function Rz(t,e){const n={},i=e.length;for(let r=0;r<i;r++){const s=e[r];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class eA{constructor(e,n,i,r){this.url=e,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t){if(!t)throw fy()}function Nz(t,e){function n(i,r){const s=Zx(t,r,e);return tA(s!==null),s}return n}function Dz(t,e){function n(i,r){const s=Zx(t,r,e);return tA(s!==null),Az(s,r,t.host,t._protocol)}return n}function nA(t){function e(n,i){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=H2():r=j2():n.getStatus()===402?r=z2(t.bucket):n.getStatus()===403?r=K2(t.path):r=i,r.status=n.getStatus(),r.serverResponse=i.serverResponse,r}return e}function Oz(t){const e=nA(t);function n(i,r){let s=e(i,r);return i.getStatus()===404&&(s=V2(t.path)),s.serverResponse=r.serverResponse,s}return n}function Pz(t,e,n){const i=e.fullServerUrl(),r=gy(i,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new eA(r,s,Dz(t,n),o);return a.errorHandler=Oz(e),a}function Mz(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Lz(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=Mz(null,e)),i}function Fz(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let b="";for(let E=0;E<2;E++)b=b+Math.random().toString().slice(2);return b}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Lz(e,i,r),u=Rz(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",f=pr.getBlob(h,i,d);if(f===null)throw J2();const p={name:c.fullPath},m=gy(s,t.host,t._protocol),g="POST",w=t.maxUploadRetryTime,v=new eA(m,g,Nz(t,n),w);return v.urlParams=p,v.headers=o,v.body=f.uploadData(),v.errorHandler=nA(e),v}class Bz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Is.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Is.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Is.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,r){if(this.sent_)throw qa("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw qa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw qa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw qa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw qa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class $z extends Bz{initXhr(){this.xhr_.responseType="text"}}function iA(){return new $z}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,n){this._service=e,n instanceof Dn?this._location=n:this._location=Dn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Vs(e,n)}get root(){const e=new Dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Xx(this._location.path)}get storage(){return this._service}get parent(){const e=Iz(this._location.path);if(e===null)return null;const n=new Dn(this._location.bucket,e);return new Vs(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw tz(e)}}function qz(t,e,n){t._throwIfRoot("uploadBytes");const i=Fz(t.storage,t._location,Jx(),new pr(e,!0),n);return t.storage.makeRequestWithTokens(i,iA).then(r=>({metadata:r,ref:t}))}function Uz(t){t._throwIfRoot("getDownloadURL");const e=Pz(t.storage,t._location,Jx());return t.storage.makeRequestWithTokens(e,iA).then(n=>{if(n===null)throw Z2();return n})}function Vz(t,e){const n=Tz(t._location.path,e),i=new Dn(t._location.bucket,n);return new Vs(t.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(t){return/^[A-Za-z]+:\/\//.test(t)}function jz(t,e){return new Vs(t,e)}function rA(t,e){if(t instanceof vy){const n=t;if(n._bucket==null)throw X2();const i=new Vs(n,n._bucket);return e!=null?rA(i,e):i}else return e!==void 0?Vz(t,e):t}function Hz(t,e){if(e&&zz(e)){if(t instanceof vy)return jz(t,e);throw Cm("To use ref(service, url), the first argument must be a Storage instance.")}else return rA(t,e)}function W0(t,e){const n=e==null?void 0:e[jx];return n==null?null:Dn.makeFromBucketSpec(n,t)}function Kz(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=i;r&&(t._overrideAuthToken=typeof r=="string"?r:gI(r,t.app.options.projectId))}class vy{constructor(e,n,i,r,s){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=zx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=q2,this._maxUploadRetryTime=U2,this._requests=new Set,r!=null?this._bucket=Dn.makeFromBucketSpec(r,this._host):this._bucket=W0(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Dn.makeFromBucketSpec(this._url,e):this._bucket=W0(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){K0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){K0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Vs(this,e)}_makeRequest(e,n,i,r,s=!0){if(this._deleted)return new nz(Hx());{const o=fz(e,this._appId,i,r,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,r).getPromise()}}const G0="@firebase/storage",Q0="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="storage";function Wz(t,e,n){return t=Ve(t),qz(t,e,n)}function Gz(t){return t=Ve(t),Uz(t)}function km(t,e){return t=Ve(t),Hz(t,e)}function Qz(t=ic(),e){t=Ve(t);const i=da(t,sA).getImmediate({identifier:e}),r=fI("storage");return r&&Yz(i,...r),i}function Yz(t,e,n,i={}){Kz(t,e,n,i)}function Xz(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new vy(n,i,r,e,Oi)}function Jz(){Kn(new Pn(sA,Xz,"PUBLIC").setMultipleInstances(!0)),an(G0,Q0,""),an(G0,Q0,"esm2017")}Jz();const Uf=new WeakMap;function oA(t,e){return Uf.has(e)||Uf.set(e,t||{f:{},r:{},s:{},u:{}}),Uf.get(e)}function Zz(t,e,n,i){if(!t)return n;const[r,s]=aA(t);if(!r)return n;const o=oA(void 0,i)[r]||{},a=e||s;return a&&a in o?o[a]:n}function ej(t,e,n,i){if(!t)return;const[r,s]=aA(t);if(!r)return;const o=oA(void 0,i)[r],a=e||s;if(a)return n.then(l=>{o[a]=l}).catch(gi),a}function aA(t){return WM(t)||GM(t)?["f",t.path]:QM(t)?["r",t.toString()]:YM(t)?["s",t.toString()]:[]}const Vf=new WeakMap;function tj(t,e,n){const i=od();Vf.has(i)||Vf.set(i,new Map);const r=Vf.get(i),s=ej(e,n,t,i);return s&&r.set(s,t),s?()=>r.delete(s):gi}const nj={toFirestore(t){return t},fromFirestore(t,e){return t.exists()?Object.defineProperties(t.data(e),{id:{value:t.id}}):null}};function xm(t,e,n,i){if(!KM(t))return[t,{}];const r=[{},{}],s=Object.keys(n).reduce((a,l)=>{const c=n[l];return a[c.path]=c.data(),a},{});function o(a,l,c,u){l=l||{};const[h,d]=u;Object.getOwnPropertyNames(a).forEach(f=>{const p=Object.getOwnPropertyDescriptor(a,f);p&&!p.enumerable&&Object.defineProperty(h,f,p)});for(const f in a){const p=a[f];if(p==null||p instanceof Date||p instanceof ot||p instanceof Oc)h[f]=p;else if(Ig(p)){const m=c+f;h[f]=m in n?l[f]:p.path,d[m]=p.converter?p:p.withConverter(i.converter)}else if(Array.isArray(p)){h[f]=Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];g&&g.path in s&&(h[f][m]=s[g.path])}o(p,l[f]||h[f],c+f+".",[h[f],d])}else Hs(p)?(h[f]={},o(p,l[f],c+f+".",[h[f],d])):h[f]=p}}return o(t,e,"",r),r}const yy={reset:!1,wait:!0,maxRefDepth:2,converter:nj,snapshotOptions:{serverTimestamps:"estimate"}};function Rh(t){for(const e in t)t[e].unsub()}function Am(t,e,n,i,r,s,o,a,l){const[c,u]=xm(i.data(t.snapshotOptions),Eg(e,n),r,t);s.set(e,n,c),Rm(t,e,n,r,u,s,o,a,l)}function ij({ref:t,target:e,path:n,depth:i,resolve:r,reject:s,ops:o},a){const l=Object.create(null);let c=gi;return a.once?Lc(t).then(u=>{u.exists()?Am(a,e,n,u,l,o,i,r,s):(o.set(e,n,null),r())}).catch(s):c=Fc(t,u=>{u.exists()?Am(a,e,n,u,l,o,i,r,s):(o.set(e,n,null),r())},s),()=>{c(),Rh(l)}}function Rm(t,e,n,i,r,s,o,a,l){const c=Object.keys(r);if(Object.keys(i).filter(m=>c.indexOf(m)<0).forEach(m=>{i[m].unsub(),delete i[m]}),!c.length||++o>t.maxRefDepth)return a(n);let h=0;const d=c.length,f=Object.create(null);function p(m){m in f&&++h>=d&&a(n)}c.forEach(m=>{const g=i[m],w=r[m],v=`${n}.${m}`;if(f[v]=!0,g)if(g.path!==w.path)g.unsub();else return;i[m]={data:()=>Eg(e,v),unsub:ij({ref:w,target:e,path:v,depth:o,ops:s,resolve:p.bind(null,v),reject:l},t),path:w.path}})}function rj(t,e,n,i,r,s){const o=Object.assign({},yy,s),{snapshotListenOptions:a,snapshotOptions:l,wait:c,once:u}=o,h="value";let d=ae(c?[]:t.value);c||n.set(t,h,[]);const f=i;let p,m=gi;const g=[],w={added:({newIndex:b,doc:E})=>{g.splice(b,0,Object.create(null));const P=g[b],[C,B]=xm(E.data(l),void 0,P,o);n.add(Ae(d),b,C),Rm(o,d,`${h}.${b}`,P,B,n,0,i.bind(null,E),r)},modified:({oldIndex:b,newIndex:E,doc:P})=>{const C=Ae(d),B=g[b],N=C[b],[S,k]=xm(P.data(l),N,B,o);g.splice(E,0,B),n.remove(C,b),n.add(C,E,S),Rm(o,d,`${h}.${E}`,B,k,n,0,i,r)},removed:({oldIndex:b})=>{const E=Ae(d);n.remove(E,b),Rh(g.splice(b,1)[0])}};function v(b){const E=b.docChanges(a);if(!p&&E.length){p=!0;let P=0;const C=E.length,B=Object.create(null);for(let N=0;N<C;N++)B[E[N].doc.id]=!0;i=N=>{N&&N.id in B&&++P>=C&&(c&&(n.set(t,h,Ae(d)),d=t),f(Ae(d)),i=gi)}}E.forEach(P=>{w[P.type](P)}),E.length||(c&&(n.set(t,h,Ae(d)),d=t),i(Ae(d)))}return u?zi(e).then(v).catch(r):m=Fc(e,v,r),b=>{if(m(),b){const E=typeof b=="function"?b():[];n.set(t,h,E)}g.forEach(Rh)}}function sj(t,e,n,i,r,s){const o=Object.assign({},yy,s),a="value",l=Object.create(null);i=XM(i,()=>Eg(t,a));let c=gi;function u(h){h.exists()?Am(o,t,a,h,l,n,0,i,r):(n.set(t,a,null),i(null))}return o.once?Lc(e).then(u).catch(r):c=Fc(e,u,r),h=>{if(c(),h){const d=typeof h=="function"?h():null;n.set(t,a,d)}Rh(l)}}function oj(t,e){let n=gi;const i=Object.assign({},yy,e),r=Ae(t),s=i.target||ae();JM()&&(i.once=!0);const o=Zz(r,i.ssrKey,s.value,od());s.value=o;let l=!(yT(r)?(o||[]).length>0:o!==void 0);const c=ae(!1),u=ae(),h=kE(),d=dE();let f=gi;function p(){let w=Ae(t);const v=new Promise((b,E)=>{if(n(i.reset),!w)return n=gi,b(null);c.value=l,l=!0,w.converter||(w=w.withConverter(i.converter)),n=(Ig(w)?sj:rj)(s,w,aj,b,E,i)}).catch(b=>(h.value===v&&(u.value=b),Promise.reject(b))).finally(()=>{h.value===v&&(c.value=!1)});h.value=v}let m=gi;Qt(t)&&(m=ge(t,p)),p(),r&&(f=tj(h.value,r,i.ssrKey)),je()&&jE(()=>h.value),d&&DR(g);function g(w=i.reset){m(),f(),n(w)}return Object.defineProperties(s,{error:{get:()=>u},data:{get:()=>s},pending:{get:()=>c},promise:{get:()=>h},stop:{get:()=>g}})}const aj={set:(t,e,n)=>jM(t,e,n),add:(t,e,n)=>t.splice(e,0,n),remove:(t,e)=>t.splice(e,1)};function lA(t,e){return oj(t,{target:ae([]),...e})}function lj(t){return(e,n)=>{const i=ZM(e,n).run(()=>ae(t));_T.set(e,i),eL(i,e)}}function cj(t,{firebaseApp:e,modules:n=[]}){t.provide(vT,e);for(const i of n)t.use(i.bind(null,e))}const cA=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},uj={};function hj(t,e){const n=KE("router-view");return Ke(),vt(n)}const dj=cA(uj,[["render",hj]]),_y=nd({apiKey:"AIzaSyA0qU5ytk4EJB870Ylp6KD6IGwOLzZOdtg",authDomain:"chitchat-e0ca3.firebaseapp.com",projectId:"chitchat-e0ca3",storageBucket:"chitchat-e0ca3.appspot.com",messagingSenderId:"986667587308",appId:"1:986667587308:web:962a51eb3862a4019f37c9",measurementId:"G-3JKDYQ2HGY"}),uA=ZV(_y),fj=Qz(_y),or=Us(uA,"users"),Xl=Us(uA,"chatrooms"),Y0=km(fj,"images"),pj="modulepreload",mj=function(t){return"/"+t},X0={},gj=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=mj(s),s in X0)return;X0[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let u=r.length-1;u>=0;u--){const h=r[u];if(h.href===s&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":pj,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};/*!
  * vue-router v4.2.2
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const vo=typeof window<"u";function vj(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const He=Object.assign;function zf(t,e){const n={};for(const i in e){const r=e[i];n[i]=ci(r)?r.map(t):t(r)}return n}const gl=()=>{},ci=Array.isArray,yj=/\/$/,_j=t=>t.replace(yj,"");function jf(t,e,n="/"){let i,r={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(i=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),r=t(s)),a>-1&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=Ij(i??e,n),{fullPath:i+(s&&"?")+s+o,path:i,query:r,hash:o}}function wj(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function J0(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function bj(t,e,n){const i=e.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&na(e.matched[i],n.matched[r])&&hA(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function na(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function hA(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Ej(t[n],e[n]))return!1;return!0}function Ej(t,e){return ci(t)?Z0(t,e):ci(e)?Z0(e,t):t===e}function Z0(t,e){return ci(e)?t.length===e.length&&t.every((n,i)=>n===e[i]):t.length===1&&t[0]===e}function Ij(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),i=t.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let s=n.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")s>1&&s--;else break;return n.slice(0,s).join("/")+"/"+i.slice(o-(o===i.length?1:0)).join("/")}var Jl;(function(t){t.pop="pop",t.push="push"})(Jl||(Jl={}));var vl;(function(t){t.back="back",t.forward="forward",t.unknown=""})(vl||(vl={}));function Tj(t){if(!t)if(vo){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),_j(t)}const Sj=/^[^#]+#/;function Cj(t,e){return t.replace(Sj,"#")+e}function kj(t,e){const n=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-n.left-(e.left||0),top:i.top-n.top-(e.top||0)}}const Wd=()=>({left:window.pageXOffset,top:window.pageYOffset});function xj(t){let e;if("el"in t){const n=t.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=kj(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function eb(t,e){return(history.state?history.state.position-e:-1)+t}const Nm=new Map;function Aj(t,e){Nm.set(t,e)}function Rj(t){const e=Nm.get(t);return Nm.delete(t),e}let Nj=()=>location.protocol+"//"+location.host;function dA(t,e){const{pathname:n,search:i,hash:r}=e,s=t.indexOf("#");if(s>-1){let a=r.includes(t.slice(s))?t.slice(s).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),J0(l,"")}return J0(n,t)+i+r}function Dj(t,e,n,i){let r=[],s=[],o=null;const a=({state:d})=>{const f=dA(t,location),p=n.value,m=e.value;let g=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}g=m?d.position-m.position:0}else i(f);r.forEach(w=>{w(n.value,p,{delta:g,type:Jl.pop,direction:g?g>0?vl.forward:vl.back:vl.unknown})})};function l(){o=n.value}function c(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return s.push(f),f}function u(){const{history:d}=window;d.state&&d.replaceState(He({},d.state,{scroll:Wd()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function tb(t,e,n,i=!1,r=!1){return{back:t,current:e,forward:n,replaced:i,position:window.history.length,scroll:r?Wd():null}}function Oj(t){const{history:e,location:n}=window,i={value:dA(t,n)},r={value:e.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+l:Nj()+t+l;try{e[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(l,c){const u=He({},e.state,tb(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),i.value=l}function a(l,c){const u=He({},r.value,e.state,{forward:l,scroll:Wd()});s(u.current,u,!0);const h=He({},tb(i.value,l,null),{position:u.position+1},c);s(l,h,!1),i.value=l}return{location:i,state:r,push:a,replace:o}}function Pj(t){t=Tj(t);const e=Oj(t),n=Dj(t,e.state,e.location,e.replace);function i(s,o=!0){o||n.pauseListeners(),history.go(s)}const r=He({location:"",base:t,go:i,createHref:Cj.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Mj(t){return typeof t=="string"||t&&typeof t=="object"}function fA(t){return typeof t=="string"||typeof t=="symbol"}const rr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},pA=Symbol("");var nb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(nb||(nb={}));function ia(t,e){return He(new Error,{type:t,[pA]:!0},e)}function Pi(t,e){return t instanceof Error&&pA in t&&(e==null||!!(t.type&e))}const ib="[^/]+?",Lj={sensitive:!1,strict:!1,start:!0,end:!0},Fj=/[.+*?^${}()[\]/\\]/g;function Bj(t,e){const n=He({},Lj,e),i=[];let r=n.start?"^":"";const s=[];for(const c of t){const u=c.length?[]:[90];n.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(Fj,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:m,optional:g,regexp:w}=d;s.push({name:p,repeatable:m,optional:g});const v=w||ib;if(v!==ib){f+=10;try{new RegExp(`(${v})`)}catch(E){throw new Error(`Invalid custom RegExp for param "${p}" (${v}): `+E.message)}}let b=m?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;h||(b=g&&c.length<2?`(?:/${b})`:"/"+b),g&&(b+="?"),r+=b,f+=20,g&&(f+=-8),m&&(f+=-20),v===".*"&&(f+=-50)}u.push(f)}i.push(u)}if(n.strict&&n.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=s[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function l(c){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:m,optional:g}=f,w=p in c?c[p]:"";if(ci(w)&&!m)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const v=ci(w)?w.join("/"):w;if(!v)if(g)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=v}}return u||"/"}return{re:o,score:i,keys:s,parse:a,stringify:l}}function $j(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=e[n]-t[n];if(i)return i;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function qj(t,e){let n=0;const i=t.score,r=e.score;for(;n<i.length&&n<r.length;){const s=$j(i[n],r[n]);if(s)return s;n++}if(Math.abs(r.length-i.length)===1){if(rb(i))return 1;if(rb(r))return-1}return r.length-i.length}function rb(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const Uj={type:0,value:""},Vj=/[a-zA-Z0-9_]/;function zj(t){if(!t)return[[]];if(t==="/")return[[Uj]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${c}": ${f}`)}let n=0,i=n;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,c="",u="";function h(){c&&(n===0?s.push({type:0,value:c}):n===1||n===2||n===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),n=1):d();break;case 4:d(),n=i;break;case 1:l==="("?n=2:Vj.test(l)?d():(h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),r}function jj(t,e,n){const i=Bj(zj(t.path),n),r=He(i,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function Hj(t,e){const n=[],i=new Map;e=ab({strict:!1,end:!0,sensitive:!1},e);function r(u){return i.get(u)}function s(u,h,d){const f=!d,p=Kj(u);p.aliasOf=d&&d.record;const m=ab(e,u),g=[p];if("alias"in u){const b=typeof u.alias=="string"?[u.alias]:u.alias;for(const E of b)g.push(He({},p,{components:d?d.record.components:p.components,path:E,aliasOf:d?d.record:p}))}let w,v;for(const b of g){const{path:E}=b;if(h&&E[0]!=="/"){const P=h.record.path,C=P[P.length-1]==="/"?"":"/";b.path=h.record.path+(E&&C+E)}if(w=jj(b,h,m),d?d.alias.push(w):(v=v||w,v!==w&&v.alias.push(w),f&&u.name&&!ob(w)&&o(u.name)),p.children){const P=p.children;for(let C=0;C<P.length;C++)s(P[C],w,d&&d.children[C])}d=d||w,(w.record.components&&Object.keys(w.record.components).length||w.record.name||w.record.redirect)&&l(w)}return v?()=>{o(v)}:gl}function o(u){if(fA(u)){const h=i.get(u);h&&(i.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&i.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function l(u){let h=0;for(;h<n.length&&qj(u,n[h])>=0&&(u.record.path!==n[h].record.path||!mA(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!ob(u)&&i.set(u.record.name,u)}function c(u,h){let d,f={},p,m;if("name"in u&&u.name){if(d=i.get(u.name),!d)throw ia(1,{location:u});m=d.record.name,f=He(sb(h.params,d.keys.filter(v=>!v.optional).map(v=>v.name)),u.params&&sb(u.params,d.keys.map(v=>v.name))),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(v=>v.re.test(p)),d&&(f=d.parse(p),m=d.record.name);else{if(d=h.name?i.get(h.name):n.find(v=>v.re.test(h.path)),!d)throw ia(1,{location:u,currentLocation:h});m=d.record.name,f=He({},h.params,u.params),p=d.stringify(f)}const g=[];let w=d;for(;w;)g.unshift(w.record),w=w.parent;return{name:m,path:p,params:f,matched:g,meta:Gj(g)}}return t.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function sb(t,e){const n={};for(const i of e)i in t&&(n[i]=t[i]);return n}function Kj(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Wj(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function Wj(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const i in t.components)e[i]=typeof n=="boolean"?n:n[i];return e}function ob(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Gj(t){return t.reduce((e,n)=>He(e,n.meta),{})}function ab(t,e){const n={};for(const i in t)n[i]=i in e?e[i]:t[i];return n}function mA(t,e){return e.children.some(n=>n===t||mA(t,n))}const gA=/#/g,Qj=/&/g,Yj=/\//g,Xj=/=/g,Jj=/\?/g,vA=/\+/g,Zj=/%5B/g,e4=/%5D/g,yA=/%5E/g,t4=/%60/g,_A=/%7B/g,n4=/%7C/g,wA=/%7D/g,i4=/%20/g;function wy(t){return encodeURI(""+t).replace(n4,"|").replace(Zj,"[").replace(e4,"]")}function r4(t){return wy(t).replace(_A,"{").replace(wA,"}").replace(yA,"^")}function Dm(t){return wy(t).replace(vA,"%2B").replace(i4,"+").replace(gA,"%23").replace(Qj,"%26").replace(t4,"`").replace(_A,"{").replace(wA,"}").replace(yA,"^")}function s4(t){return Dm(t).replace(Xj,"%3D")}function o4(t){return wy(t).replace(gA,"%23").replace(Jj,"%3F")}function a4(t){return t==null?"":o4(t).replace(Yj,"%2F")}function Nh(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function l4(t){const e={};if(t===""||t==="?")return e;const i=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(vA," "),o=s.indexOf("="),a=Nh(o<0?s:s.slice(0,o)),l=o<0?null:Nh(s.slice(o+1));if(a in e){let c=e[a];ci(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function lb(t){let e="";for(let n in t){const i=t[n];if(n=s4(n),i==null){i!==void 0&&(e+=(e.length?"&":"")+n);continue}(ci(i)?i.map(s=>s&&Dm(s)):[i&&Dm(i)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+n,s!=null&&(e+="="+s))})}return e}function c4(t){const e={};for(const n in t){const i=t[n];i!==void 0&&(e[n]=ci(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}const u4=Symbol(""),cb=Symbol(""),Gd=Symbol(""),by=Symbol(""),Om=Symbol("");function Ua(){let t=[];function e(i){return t.push(i),()=>{const r=t.indexOf(i);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function ar(t,e,n,i,r){const s=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const l=h=>{h===!1?a(ia(4,{from:n,to:e})):h instanceof Error?a(h):Mj(h)?a(ia(2,{from:e,to:h})):(s&&i.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),o())},c=t.call(i&&i.instances[r],e,n,l);let u=Promise.resolve(c);t.length<3&&(u=u.then(l)),u.catch(h=>a(h))})}function Hf(t,e,n,i){const r=[];for(const s of t)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(h4(a)){const c=(a.__vccOpts||a)[e];c&&r.push(ar(c,n,i,s,o))}else{let l=a();r.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${s.path}"`));const u=vj(c)?c.default:c;s.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&ar(d,n,i,s,o)()}))}}return r}function h4(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function ub(t){const e=Ft(Gd),n=Ft(by),i=I(()=>e.resolve(Ae(t.to))),r=I(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(na.bind(null,u));if(d>-1)return d;const f=hb(l[c-2]);return c>1&&hb(u)===f&&h[h.length-1].path!==f?h.findIndex(na.bind(null,l[c-2])):d}),s=I(()=>r.value>-1&&m4(n.params,i.value.params)),o=I(()=>r.value>-1&&r.value===n.matched.length-1&&hA(n.params,i.value.params));function a(l={}){return p4(l)?e[Ae(t.replace)?"replace":"push"](Ae(t.to)).catch(gl):Promise.resolve()}return{route:i,href:I(()=>i.value.href),isActive:s,isExactActive:o,navigate:a}}const d4=rg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:ub,setup(t,{slots:e}){const n=qn(ub(t)),{options:i}=Ft(Gd),r=I(()=>({[db(t.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[db(t.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=e.default&&e.default(n);return t.custom?s:M("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},s)}}}),f4=d4;function p4(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function m4(t,e){for(const n in e){const i=e[n],r=t[n];if(typeof i=="string"){if(i!==r)return!1}else if(!ci(r)||r.length!==i.length||i.some((s,o)=>s!==r[o]))return!1}return!0}function hb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const db=(t,e,n)=>t??e??n,g4=rg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const i=Ft(Om),r=I(()=>t.route||i.value),s=Ft(cb,0),o=I(()=>{let c=Ae(s);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=I(()=>r.value.matched[o.value]);ko(cb,I(()=>o.value+1)),ko(u4,a),ko(Om,r);const l=ae();return ge(()=>[l.value,a.value,t.name],([c,u,h],[d,f,p])=>{u&&(u.instances[h]=c,f&&f!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),c&&u&&(!f||!na(u,f)||!d)&&(u.enterCallbacks[h]||[]).forEach(m=>m(c))},{flush:"post"}),()=>{const c=r.value,u=t.name,h=a.value,d=h&&h.components[u];if(!d)return fb(n.default,{Component:d,route:c});const f=h.props[u],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,g=M(d,He({},p,e,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return fb(n.default,{Component:g,route:c})||g}}});function fb(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const bA=g4;function v4(t){const e=Hj(t.routes,t),n=t.parseQuery||l4,i=t.stringifyQuery||lb,r=t.history,s=Ua(),o=Ua(),a=Ua(),l=kE(rr);let c=rr;vo&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=zf.bind(null,L=>""+L),h=zf.bind(null,a4),d=zf.bind(null,Nh);function f(L,se){let J,de;return fA(L)?(J=e.getRecordMatcher(L),de=se):de=L,e.addRoute(de,J)}function p(L){const se=e.getRecordMatcher(L);se&&e.removeRoute(se)}function m(){return e.getRoutes().map(L=>L.record)}function g(L){return!!e.getRecordMatcher(L)}function w(L,se){if(se=He({},se||l.value),typeof L=="string"){const T=jf(n,L,se.path),F=e.resolve({path:T.path},se),q=r.createHref(T.fullPath);return He(T,F,{params:d(F.params),hash:Nh(T.hash),redirectedFrom:void 0,href:q})}let J;if("path"in L)J=He({},L,{path:jf(n,L.path,se.path).path});else{const T=He({},L.params);for(const F in T)T[F]==null&&delete T[F];J=He({},L,{params:h(T)}),se.params=h(se.params)}const de=e.resolve(J,se),$e=L.hash||"";de.params=u(d(de.params));const y=wj(i,He({},L,{hash:r4($e),path:de.path})),_=r.createHref(y);return He({fullPath:y,hash:$e,query:i===lb?c4(L.query):L.query||{}},de,{redirectedFrom:void 0,href:_})}function v(L){return typeof L=="string"?jf(n,L,l.value.path):He({},L)}function b(L,se){if(c!==L)return ia(8,{from:se,to:L})}function E(L){return B(L)}function P(L){return E(He(v(L),{replace:!0}))}function C(L){const se=L.matched[L.matched.length-1];if(se&&se.redirect){const{redirect:J}=se;let de=typeof J=="function"?J(L):J;return typeof de=="string"&&(de=de.includes("?")||de.includes("#")?de=v(de):{path:de},de.params={}),He({query:L.query,hash:L.hash,params:"path"in de?{}:L.params},de)}}function B(L,se){const J=c=w(L),de=l.value,$e=L.state,y=L.force,_=L.replace===!0,T=C(J);if(T)return B(He(v(T),{state:typeof T=="object"?He({},$e,T.state):$e,force:y,replace:_}),se||J);const F=J;F.redirectedFrom=se;let q;return!y&&bj(i,de,J)&&(q=ia(16,{to:F,from:de}),ke(de,de,!0,!1)),(q?Promise.resolve(q):k(F,de)).catch(H=>Pi(H)?Pi(H,2)?H:ye(H):Q(H,F,de)).then(H=>{if(H){if(Pi(H,2))return B(He({replace:_},v(H.to),{state:typeof H.to=="object"?He({},$e,H.to.state):$e,force:y}),se||F)}else H=R(F,de,!0,_,$e);return V(F,de,H),H})}function N(L,se){const J=b(L,se);return J?Promise.reject(J):Promise.resolve()}function S(L){const se=Et.values().next().value;return se&&typeof se.runWithContext=="function"?se.runWithContext(L):L()}function k(L,se){let J;const[de,$e,y]=y4(L,se);J=Hf(de.reverse(),"beforeRouteLeave",L,se);for(const T of de)T.leaveGuards.forEach(F=>{J.push(ar(F,L,se))});const _=N.bind(null,L,se);return J.push(_),pe(J).then(()=>{J=[];for(const T of s.list())J.push(ar(T,L,se));return J.push(_),pe(J)}).then(()=>{J=Hf($e,"beforeRouteUpdate",L,se);for(const T of $e)T.updateGuards.forEach(F=>{J.push(ar(F,L,se))});return J.push(_),pe(J)}).then(()=>{J=[];for(const T of L.matched)if(T.beforeEnter&&!se.matched.includes(T))if(ci(T.beforeEnter))for(const F of T.beforeEnter)J.push(ar(F,L,se));else J.push(ar(T.beforeEnter,L,se));return J.push(_),pe(J)}).then(()=>(L.matched.forEach(T=>T.enterCallbacks={}),J=Hf(y,"beforeRouteEnter",L,se),J.push(_),pe(J))).then(()=>{J=[];for(const T of o.list())J.push(ar(T,L,se));return J.push(_),pe(J)}).catch(T=>Pi(T,8)?T:Promise.reject(T))}function V(L,se,J){for(const de of a.list())S(()=>de(L,se,J))}function R(L,se,J,de,$e){const y=b(L,se);if(y)return y;const _=se===rr,T=vo?history.state:{};J&&(de||_?r.replace(L.fullPath,He({scroll:_&&T&&T.scroll},$e)):r.push(L.fullPath,$e)),l.value=L,ke(L,se,J,_),ye()}let X;function $(){X||(X=r.listen((L,se,J)=>{if(!me.listening)return;const de=w(L),$e=C(de);if($e){B(He($e,{replace:!0}),de).catch(gl);return}c=de;const y=l.value;vo&&Aj(eb(y.fullPath,J.delta),Wd()),k(de,y).catch(_=>Pi(_,12)?_:Pi(_,2)?(B(_.to,de).then(T=>{Pi(T,20)&&!J.delta&&J.type===Jl.pop&&r.go(-1,!1)}).catch(gl),Promise.reject()):(J.delta&&r.go(-J.delta,!1),Q(_,de,y))).then(_=>{_=_||R(de,y,!1),_&&(J.delta&&!Pi(_,8)?r.go(-J.delta,!1):J.type===Jl.pop&&Pi(_,20)&&r.go(-1,!1)),V(de,y,_)}).catch(gl)}))}let le=Ua(),ie=Ua(),A;function Q(L,se,J){ye(L);const de=ie.list();return de.length?de.forEach($e=>$e(L,se,J)):console.error(L),Promise.reject(L)}function Ce(){return A&&l.value!==rr?Promise.resolve():new Promise((L,se)=>{le.add([L,se])})}function ye(L){return A||(A=!L,$(),le.list().forEach(([se,J])=>L?J(L):se()),le.reset()),L}function ke(L,se,J,de){const{scrollBehavior:$e}=t;if(!vo||!$e)return Promise.resolve();const y=!J&&Rj(eb(L.fullPath,0))||(de||!J)&&history.state&&history.state.scroll||null;return sn().then(()=>$e(L,se,y)).then(_=>_&&xj(_)).catch(_=>Q(_,L,se))}const j=L=>r.go(L);let xe;const Et=new Set,me={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:g,getRoutes:m,resolve:w,options:t,push:E,replace:P,go:j,back:()=>j(-1),forward:()=>j(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:ie.add,isReady:Ce,install(L){const se=this;L.component("RouterLink",f4),L.component("RouterView",bA),L.config.globalProperties.$router=se,Object.defineProperty(L.config.globalProperties,"$route",{enumerable:!0,get:()=>Ae(l)}),vo&&!xe&&l.value===rr&&(xe=!0,E(r.location).catch($e=>{}));const J={};for(const $e in rr)J[$e]=I(()=>l.value[$e]);L.provide(Gd,se),L.provide(by,qn(J)),L.provide(Om,l);const de=L.unmount;Et.add(L),L.unmount=function(){Et.delete(L),Et.size<1&&(c=rr,X&&X(),X=null,l.value=rr,xe=!1,A=!1),de()}}};function pe(L){return L.reduce((se,J)=>se.then(()=>S(J)),Promise.resolve())}return me}function y4(t,e){const n=[],i=[],r=[],s=Math.max(e.matched.length,t.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(t.matched.find(c=>na(c,a))?i.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(c=>na(c,l))||r.push(l))}return[n,i,r]}function _4(){return Ft(Gd)}function w4(){return Ft(by)}const Pm={xs:18,sm:24,md:32,lg:38,xl:46},Qd={size:String};function Yd(t,e=Pm){return I(()=>t.size!==void 0?{fontSize:t.size in e?`${e[t.size]}px`:t.size}:null)}const Ze=t=>zh(rg(t)),Ey=t=>zh(t);function Lt(t,e){return t!==void 0&&t()||e}function EA(t,e){if(t!==void 0){const n=t();if(n!=null)return n.slice()}return e}function Eo(t,e){return t!==void 0?e.concat(t()):e}function IA(t,e){return t===void 0?e:e!==void 0?e.concat(t()):t()}function Mm(t,e,n,i,r,s){e.key=i+r;const o=M(t,e,n);return r===!0?Bo(o,s()):o}const pb="0 0 24 24",mb=t=>t,Kf=t=>`ionicons ${t}`,TA={"mdi-":t=>`mdi ${t}`,"icon-":mb,"bt-":t=>`bt ${t}`,"eva-":t=>`eva ${t}`,"ion-md":Kf,"ion-ios":Kf,"ion-logo":Kf,"iconfont ":mb,"ti-":t=>`themify-icon ${t}`,"bi-":t=>`bootstrap-icons ${t}`},SA={o_:"-outlined",r_:"-round",s_:"-sharp"},CA={sym_o_:"-outlined",sym_r_:"-rounded",sym_s_:"-sharp"},b4=new RegExp("^("+Object.keys(TA).join("|")+")"),E4=new RegExp("^("+Object.keys(SA).join("|")+")"),gb=new RegExp("^("+Object.keys(CA).join("|")+")"),I4=/^[Mm]\s?[-+]?\.?\d/,T4=/^img:/,S4=/^svguse:/,C4=/^ion-/,k4=/^(fa-(sharp|solid|regular|light|brands|duotone|thin)|[lf]a[srlbdk]?) /,ki=Ze({name:"QIcon",props:{...Qd,tag:{type:String,default:"i"},name:String,color:String,left:Boolean,right:Boolean},setup(t,{slots:e}){const{proxy:{$q:n}}=je(),i=Yd(t),r=I(()=>"q-icon"+(t.left===!0?" on-left":"")+(t.right===!0?" on-right":"")+(t.color!==void 0?` text-${t.color}`:"")),s=I(()=>{let o,a=t.name;if(a==="none"||!a)return{none:!0};if(n.iconMapFn!==null){const u=n.iconMapFn(a);if(u!==void 0)if(u.icon!==void 0){if(a=u.icon,a==="none"||!a)return{none:!0}}else return{cls:u.cls,content:u.content!==void 0?u.content:" "}}if(I4.test(a)===!0){const[u,h=pb]=a.split("|");return{svg:!0,viewBox:h,nodes:u.split("&&").map(d=>{const[f,p,m]=d.split("@@");return M("path",{style:p,d:f,transform:m})})}}if(T4.test(a)===!0)return{img:!0,src:a.substring(4)};if(S4.test(a)===!0){const[u,h=pb]=a.split("|");return{svguse:!0,src:u.substring(7),viewBox:h}}let l=" ";const c=a.match(b4);if(c!==null)o=TA[c[1]](a);else if(k4.test(a)===!0)o=a;else if(C4.test(a)===!0)o=`ionicons ion-${n.platform.is.ios===!0?"ios":"md"}${a.substring(3)}`;else if(gb.test(a)===!0){o="notranslate material-symbols";const u=a.match(gb);u!==null&&(a=a.substring(6),o+=CA[u[1]]),l=a}else{o="notranslate material-icons";const u=a.match(E4);u!==null&&(a=a.substring(2),o+=SA[u[1]]),l=a}return{cls:o,content:l}});return()=>{const o={class:r.value,style:i.value,"aria-hidden":"true",role:"presentation"};return s.value.none===!0?M(t.tag,o,Lt(e.default)):s.value.img===!0?M("span",o,Eo(e.default,[M("img",{src:s.value.src})])):s.value.svg===!0?M("span",o,Eo(e.default,[M("svg",{viewBox:s.value.viewBox||"0 0 24 24"},s.value.nodes)])):s.value.svguse===!0?M("span",o,Eo(e.default,[M("svg",{viewBox:s.value.viewBox},[M("use",{"xlink:href":s.value.src})])])):(s.value.cls!==void 0&&(o.class+=" "+s.value.cls),M(t.tag,o,Eo(e.default,[s.value.content])))}}}),x4={size:{type:[Number,String],default:"1em"},color:String};function A4(t){return{cSize:I(()=>t.size in Pm?`${Pm[t.size]}px`:t.size),classes:I(()=>"q-spinner"+(t.color?` text-${t.color}`:""))}}const Iy=Ze({name:"QSpinner",props:{...x4,thickness:{type:Number,default:5}},setup(t){const{cSize:e,classes:n}=A4(t);return()=>M("svg",{class:n.value+" q-spinner-mat",width:e.value,height:e.value,viewBox:"25 25 50 50"},[M("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"currentColor","stroke-width":t.thickness,"stroke-miterlimit":"10"})])}});function Lm(t,e){const n=t.style;for(const i in e)n[i]=e[i]}function R4(t){if(t==null)return;if(typeof t=="string")try{return document.querySelector(t)||void 0}catch{return}const e=Ae(t);if(e)return e.$el||e}function N4(t,e){if(t==null||t.contains(e)===!0)return!0;for(let n=t.nextElementSibling;n!==null;n=n.nextElementSibling)if(n.contains(e))return!0;return!1}const Ht={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{const t=Object.defineProperty({},"passive",{get(){Object.assign(Ht,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,t),window.removeEventListener("qtest",null,t)}catch{}function Fr(){}function D4(t){return t.button===0}function Dh(t){return t.touches&&t.touches[0]?t=t.touches[0]:t.changedTouches&&t.changedTouches[0]?t=t.changedTouches[0]:t.targetTouches&&t.targetTouches[0]&&(t=t.targetTouches[0]),{top:t.clientY,left:t.clientX}}function O4(t){if(t.path)return t.path;if(t.composedPath)return t.composedPath();const e=[];let n=t.target;for(;n;){if(e.push(n),n.tagName==="HTML")return e.push(document),e.push(window),e;n=n.parentElement}}function Er(t){t.stopPropagation()}function Jn(t){t.cancelable!==!1&&t.preventDefault()}function Rn(t){t.cancelable!==!1&&t.preventDefault(),t.stopPropagation()}function Wf(t,e){if(t===void 0||e===!0&&t.__dragPrevented===!0)return;const n=e===!0?i=>{i.__dragPrevented=!0,i.addEventListener("dragstart",Jn,Ht.notPassiveCapture)}:i=>{delete i.__dragPrevented,i.removeEventListener("dragstart",Jn,Ht.notPassiveCapture)};t.querySelectorAll("a, img").forEach(n)}function Ja(t,e,n){const i=`__q_${e}_evt`;t[i]=t[i]!==void 0?t[i].concat(n):n,n.forEach(r=>{r[0].addEventListener(r[1],t[r[2]],Ht[r[3]])})}function Fu(t,e){const n=`__q_${e}_evt`;t[n]!==void 0&&(t[n].forEach(i=>{i[0].removeEventListener(i[1],t[i[2]],Ht[i[3]])}),t[n]=void 0)}let kA=!1;function P4(t){kA=t.isComposing===!0}function xA(t){return kA===!0||t!==Object(t)||t.isComposing===!0||t.qKeyEvent===!0}function ra(t,e){return xA(t)===!0?!1:[].concat(e).includes(t.keyCode)}function M4(t,e=250){let n=!1,i;return function(){return n===!1&&(n=!0,setTimeout(()=>{n=!1},e),i=t.apply(this,arguments)),i}}function vb(t,e,n,i){n.modifiers.stop===!0&&Er(t);const r=n.modifiers.color;let s=n.modifiers.center;s=s===!0||i===!0;const o=document.createElement("span"),a=document.createElement("span"),l=Dh(t),{left:c,top:u,width:h,height:d}=e.getBoundingClientRect(),f=Math.sqrt(h*h+d*d),p=f/2,m=`${(h-f)/2}px`,g=s?m:`${l.left-c-p}px`,w=`${(d-f)/2}px`,v=s?w:`${l.top-u-p}px`;a.className="q-ripple__inner",Lm(a,{height:`${f}px`,width:`${f}px`,transform:`translate3d(${g},${v},0) scale3d(.2,.2,1)`,opacity:0}),o.className=`q-ripple${r?" text-"+r:""}`,o.setAttribute("dir","ltr"),o.appendChild(a),e.appendChild(o);const b=()=>{o.remove(),clearTimeout(E)};n.abort.push(b);let E=setTimeout(()=>{a.classList.add("q-ripple__inner--enter"),a.style.transform=`translate3d(${m},${w},0) scale3d(1,1,1)`,a.style.opacity=.2,E=setTimeout(()=>{a.classList.remove("q-ripple__inner--enter"),a.classList.add("q-ripple__inner--leave"),a.style.opacity=0,E=setTimeout(()=>{o.remove(),n.abort.splice(n.abort.indexOf(b),1)},275)},250)},50)}function yb(t,{modifiers:e,value:n,arg:i}){const r=Object.assign({},t.cfg.ripple,e,n);t.modifiers={early:r.early===!0,stop:r.stop===!0,center:r.center===!0,color:r.color||i,keyCodes:[].concat(r.keyCodes||13)}}const Ty=Ey({name:"ripple",beforeMount(t,e){const n=e.instance.$.appContext.config.globalProperties.$q.config||{};if(n.ripple===!1)return;const i={cfg:n,enabled:e.value!==!1,modifiers:{},abort:[],start(r){i.enabled===!0&&r.qSkipRipple!==!0&&r.type===(i.modifiers.early===!0?"pointerdown":"click")&&vb(r,t,i,r.qKeyEvent===!0)},keystart:M4(r=>{i.enabled===!0&&r.qSkipRipple!==!0&&ra(r,i.modifiers.keyCodes)===!0&&r.type===`key${i.modifiers.early===!0?"down":"up"}`&&vb(r,t,i,!0)},300)};yb(i,e),t.__qripple=i,Ja(i,"main",[[t,"pointerdown","start","passive"],[t,"click","start","passive"],[t,"keydown","keystart","passive"],[t,"keyup","keystart","passive"]])},updated(t,e){if(e.oldValue!==e.value){const n=t.__qripple;n!==void 0&&(n.enabled=e.value!==!1,n.enabled===!0&&Object(e.value)===e.value&&yb(n,e))}},beforeUnmount(t){const e=t.__qripple;e!==void 0&&(e.abort.forEach(n=>{n()}),Fu(e,"main"),delete t._qripple)}}),AA={left:"start",center:"center",right:"end",between:"between",around:"around",evenly:"evenly",stretch:"stretch"},L4=Object.keys(AA),RA={align:{type:String,validator:t=>L4.includes(t)}};function NA(t){return I(()=>{const e=t.align===void 0?t.vertical===!0?"stretch":"left":t.align;return`${t.vertical===!0?"items":"justify"}-${AA[e]}`})}function Bu(t){if(Object(t.$parent)===t.$parent)return t.$parent;let{parent:e}=t.$;for(;Object(e)===e;){if(Object(e.proxy)===e.proxy)return e.proxy;e=e.parent}}function DA(t,e){typeof e.type=="symbol"?Array.isArray(e.children)===!0&&e.children.forEach(n=>{DA(t,n)}):t.add(e)}function F4(t){const e=new Set;return t.forEach(n=>{DA(e,n)}),Array.from(e)}function OA(t){return t.appContext.config.globalProperties.$router!==void 0}function PA(t){return t.isUnmounted===!0||t.isDeactivated===!0}function _b(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}function wb(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function B4(t,e){for(const n in e){const i=e[n],r=t[n];if(typeof i=="string"){if(i!==r)return!1}else if(Array.isArray(r)===!1||r.length!==i.length||i.some((s,o)=>s!==r[o]))return!1}return!0}function bb(t,e){return Array.isArray(e)===!0?t.length===e.length&&t.every((n,i)=>n===e[i]):t.length===1&&t[0]===e}function $4(t,e){return Array.isArray(t)===!0?bb(t,e):Array.isArray(e)===!0?bb(e,t):t===e}function q4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if($4(t[n],e[n])===!1)return!1;return!0}const MA={to:[String,Object],replace:Boolean,exact:Boolean,activeClass:{type:String,default:"q-router-link--active"},exactActiveClass:{type:String,default:"q-router-link--exact-active"},href:String,target:String,disable:Boolean};function LA({fallbackTag:t,useDisableForRouterLinkProps:e=!0}={}){const n=je(),{props:i,proxy:r,emit:s}=n,o=OA(n),a=I(()=>i.disable!==!0&&i.href!==void 0),l=I(e===!0?()=>o===!0&&i.disable!==!0&&a.value!==!0&&i.to!==void 0&&i.to!==null&&i.to!=="":()=>o===!0&&a.value!==!0&&i.to!==void 0&&i.to!==null&&i.to!==""),c=I(()=>l.value===!0?v(i.to):null),u=I(()=>c.value!==null),h=I(()=>a.value===!0||u.value===!0),d=I(()=>i.type==="a"||h.value===!0?"a":i.tag||t||"div"),f=I(()=>a.value===!0?{href:i.href,target:i.target}:u.value===!0?{href:c.value.href,target:i.target}:{}),p=I(()=>{if(u.value===!1)return-1;const{matched:P}=c.value,{length:C}=P,B=P[C-1];if(B===void 0)return-1;const N=r.$route.matched;if(N.length===0)return-1;const S=N.findIndex(wb.bind(null,B));if(S>-1)return S;const k=_b(P[C-2]);return C>1&&_b(B)===k&&N[N.length-1].path!==k?N.findIndex(wb.bind(null,P[C-2])):S}),m=I(()=>u.value===!0&&p.value!==-1&&B4(r.$route.params,c.value.params)),g=I(()=>m.value===!0&&p.value===r.$route.matched.length-1&&q4(r.$route.params,c.value.params)),w=I(()=>u.value===!0?g.value===!0?` ${i.exactActiveClass} ${i.activeClass}`:i.exact===!0?"":m.value===!0?` ${i.activeClass}`:"":"");function v(P){try{return r.$router.resolve(P)}catch{}return null}function b(P,{returnRouterError:C,to:B=i.to,replace:N=i.replace}={}){if(i.disable===!0)return P.preventDefault(),Promise.resolve(!1);if(P.metaKey||P.altKey||P.ctrlKey||P.shiftKey||P.button!==void 0&&P.button!==0||i.target==="_blank")return Promise.resolve(!1);P.preventDefault();const S=r.$router[N===!0?"replace":"push"](B);return C===!0?S:S.then(()=>{}).catch(()=>{})}function E(P){if(u.value===!0){const C=B=>b(P,B);s("click",P,C),P.defaultPrevented!==!0&&C()}else s("click",P)}return{hasRouterLink:u,hasHrefLink:a,hasLink:h,linkTag:d,resolvedLink:c,linkIsActive:m,linkIsExactActive:g,linkClass:w,linkAttrs:f,getLink:v,navigateToRouterLink:b,navigateOnClick:E}}const Eb={none:0,xs:4,sm:8,md:16,lg:24,xl:32},U4={xs:8,sm:10,md:14,lg:20,xl:24},V4=["button","submit","reset"],z4=/[^\s]\/[^\s]/,j4=["flat","outline","push","unelevated"],H4=(t,e)=>t.flat===!0?"flat":t.outline===!0?"outline":t.push===!0?"push":t.unelevated===!0?"unelevated":e,K4={...Qd,...MA,type:{type:String,default:"button"},label:[Number,String],icon:String,iconRight:String,...j4.reduce((t,e)=>(t[e]=Boolean)&&t,{}),square:Boolean,round:Boolean,rounded:Boolean,glossy:Boolean,size:String,fab:Boolean,fabMini:Boolean,padding:String,color:String,textColor:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,tabindex:[Number,String],ripple:{type:[Boolean,Object],default:!0},align:{...RA.align,default:"center"},stack:Boolean,stretch:Boolean,loading:{type:Boolean,default:null},disable:Boolean};function W4(t){const e=Yd(t,U4),n=NA(t),{hasRouterLink:i,hasLink:r,linkTag:s,linkAttrs:o,navigateOnClick:a}=LA({fallbackTag:"button"}),l=I(()=>{const g=t.fab===!1&&t.fabMini===!1?e.value:{};return t.padding!==void 0?Object.assign({},g,{padding:t.padding.split(/\s+/).map(w=>w in Eb?Eb[w]+"px":w).join(" "),minWidth:"0",minHeight:"0"}):g}),c=I(()=>t.rounded===!0||t.fab===!0||t.fabMini===!0),u=I(()=>t.disable!==!0&&t.loading!==!0),h=I(()=>u.value===!0?t.tabindex||0:-1),d=I(()=>H4(t,"standard")),f=I(()=>{const g={tabindex:h.value};return r.value===!0?Object.assign(g,o.value):V4.includes(t.type)===!0&&(g.type=t.type),s.value==="a"?(t.disable===!0?g["aria-disabled"]="true":g.href===void 0&&(g.role="button"),i.value!==!0&&z4.test(t.type)===!0&&(g.type=t.type)):t.disable===!0&&(g.disabled="",g["aria-disabled"]="true"),t.loading===!0&&t.percentage!==void 0&&Object.assign(g,{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t.percentage}),g}),p=I(()=>{let g;t.color!==void 0?t.flat===!0||t.outline===!0?g=`text-${t.textColor||t.color}`:g=`bg-${t.color} text-${t.textColor||"white"}`:t.textColor&&(g=`text-${t.textColor}`);const w=t.round===!0?"round":`rectangle${c.value===!0?" q-btn--rounded":t.square===!0?" q-btn--square":""}`;return`q-btn--${d.value} q-btn--${w}`+(g!==void 0?" "+g:"")+(u.value===!0?" q-btn--actionable q-focusable q-hoverable":t.disable===!0?" disabled":"")+(t.fab===!0?" q-btn--fab":t.fabMini===!0?" q-btn--fab-mini":"")+(t.noCaps===!0?" q-btn--no-uppercase":"")+(t.dense===!0?" q-btn--dense":"")+(t.stretch===!0?" no-border-radius self-stretch":"")+(t.glossy===!0?" glossy":"")+(t.square?" q-btn--square":"")}),m=I(()=>n.value+(t.stack===!0?" column":" row")+(t.noWrap===!0?" no-wrap text-no-wrap":"")+(t.loading===!0?" q-btn__content--hidden":""));return{classes:p,style:l,innerClasses:m,attributes:f,hasLink:r,linkTag:s,navigateOnClick:a,isActionable:u}}const{passiveCapture:Bn}=Ht;let co=null,uo=null,ho=null;const es=Ze({name:"QBtn",props:{...K4,percentage:Number,darkPercentage:Boolean,onTouchstart:[Function,Array]},emits:["click","keydown","mousedown","keyup"],setup(t,{slots:e,emit:n}){const{proxy:i}=je(),{classes:r,style:s,innerClasses:o,attributes:a,hasLink:l,linkTag:c,navigateOnClick:u,isActionable:h}=W4(t),d=ae(null),f=ae(null);let p=null,m,g=null;const w=I(()=>t.label!==void 0&&t.label!==null&&t.label!==""),v=I(()=>t.disable===!0||t.ripple===!1?!1:{keyCodes:l.value===!0?[13,32]:[13],...t.ripple===!0?{}:t.ripple}),b=I(()=>({center:t.round})),E=I(()=>{const $=Math.max(0,Math.min(100,t.percentage));return $>0?{transition:"transform 0.6s",transform:`translateX(${$-100}%)`}:{}}),P=I(()=>{if(t.loading===!0)return{onMousedown:X,onTouchstart:X,onClick:X,onKeydown:X,onKeyup:X};if(h.value===!0){const $={onClick:B,onKeydown:N,onMousedown:k};if(i.$q.platform.has.touch===!0){const le=t.onTouchstart!==void 0?"":"Passive";$[`onTouchstart${le}`]=S}return $}return{onClick:Rn}}),C=I(()=>({ref:d,class:"q-btn q-btn-item non-selectable no-outline "+r.value,style:s.value,...a.value,...P.value}));function B($){if(d.value!==null){if($!==void 0){if($.defaultPrevented===!0)return;const le=document.activeElement;if(t.type==="submit"&&le!==document.body&&d.value.contains(le)===!1&&le.contains(d.value)===!1){d.value.focus();const ie=()=>{document.removeEventListener("keydown",Rn,!0),document.removeEventListener("keyup",ie,Bn),d.value!==null&&d.value.removeEventListener("blur",ie,Bn)};document.addEventListener("keydown",Rn,!0),document.addEventListener("keyup",ie,Bn),d.value.addEventListener("blur",ie,Bn)}}u($)}}function N($){d.value!==null&&(n("keydown",$),ra($,[13,32])===!0&&uo!==d.value&&(uo!==null&&R(),$.defaultPrevented!==!0&&(d.value.focus(),uo=d.value,d.value.classList.add("q-btn--active"),document.addEventListener("keyup",V,!0),d.value.addEventListener("blur",V,Bn)),Rn($)))}function S($){d.value!==null&&(n("touchstart",$),$.defaultPrevented!==!0&&(co!==d.value&&(co!==null&&R(),co=d.value,p=$.target,p.addEventListener("touchcancel",V,Bn),p.addEventListener("touchend",V,Bn)),m=!0,g!==null&&clearTimeout(g),g=setTimeout(()=>{g=null,m=!1},200)))}function k($){d.value!==null&&($.qSkipRipple=m===!0,n("mousedown",$),$.defaultPrevented!==!0&&ho!==d.value&&(ho!==null&&R(),ho=d.value,d.value.classList.add("q-btn--active"),document.addEventListener("mouseup",V,Bn)))}function V($){if(d.value!==null&&!($!==void 0&&$.type==="blur"&&document.activeElement===d.value)){if($!==void 0&&$.type==="keyup"){if(uo===d.value&&ra($,[13,32])===!0){const le=new MouseEvent("click",$);le.qKeyEvent=!0,$.defaultPrevented===!0&&Jn(le),$.cancelBubble===!0&&Er(le),d.value.dispatchEvent(le),Rn($),$.qKeyEvent=!0}n("keyup",$)}R()}}function R($){const le=f.value;$!==!0&&(co===d.value||ho===d.value)&&le!==null&&le!==document.activeElement&&(le.setAttribute("tabindex",-1),le.focus()),co===d.value&&(p!==null&&(p.removeEventListener("touchcancel",V,Bn),p.removeEventListener("touchend",V,Bn)),co=p=null),ho===d.value&&(document.removeEventListener("mouseup",V,Bn),ho=null),uo===d.value&&(document.removeEventListener("keyup",V,!0),d.value!==null&&d.value.removeEventListener("blur",V,Bn),uo=null),d.value!==null&&d.value.classList.remove("q-btn--active")}function X($){Rn($),$.qSkipRipple=!0}return Xt(()=>{R(!0)}),Object.assign(i,{click:B}),()=>{let $=[];t.icon!==void 0&&$.push(M(ki,{name:t.icon,left:t.stack===!1&&w.value===!0,role:"img","aria-hidden":"true"})),w.value===!0&&$.push(M("span",{class:"block"},[t.label])),$=Eo(e.default,$),t.iconRight!==void 0&&t.round===!1&&$.push(M(ki,{name:t.iconRight,right:t.stack===!1&&w.value===!0,role:"img","aria-hidden":"true"}));const le=[M("span",{class:"q-focus-helper",ref:f})];return t.loading===!0&&t.percentage!==void 0&&le.push(M("span",{class:"q-btn__progress absolute-full overflow-hidden"+(t.darkPercentage===!0?" q-btn__progress--dark":"")},[M("span",{class:"q-btn__progress-indicator fit block",style:E.value})])),le.push(M("span",{class:"q-btn__content text-center col items-center q-anchor--skip "+o.value},$)),t.loading!==null&&le.push(M(Cs,{name:"q-transition--fade"},()=>t.loading===!0?[M("span",{key:"loading",class:"absolute-full flex flex-center"},e.loading!==void 0?e.loading():[M(Iy)])]:null)),Bo(M(c.value,C.value,le),[[Ty,v.value,void 0,b.value]])}}}),Sy=Ze({name:"QAvatar",props:{...Qd,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(t,{slots:e}){const n=Yd(t),i=I(()=>"q-avatar"+(t.color?` bg-${t.color}`:"")+(t.textColor?` text-${t.textColor} q-chip--colored`:"")+(t.square===!0?" q-avatar--square":t.rounded===!0?" rounded-borders":"")),r=I(()=>t.fontSize?{fontSize:t.fontSize}:null);return()=>{const s=t.icon!==void 0?[M(ki,{name:t.icon})]:void 0;return M("div",{class:i.value,style:n.value},[M("div",{class:"q-avatar__content row flex-center overflow-hidden",style:r.value},IA(e.default,s))])}}}),G4=Ze({name:"QToolbarTitle",props:{shrink:Boolean},setup(t,{slots:e}){const n=I(()=>"q-toolbar__title ellipsis"+(t.shrink===!0?" col-shrink":""));return()=>M("div",{class:n.value},Lt(e.default))}}),Q4=Ze({name:"QToolbar",props:{inset:Boolean},setup(t,{slots:e}){const n=I(()=>"q-toolbar row no-wrap items-center"+(t.inset===!0?" q-toolbar--inset":""));return()=>M("div",{class:n.value,role:"toolbar"},Lt(e.default))}});function eo(t,e,n,i){return Object.defineProperty(t,e,{get:n,set:i,enumerable:!0}),t}const Di=ae(!1);let Xd;function Y4(t,e){const n=/(edg|edge|edga|edgios)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(vivaldi)[\/]([\w.]+)/.exec(t)||/(chrome|crios)[\/]([\w.]+)/.exec(t)||/(version)(applewebkit)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+).*(version)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(firefox|fxios)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[\/]([\w.]+)/.exec(t)||[];return{browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",versionNumber:n[4]||n[2]||"0",platform:e[0]||""}}function X4(t){return/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(silk)/.exec(t)||/(android)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||/(playbook)/.exec(t)||/(bb)/.exec(t)||/(blackberry)/.exec(t)||[]}const FA="ontouchstart"in window||window.navigator.maxTouchPoints>0;function J4(t){Xd={is:{...t}},delete t.mac,delete t.desktop;const e=Math.min(window.innerHeight,window.innerWidth)>414?"ipad":"iphone";Object.assign(t,{mobile:!0,ios:!0,platform:e,[e]:!0})}function Z4(t){const e=t.toLowerCase(),n=X4(e),i=Y4(e,n),r={};i.browser&&(r[i.browser]=!0,r.version=i.version,r.versionNumber=parseInt(i.versionNumber,10)),i.platform&&(r[i.platform]=!0);const s=r.android||r.ios||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"];return s===!0||e.indexOf("mobile")>-1?(r.mobile=!0,r.edga||r.edgios?(r.edge=!0,i.browser="edge"):r.crios?(r.chrome=!0,i.browser="chrome"):r.fxios&&(r.firefox=!0,i.browser="firefox")):r.desktop=!0,(r.ipod||r.ipad||r.iphone)&&(r.ios=!0),r["windows phone"]&&(r.winphone=!0,delete r["windows phone"]),(r.chrome||r.opr||r.safari||r.vivaldi||r.mobile===!0&&r.ios!==!0&&s!==!0)&&(r.webkit=!0),r.edg&&(i.browser="edgechromium",r.edgeChromium=!0),(r.safari&&r.blackberry||r.bb)&&(i.browser="blackberry",r.blackberry=!0),r.safari&&r.playbook&&(i.browser="playbook",r.playbook=!0),r.opr&&(i.browser="opera",r.opera=!0),r.safari&&r.android&&(i.browser="android",r.android=!0),r.safari&&r.kindle&&(i.browser="kindle",r.kindle=!0),r.safari&&r.silk&&(i.browser="silk",r.silk=!0),r.vivaldi&&(i.browser="vivaldi",r.vivaldi=!0),r.name=i.browser,r.platform=i.platform,e.indexOf("electron")>-1?r.electron=!0:document.location.href.indexOf("-extension://")>-1?r.bex=!0:(window.Capacitor!==void 0?(r.capacitor=!0,r.nativeMobile=!0,r.nativeMobileWrapper="capacitor"):(window._cordovaNative!==void 0||window.cordova!==void 0)&&(r.cordova=!0,r.nativeMobile=!0,r.nativeMobileWrapper="cordova"),FA===!0&&r.mac===!0&&(r.desktop===!0&&r.safari===!0||r.nativeMobile===!0&&r.android!==!0&&r.ios!==!0&&r.ipad!==!0)&&J4(r)),r}const Ib=navigator.userAgent||navigator.vendor||window.opera,eH={has:{touch:!1,webStorage:!1},within:{iframe:!1}},Je={userAgent:Ib,is:Z4(Ib),has:{touch:FA},within:{iframe:window.self!==window.top}},Oh={install(t){const{$q:e}=t;Di.value===!0?(t.onSSRHydrated.push(()=>{Object.assign(e.platform,Je),Di.value=!1,Xd=void 0}),e.platform=qn(this)):e.platform=this}};{let t;eo(Je.has,"webStorage",()=>{if(t!==void 0)return t;try{if(window.localStorage)return t=!0,!0}catch{}return t=!1,!1}),Je.is.ios===!0&&window.navigator.vendor.toLowerCase().indexOf("apple"),Di.value===!0?Object.assign(Oh,Je,Xd,eH):Object.assign(Oh,Je)}function tH(){const t=ae(!Di.value);return t.value===!1&&Hn(()=>{t.value=!0}),t}const BA=typeof ResizeObserver<"u",Tb=BA===!0?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"},Fm=Ze({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(t,{emit:e}){let n=null,i,r={width:-1,height:-1};function s(l){l===!0||t.debounce===0||t.debounce==="0"?o():n===null&&(n=setTimeout(o,t.debounce))}function o(){if(n!==null&&(clearTimeout(n),n=null),i){const{offsetWidth:l,offsetHeight:c}=i;(l!==r.width||c!==r.height)&&(r={width:l,height:c},e("resize",r))}}const{proxy:a}=je();if(BA===!0){let l;const c=u=>{i=a.$el.parentNode,i?(l=new ResizeObserver(s),l.observe(i),o()):u!==!0&&sn(()=>{c(!0)})};return Hn(()=>{c()}),Xt(()=>{n!==null&&clearTimeout(n),l!==void 0&&(l.disconnect!==void 0?l.disconnect():i&&l.unobserve(i))}),Fr}else{let u=function(){n!==null&&(clearTimeout(n),n=null),c!==void 0&&(c.removeEventListener!==void 0&&c.removeEventListener("resize",s,Ht.passive),c=void 0)},h=function(){u(),i&&i.contentDocument&&(c=i.contentDocument.defaultView,c.addEventListener("resize",s,Ht.passive),o())};const l=tH();let c;return Hn(()=>{sn(()=>{i=a.$el,i&&h()})}),Xt(u),a.trigger=s,()=>{if(l.value===!0)return M("object",{style:Tb.style,tabindex:-1,type:"text/html",data:Tb.url,"aria-hidden":"true",onLoad:h})}}}}),nH="_q_",$c="_q_l_",iH="_q_pc_",rH="_q_fo_",jn=()=>{},sH=Ze({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=je(),r=Ft($c,jn);if(r===jn)return console.error("QHeader needs to be child of QLayout"),jn;const s=ae(parseInt(t.heightHint,10)),o=ae(!0),a=I(()=>t.reveal===!0||r.view.value.indexOf("H")>-1||i.platform.is.ios&&r.isContainer.value===!0),l=I(()=>{if(t.modelValue!==!0)return 0;if(a.value===!0)return o.value===!0?s.value:0;const v=s.value-r.scroll.value.position;return v>0?v:0}),c=I(()=>t.modelValue!==!0||a.value===!0&&o.value!==!0),u=I(()=>t.modelValue===!0&&c.value===!0&&t.reveal===!0),h=I(()=>"q-header q-layout__section--marginal "+(a.value===!0?"fixed":"absolute")+"-top"+(t.bordered===!0?" q-header--bordered":"")+(c.value===!0?" q-header--hidden":"")+(t.modelValue!==!0?" q-layout--prevent-focus":"")),d=I(()=>{const v=r.rows.value.top,b={};return v[0]==="l"&&r.left.space===!0&&(b[i.lang.rtl===!0?"right":"left"]=`${r.left.size}px`),v[2]==="r"&&r.right.space===!0&&(b[i.lang.rtl===!0?"left":"right"]=`${r.right.size}px`),b});function f(v,b){r.update("header",v,b)}function p(v,b){v.value!==b&&(v.value=b)}function m({height:v}){p(s,v),f("size",v)}function g(v){u.value===!0&&p(o,!0),n("focusin",v)}ge(()=>t.modelValue,v=>{f("space",v),p(o,!0),r.animate()}),ge(l,v=>{f("offset",v)}),ge(()=>t.reveal,v=>{v===!1&&p(o,t.modelValue)}),ge(o,v=>{r.animate(),n("reveal",v)}),ge(r.scroll,v=>{t.reveal===!0&&p(o,v.direction==="up"||v.position<=t.revealOffset||v.position-v.inflectionPoint<100)});const w={};return r.instances.header=w,t.modelValue===!0&&f("size",s.value),f("space",t.modelValue),f("offset",l.value),Xt(()=>{r.instances.header===w&&(r.instances.header=void 0,f("size",0),f("offset",0),f("space",!1))}),()=>{const v=EA(e.default,[]);return t.elevated===!0&&v.push(M("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),v.push(M(Fm,{debounce:0,onResize:m})),M("header",{class:h.value,style:d.value,onFocusin:g},v)}}}),to={dark:{type:Boolean,default:null}};function no(t,e){return I(()=>t.dark===null?e.dark.isActive:t.dark)}const oH=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],aH=["wave","pulse","pulse-x","pulse-y","fade","blink","none"],Va=Ze({name:"QSkeleton",props:{...to,tag:{type:String,default:"div"},type:{type:String,validator:t=>oH.includes(t),default:"rect"},animation:{type:String,validator:t=>aH.includes(t),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(t,{slots:e}){const n=je(),i=no(t,n.proxy.$q),r=I(()=>{const o=t.size!==void 0?[t.size,t.size]:[t.width,t.height];return{"--q-skeleton-speed":`${t.animationSpeed}ms`,width:o[0],height:o[1]}}),s=I(()=>`q-skeleton q-skeleton--${i.value===!0?"dark":"light"} q-skeleton--type-${t.type}`+(t.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${t.animation}`:"")+(t.square===!0?" q-skeleton--square":"")+(t.bordered===!0?" q-skeleton--bordered":""));return()=>M(t.tag,{class:s.value,style:r.value},Lt(e.default))}}),lH={true:"inset",item:"item-inset","item-thumbnail":"item-thumbnail-inset"},Gf={xs:2,sm:4,md:8,lg:16,xl:24},fu=Ze({name:"QSeparator",props:{...to,spaced:[Boolean,String],inset:[Boolean,String],vertical:Boolean,color:String,size:String},setup(t){const e=je(),n=no(t,e.proxy.$q),i=I(()=>t.vertical===!0?"vertical":"horizontal"),r=I(()=>` q-separator--${i.value}`),s=I(()=>t.inset!==!1?`${r.value}-${lH[t.inset]}`:""),o=I(()=>`q-separator${r.value}${s.value}`+(t.color!==void 0?` bg-${t.color}`:"")+(n.value===!0?" q-separator--dark":"")),a=I(()=>{const l={};if(t.size!==void 0&&(l[t.vertical===!0?"width":"height"]=t.size),t.spaced!==!1){const c=t.spaced===!0?`${Gf.md}px`:t.spaced in Gf?`${Gf[t.spaced]}px`:t.spaced,u=t.vertical===!0?["Left","Right"]:["Top","Bottom"];l[`margin${u[0]}`]=l[`margin${u[1]}`]=c}return l});return()=>M("hr",{class:o.value,style:a.value,"aria-orientation":i.value})}}),cH={position:{type:String,default:"bottom-right",validator:t=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(t)},offset:{type:Array,validator:t=>t.length===2},expand:Boolean};function uH(){const{props:t,proxy:{$q:e}}=je(),n=Ft($c,jn);if(n===jn)return console.error("QPageSticky needs to be child of QLayout"),jn;const i=I(()=>{const h=t.position;return{top:h.indexOf("top")>-1,right:h.indexOf("right")>-1,bottom:h.indexOf("bottom")>-1,left:h.indexOf("left")>-1,vertical:h==="top"||h==="bottom",horizontal:h==="left"||h==="right"}}),r=I(()=>n.header.offset),s=I(()=>n.right.offset),o=I(()=>n.footer.offset),a=I(()=>n.left.offset),l=I(()=>{let h=0,d=0;const f=i.value,p=e.lang.rtl===!0?-1:1;f.top===!0&&r.value!==0?d=`${r.value}px`:f.bottom===!0&&o.value!==0&&(d=`${-o.value}px`),f.left===!0&&a.value!==0?h=`${p*a.value}px`:f.right===!0&&s.value!==0&&(h=`${-p*s.value}px`);const m={transform:`translate(${h}, ${d})`};return t.offset&&(m.margin=`${t.offset[1]}px ${t.offset[0]}px`),f.vertical===!0?(a.value!==0&&(m[e.lang.rtl===!0?"right":"left"]=`${a.value}px`),s.value!==0&&(m[e.lang.rtl===!0?"left":"right"]=`${s.value}px`)):f.horizontal===!0&&(r.value!==0&&(m.top=`${r.value}px`),o.value!==0&&(m.bottom=`${o.value}px`)),m}),c=I(()=>`q-page-sticky row flex-center fixed-${t.position} q-page-sticky--${t.expand===!0?"expand":"shrink"}`);function u(h){const d=Lt(h.default);return M("div",{class:c.value,style:l.value},t.expand===!0?d:[M("div",d)])}return{$layout:n,getStickyContent:u}}const hH=Ze({name:"QPageSticky",props:cH,setup(t,{slots:e}){const{getStickyContent:n}=uH();return()=>n(e)}}),Sb=Ze({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(t,{slots:e}){const n=I(()=>`q-card__section q-card__section--${t.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>M(t.tag,{class:n.value},Lt(e.default))}});function dH({validate:t,resetValidation:e,requiresQForm:n}){const i=Ft(rH,!1);if(i!==!1){const{props:r,proxy:s}=je();Object.assign(s,{validate:t,resetValidation:e}),ge(()=>r.disable,o=>{o===!0?(typeof e=="function"&&e(),i.unbindComponent(s)):i.bindComponent(s)}),Hn(()=>{r.disable!==!0&&i.bindComponent(s)}),Xt(()=>{r.disable!==!0&&i.unbindComponent(s)})}else n===!0&&console.error("Parent QForm not found on useFormChild()!")}const Cb=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,kb=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,xb=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,pu=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,mu=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,Qf={date:t=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(t),time:t=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(t),fulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(t),timeOrFulltime:t=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(t),email:t=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),hexColor:t=>Cb.test(t),hexaColor:t=>kb.test(t),hexOrHexaColor:t=>xb.test(t),rgbColor:t=>pu.test(t),rgbaColor:t=>mu.test(t),rgbOrRgbaColor:t=>pu.test(t)||mu.test(t),hexOrRgbColor:t=>Cb.test(t)||pu.test(t),hexaOrRgbaColor:t=>kb.test(t)||mu.test(t),anyColor:t=>xb.test(t)||pu.test(t)||mu.test(t)};function $A(t,e=250,n){let i=null;function r(){const s=arguments,o=()=>{i=null,n!==!0&&t.apply(this,s)};i!==null?clearTimeout(i):n===!0&&t.apply(this,s),i=setTimeout(o,e)}return r.cancel=()=>{i!==null&&clearTimeout(i)},r}const fH=[!0,!1,"ondemand"],pH={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],validator:t=>fH.includes(t)}};function mH(t,e){const{props:n,proxy:i}=je(),r=ae(!1),s=ae(null),o=ae(null);dH({validate:p,resetValidation:f});let a=0,l;const c=I(()=>n.rules!==void 0&&n.rules!==null&&n.rules.length!==0),u=I(()=>n.disable!==!0&&c.value===!0),h=I(()=>n.error===!0||r.value===!0),d=I(()=>typeof n.errorMessage=="string"&&n.errorMessage.length!==0?n.errorMessage:s.value);ge(()=>n.modelValue,()=>{m()}),ge(()=>n.reactiveRules,w=>{w===!0?l===void 0&&(l=ge(()=>n.rules,()=>{m(!0)})):l!==void 0&&(l(),l=void 0)},{immediate:!0}),ge(t,w=>{w===!0?o.value===null&&(o.value=!1):o.value===!1&&(o.value=!0,u.value===!0&&n.lazyRules!=="ondemand"&&e.value===!1&&g())});function f(){a++,e.value=!1,o.value=null,r.value=!1,s.value=null,g.cancel()}function p(w=n.modelValue){if(u.value!==!0)return!0;const v=++a,b=e.value!==!0?()=>{o.value=!0}:()=>{},E=(C,B)=>{C===!0&&b(),r.value=C,s.value=B||null,e.value=!1},P=[];for(let C=0;C<n.rules.length;C++){const B=n.rules[C];let N;if(typeof B=="function"?N=B(w,Qf):typeof B=="string"&&Qf[B]!==void 0&&(N=Qf[B](w)),N===!1||typeof N=="string")return E(!0,N),!1;N!==!0&&N!==void 0&&P.push(N)}return P.length===0?(E(!1),!0):(e.value=!0,Promise.all(P).then(C=>{if(C===void 0||Array.isArray(C)===!1||C.length===0)return v===a&&E(!1),!0;const B=C.find(N=>N===!1||typeof N=="string");return v===a&&E(B!==void 0,B),B===void 0},C=>(v===a&&(console.error(C),E(!0)),!1)))}function m(w){u.value===!0&&n.lazyRules!=="ondemand"&&(o.value===!0||n.lazyRules!==!0&&w!==!0)&&g()}const g=$A(p,0);return Xt(()=>{l!==void 0&&l(),g.cancel()}),Object.assign(i,{resetValidation:f,validate:p}),eo(i,"hasError",()=>h.value),{isDirtyModel:o,hasRules:c,hasError:h,errorMessage:d,validate:p,resetValidation:f}}const Ab=/^on[A-Z]/;function gH(t,e){const n={listeners:ae({}),attributes:ae({})};function i(){const r={},s={};for(const o in t)o!=="class"&&o!=="style"&&Ab.test(o)===!1&&(r[o]=t[o]);for(const o in e.props)Ab.test(o)===!0&&(s[o]=e.props[o]);n.attributes.value=r,n.listeners.value=s}return zE(i),i(),n}let Yf,gu=0;const zt=new Array(256);for(let t=0;t<256;t++)zt[t]=(t+256).toString(16).substring(1);const vH=(()=>{const t=typeof crypto<"u"?crypto:typeof window<"u"?window.crypto||window.msCrypto:void 0;if(t!==void 0){if(t.randomBytes!==void 0)return t.randomBytes;if(t.getRandomValues!==void 0)return e=>{const n=new Uint8Array(e);return t.getRandomValues(n),n}}return e=>{const n=[];for(let i=e;i>0;i--)n.push(Math.floor(Math.random()*256));return n}})(),Rb=4096;function yH(){(Yf===void 0||gu+16>Rb)&&(gu=0,Yf=vH(Rb));const t=Array.prototype.slice.call(Yf,gu,gu+=16);return t[6]=t[6]&15|64,t[8]=t[8]&63|128,zt[t[0]]+zt[t[1]]+zt[t[2]]+zt[t[3]]+"-"+zt[t[4]]+zt[t[5]]+"-"+zt[t[6]]+zt[t[7]]+"-"+zt[t[8]]+zt[t[9]]+"-"+zt[t[10]]+zt[t[11]]+zt[t[12]]+zt[t[13]]+zt[t[14]]+zt[t[15]]}let ps=[],Zl=[];function qA(t){Zl=Zl.filter(e=>e!==t)}function _H(t){qA(t),Zl.push(t)}function Nb(t){qA(t),Zl.length===0&&ps.length!==0&&(ps[ps.length-1](),ps=[])}function Cy(t){Zl.length===0?t():ps.push(t)}function wH(t){ps=ps.filter(e=>e!==t)}function Bm(t){return t===void 0?`f_${yH()}`:t}function ec(t){return t!=null&&(""+t).length!==0}const UA={...to,...pH,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String,maxlength:[Number,String]},VA=["update:modelValue","clear","focus","blur","popupShow","popupHide"];function zA(){const{props:t,attrs:e,proxy:n,vnode:i}=je();return{isDark:no(t,n.$q),editable:I(()=>t.disable!==!0&&t.readonly!==!0),innerLoading:ae(!1),focused:ae(!1),hasPopupOpen:!1,splitAttrs:gH(e,i),targetUid:ae(Bm(t.for)),rootRef:ae(null),targetRef:ae(null),controlRef:ae(null)}}function jA(t){const{props:e,emit:n,slots:i,attrs:r,proxy:s}=je(),{$q:o}=s;let a=null;t.hasValue===void 0&&(t.hasValue=I(()=>ec(e.modelValue))),t.emitValue===void 0&&(t.emitValue=A=>{n("update:modelValue",A)}),t.controlEvents===void 0&&(t.controlEvents={onFocusin:S,onFocusout:k}),Object.assign(t,{clearValue:V,onControlFocusin:S,onControlFocusout:k,focus:B}),t.computedCounter===void 0&&(t.computedCounter=I(()=>{if(e.counter!==!1){const A=typeof e.modelValue=="string"||typeof e.modelValue=="number"?(""+e.modelValue).length:Array.isArray(e.modelValue)===!0?e.modelValue.length:0,Q=e.maxlength!==void 0?e.maxlength:e.maxValues;return A+(Q!==void 0?" / "+Q:"")}}));const{isDirtyModel:l,hasRules:c,hasError:u,errorMessage:h,resetValidation:d}=mH(t.focused,t.innerLoading),f=t.floatingLabel!==void 0?I(()=>e.stackLabel===!0||t.focused.value===!0||t.floatingLabel.value===!0):I(()=>e.stackLabel===!0||t.focused.value===!0||t.hasValue.value===!0),p=I(()=>e.bottomSlots===!0||e.hint!==void 0||c.value===!0||e.counter===!0||e.error!==null),m=I(()=>e.filled===!0?"filled":e.outlined===!0?"outlined":e.borderless===!0?"borderless":e.standout?"standout":"standard"),g=I(()=>`q-field row no-wrap items-start q-field--${m.value}`+(t.fieldClass!==void 0?` ${t.fieldClass.value}`:"")+(e.rounded===!0?" q-field--rounded":"")+(e.square===!0?" q-field--square":"")+(f.value===!0?" q-field--float":"")+(v.value===!0?" q-field--labeled":"")+(e.dense===!0?" q-field--dense":"")+(e.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(t.isDark.value===!0?" q-field--dark":"")+(t.getControl===void 0?" q-field--auto-height":"")+(t.focused.value===!0?" q-field--focused":"")+(u.value===!0?" q-field--error":"")+(u.value===!0||t.focused.value===!0?" q-field--highlighted":"")+(e.hideBottomSpace!==!0&&p.value===!0?" q-field--with-bottom":"")+(e.disable===!0?" q-field--disabled":e.readonly===!0?" q-field--readonly":"")),w=I(()=>"q-field__control relative-position row no-wrap"+(e.bgColor!==void 0?` bg-${e.bgColor}`:"")+(u.value===!0?" text-negative":typeof e.standout=="string"&&e.standout.length!==0&&t.focused.value===!0?` ${e.standout}`:e.color!==void 0?` text-${e.color}`:"")),v=I(()=>e.labelSlot===!0||e.label!==void 0),b=I(()=>"q-field__label no-pointer-events absolute ellipsis"+(e.labelColor!==void 0&&u.value!==!0?` text-${e.labelColor}`:"")),E=I(()=>({id:t.targetUid.value,editable:t.editable.value,focused:t.focused.value,floatingLabel:f.value,modelValue:e.modelValue,emitValue:t.emitValue})),P=I(()=>{const A={for:t.targetUid.value};return e.disable===!0?A["aria-disabled"]="true":e.readonly===!0&&(A["aria-readonly"]="true"),A});ge(()=>e.for,A=>{t.targetUid.value=Bm(A)});function C(){const A=document.activeElement;let Q=t.targetRef!==void 0&&t.targetRef.value;Q&&(A===null||A.id!==t.targetUid.value)&&(Q.hasAttribute("tabindex")===!0||(Q=Q.querySelector("[tabindex]")),Q&&Q!==A&&Q.focus({preventScroll:!0}))}function B(){Cy(C)}function N(){wH(C);const A=document.activeElement;A!==null&&t.rootRef.value.contains(A)&&A.blur()}function S(A){a!==null&&(clearTimeout(a),a=null),t.editable.value===!0&&t.focused.value===!1&&(t.focused.value=!0,n("focus",A))}function k(A,Q){a!==null&&clearTimeout(a),a=setTimeout(()=>{a=null,!(document.hasFocus()===!0&&(t.hasPopupOpen===!0||t.controlRef===void 0||t.controlRef.value===null||t.controlRef.value.contains(document.activeElement)!==!1))&&(t.focused.value===!0&&(t.focused.value=!1,n("blur",A)),Q!==void 0&&Q())})}function V(A){Rn(A),o.platform.is.mobile!==!0?(t.targetRef!==void 0&&t.targetRef.value||t.rootRef.value).focus():t.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),e.type==="file"&&(t.inputRef.value.value=null),n("update:modelValue",null),n("clear",e.modelValue),sn(()=>{d(),o.platform.is.mobile!==!0&&(l.value=!1)})}function R(){const A=[];return i.prepend!==void 0&&A.push(M("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:Jn},i.prepend())),A.push(M("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},X())),u.value===!0&&e.noErrorIcon===!1&&A.push(le("error",[M(ki,{name:o.iconSet.field.error,color:"negative"})])),e.loading===!0||t.innerLoading.value===!0?A.push(le("inner-loading-append",i.loading!==void 0?i.loading():[M(Iy,{color:e.color})])):e.clearable===!0&&t.hasValue.value===!0&&t.editable.value===!0&&A.push(le("inner-clearable-append",[M(ki,{class:"q-field__focusable-action",tag:"button",name:e.clearIcon||o.iconSet.field.clear,tabindex:0,type:"button","aria-hidden":null,role:null,onClick:V})])),i.append!==void 0&&A.push(M("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:Jn},i.append())),t.getInnerAppend!==void 0&&A.push(le("inner-append",t.getInnerAppend())),t.getControlChild!==void 0&&A.push(t.getControlChild()),A}function X(){const A=[];return e.prefix!==void 0&&e.prefix!==null&&A.push(M("div",{class:"q-field__prefix no-pointer-events row items-center"},e.prefix)),t.getShadowControl!==void 0&&t.hasShadow.value===!0&&A.push(t.getShadowControl()),t.getControl!==void 0?A.push(t.getControl()):i.rawControl!==void 0?A.push(i.rawControl()):i.control!==void 0&&A.push(M("div",{ref:t.targetRef,class:"q-field__native row",tabindex:-1,...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0},i.control(E.value))),v.value===!0&&A.push(M("div",{class:b.value},Lt(i.label,e.label))),e.suffix!==void 0&&e.suffix!==null&&A.push(M("div",{class:"q-field__suffix no-pointer-events row items-center"},e.suffix)),A.concat(Lt(i.default))}function $(){let A,Q;u.value===!0?h.value!==null?(A=[M("div",{role:"alert"},h.value)],Q=`q--slot-error-${h.value}`):(A=Lt(i.error),Q="q--slot-error"):(e.hideHint!==!0||t.focused.value===!0)&&(e.hint!==void 0?(A=[M("div",e.hint)],Q=`q--slot-hint-${e.hint}`):(A=Lt(i.hint),Q="q--slot-hint"));const Ce=e.counter===!0||i.counter!==void 0;if(e.hideBottomSpace===!0&&Ce===!1&&A===void 0)return;const ye=M("div",{key:Q,class:"q-field__messages col"},A);return M("div",{class:"q-field__bottom row items-start q-field__bottom--"+(e.hideBottomSpace!==!0?"animated":"stale"),onClick:Jn},[e.hideBottomSpace===!0?ye:M(Cs,{name:"q-transition--field-message"},()=>ye),Ce===!0?M("div",{class:"q-field__counter"},i.counter!==void 0?i.counter():t.computedCounter.value):null])}function le(A,Q){return Q===null?null:M("div",{key:A,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},Q)}let ie=!1;return Wh(()=>{ie=!0}),UE(()=>{ie===!0&&e.autofocus===!0&&s.focus()}),Hn(()=>{Di.value===!0&&e.for===void 0&&(t.targetUid.value=Bm()),e.autofocus===!0&&s.focus()}),Xt(()=>{a!==null&&clearTimeout(a)}),Object.assign(s,{focus:B,blur:N}),function(){const Q=t.getControl===void 0&&i.control===void 0?{...t.splitAttrs.attributes.value,"data-autofocus":e.autofocus===!0||void 0,...P.value}:P.value;return M("label",{ref:t.rootRef,class:[g.value,r.class],style:r.style,...Q},[i.before!==void 0?M("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:Jn},i.before()):null,M("div",{class:"q-field__inner relative-position col self-stretch"},[M("div",{ref:t.controlRef,class:w.value,tabindex:-1,...t.controlEvents},R()),p.value===!0?$():null]),i.after!==void 0?M("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:Jn},i.after()):null])}}const Db={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},Ph={"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:t=>t.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:t=>t.toLocaleLowerCase()}},HA=Object.keys(Ph);HA.forEach(t=>{Ph[t].regex=new RegExp(Ph[t].pattern)});const bH=new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+HA.join("")+"])|(.)","g"),Ob=/[.*+?^${}()|[\]\\]/g,Tt=String.fromCharCode(1),EH={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean};function IH(t,e,n,i){let r,s,o,a,l,c;const u=ae(null),h=ae(f());function d(){return t.autogrow===!0||["textarea","text","search","url","tel","password"].includes(t.type)}ge(()=>t.type+t.autogrow,m),ge(()=>t.mask,S=>{if(S!==void 0)g(h.value,!0);else{const k=B(h.value);m(),t.modelValue!==k&&e("update:modelValue",k)}}),ge(()=>t.fillMask+t.reverseFillMask,()=>{u.value===!0&&g(h.value,!0)}),ge(()=>t.unmaskedValue,()=>{u.value===!0&&g(h.value)});function f(){if(m(),u.value===!0){const S=P(B(t.modelValue));return t.fillMask!==!1?N(S):S}return t.modelValue}function p(S){if(S<r.length)return r.slice(-S);let k="",V=r;const R=V.indexOf(Tt);if(R>-1){for(let X=S-V.length;X>0;X--)k+=Tt;V=V.slice(0,R)+k+V.slice(R)}return V}function m(){if(u.value=t.mask!==void 0&&t.mask.length!==0&&d(),u.value===!1){a=void 0,r="",s="";return}const S=Db[t.mask]===void 0?t.mask:Db[t.mask],k=typeof t.fillMask=="string"&&t.fillMask.length!==0?t.fillMask.slice(0,1):"_",V=k.replace(Ob,"\\$&"),R=[],X=[],$=[];let le=t.reverseFillMask===!0,ie="",A="";S.replace(bH,(ke,j,xe,Et,me)=>{if(Et!==void 0){const pe=Ph[Et];$.push(pe),A=pe.negate,le===!0&&(X.push("(?:"+A+"+)?("+pe.pattern+"+)?(?:"+A+"+)?("+pe.pattern+"+)?"),le=!1),X.push("(?:"+A+"+)?("+pe.pattern+")?")}else if(xe!==void 0)ie="\\"+(xe==="\\"?"":xe),$.push(xe),R.push("([^"+ie+"]+)?"+ie+"?");else{const pe=j!==void 0?j:me;ie=pe==="\\"?"\\\\\\\\":pe.replace(Ob,"\\\\$&"),$.push(pe),R.push("([^"+ie+"]+)?"+ie+"?")}});const Q=new RegExp("^"+R.join("")+"("+(ie===""?".":"[^"+ie+"]")+"+)?"+(ie===""?"":"["+ie+"]*")+"$"),Ce=X.length-1,ye=X.map((ke,j)=>j===0&&t.reverseFillMask===!0?new RegExp("^"+V+"*"+ke):j===Ce?new RegExp("^"+ke+"("+(A===""?".":A)+"+)?"+(t.reverseFillMask===!0?"$":V+"*")):new RegExp("^"+ke));o=$,a=ke=>{const j=Q.exec(t.reverseFillMask===!0?ke:ke.slice(0,$.length+1));j!==null&&(ke=j.slice(1).join(""));const xe=[],Et=ye.length;for(let me=0,pe=ke;me<Et;me++){const L=ye[me].exec(pe);if(L===null)break;pe=pe.slice(L.shift().length),xe.push(...L)}return xe.length!==0?xe.join(""):ke},r=$.map(ke=>typeof ke=="string"?ke:Tt).join(""),s=r.split(Tt).join(k)}function g(S,k,V){const R=i.value,X=R.selectionEnd,$=R.value.length-X,le=B(S);k===!0&&m();const ie=P(le),A=t.fillMask!==!1?N(ie):ie,Q=h.value!==A;R.value!==A&&(R.value=A),Q===!0&&(h.value=A),document.activeElement===R&&sn(()=>{if(A===s){const ye=t.reverseFillMask===!0?s.length:0;R.setSelectionRange(ye,ye,"forward");return}if(V==="insertFromPaste"&&t.reverseFillMask!==!0){const ye=R.selectionEnd;let ke=X-1;for(let j=l;j<=ke&&j<ye;j++)r[j]!==Tt&&ke++;v.right(R,ke);return}if(["deleteContentBackward","deleteContentForward"].indexOf(V)>-1){const ye=t.reverseFillMask===!0?X===0?A.length>ie.length?1:0:Math.max(0,A.length-(A===s?0:Math.min(ie.length,$)+1))+1:X;R.setSelectionRange(ye,ye,"forward");return}if(t.reverseFillMask===!0)if(Q===!0){const ye=Math.max(0,A.length-(A===s?0:Math.min(ie.length,$+1)));ye===1&&X===1?R.setSelectionRange(ye,ye,"forward"):v.rightReverse(R,ye)}else{const ye=A.length-$;R.setSelectionRange(ye,ye,"backward")}else if(Q===!0){const ye=Math.max(0,r.indexOf(Tt),Math.min(ie.length,X)-1);v.right(R,ye)}else{const ye=X-1;v.right(R,ye)}});const Ce=t.unmaskedValue===!0?B(A):A;String(t.modelValue)!==Ce&&n(Ce,!0)}function w(S,k,V){const R=P(B(S.value));k=Math.max(0,r.indexOf(Tt),Math.min(R.length,k)),l=k,S.setSelectionRange(k,V,"forward")}const v={left(S,k){const V=r.slice(k-1).indexOf(Tt)===-1;let R=Math.max(0,k-1);for(;R>=0;R--)if(r[R]===Tt){k=R,V===!0&&k++;break}if(R<0&&r[k]!==void 0&&r[k]!==Tt)return v.right(S,0);k>=0&&S.setSelectionRange(k,k,"backward")},right(S,k){const V=S.value.length;let R=Math.min(V,k+1);for(;R<=V;R++)if(r[R]===Tt){k=R;break}else r[R-1]===Tt&&(k=R);if(R>V&&r[k-1]!==void 0&&r[k-1]!==Tt)return v.left(S,V);S.setSelectionRange(k,k,"forward")},leftReverse(S,k){const V=p(S.value.length);let R=Math.max(0,k-1);for(;R>=0;R--)if(V[R-1]===Tt){k=R;break}else if(V[R]===Tt&&(k=R,R===0))break;if(R<0&&V[k]!==void 0&&V[k]!==Tt)return v.rightReverse(S,0);k>=0&&S.setSelectionRange(k,k,"backward")},rightReverse(S,k){const V=S.value.length,R=p(V),X=R.slice(0,k+1).indexOf(Tt)===-1;let $=Math.min(V,k+1);for(;$<=V;$++)if(R[$-1]===Tt){k=$,k>0&&X===!0&&k--;break}if($>V&&R[k-1]!==void 0&&R[k-1]!==Tt)return v.leftReverse(S,V);S.setSelectionRange(k,k,"forward")}};function b(S){e("click",S),c=void 0}function E(S){if(e("keydown",S),xA(S)===!0)return;const k=i.value,V=k.selectionStart,R=k.selectionEnd;if(S.shiftKey||(c=void 0),S.keyCode===37||S.keyCode===39){S.shiftKey&&c===void 0&&(c=k.selectionDirection==="forward"?V:R);const X=v[(S.keyCode===39?"right":"left")+(t.reverseFillMask===!0?"Reverse":"")];if(S.preventDefault(),X(k,c===V?R:V),S.shiftKey){const $=k.selectionStart;k.setSelectionRange(Math.min(c,$),Math.max(c,$),"forward")}}else S.keyCode===8&&t.reverseFillMask!==!0&&V===R?(v.left(k,V),k.setSelectionRange(k.selectionStart,R,"backward")):S.keyCode===46&&t.reverseFillMask===!0&&V===R&&(v.rightReverse(k,R),k.setSelectionRange(V,k.selectionEnd,"forward"))}function P(S){if(S==null||S==="")return"";if(t.reverseFillMask===!0)return C(S);const k=o;let V=0,R="";for(let X=0;X<k.length;X++){const $=S[V],le=k[X];if(typeof le=="string")R+=le,$===le&&V++;else if($!==void 0&&le.regex.test($))R+=le.transform!==void 0?le.transform($):$,V++;else return R}return R}function C(S){const k=o,V=r.indexOf(Tt);let R=S.length-1,X="";for(let $=k.length-1;$>=0&&R>-1;$--){const le=k[$];let ie=S[R];if(typeof le=="string")X=le+X,ie===le&&R--;else if(ie!==void 0&&le.regex.test(ie))do X=(le.transform!==void 0?le.transform(ie):ie)+X,R--,ie=S[R];while(V===$&&ie!==void 0&&le.regex.test(ie));else return X}return X}function B(S){return typeof S!="string"||a===void 0?typeof S=="number"?a(""+S):S:a(S)}function N(S){return s.length-S.length<=0?S:t.reverseFillMask===!0&&S.length!==0?s.slice(0,-S.length)+S:S+s.slice(S.length)}return{innerValue:h,hasMask:u,moveCursorForPaste:w,updateMaskValue:g,onMaskedKeydown:E,onMaskedClick:b}}const KA={name:String};function WA(t){return I(()=>t.name||t.for)}function GA(t,e){function n(){const i=t.modelValue;try{const r="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(i)===i&&("length"in i?Array.from(i):[i]).forEach(s=>{r.items.add(s)}),{files:r.files}}catch{return{files:void 0}}}return I(e===!0?()=>{if(t.type==="file")return n()}:n)}const TH=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,SH=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,CH=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,kH=/[a-z0-9_ -]$/i;function xH(t){return function(n){if(n.type==="compositionend"||n.type==="change"){if(n.target.qComposing!==!0)return;n.target.qComposing=!1,t(n)}else n.type==="compositionupdate"&&n.target.qComposing!==!0&&typeof n.data=="string"&&(Je.is.firefox===!0?kH.test(n.data)===!1:TH.test(n.data)===!0||SH.test(n.data)===!0||CH.test(n.data)===!0)===!0&&(n.target.qComposing=!0)}}const QA=Ze({name:"QInput",inheritAttrs:!1,props:{...UA,...EH,...KA,modelValue:{required:!1},shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...VA,"paste","change","keydown","click","animationend"],setup(t,{emit:e,attrs:n}){const{proxy:i}=je(),{$q:r}=i,s={};let o=NaN,a,l,c=null,u;const h=ae(null),d=WA(t),{innerValue:f,hasMask:p,moveCursorForPaste:m,updateMaskValue:g,onMaskedKeydown:w,onMaskedClick:v}=IH(t,e,ie,h),b=GA(t,!0),E=I(()=>ec(f.value)),P=xH($),C=zA(),B=I(()=>t.type==="textarea"||t.autogrow===!0),N=I(()=>B.value===!0||["text","search","url","tel","password"].includes(t.type)),S=I(()=>{const j={...C.splitAttrs.listeners.value,onInput:$,onPaste:X,onChange:Q,onBlur:Ce,onFocus:Er};return j.onCompositionstart=j.onCompositionupdate=j.onCompositionend=P,p.value===!0&&(j.onKeydown=w,j.onClick=v),t.autogrow===!0&&(j.onAnimationend=le),j}),k=I(()=>{const j={tabindex:0,"data-autofocus":t.autofocus===!0||void 0,rows:t.type==="textarea"?6:void 0,"aria-label":t.label,name:d.value,...C.splitAttrs.attributes.value,id:C.targetUid.value,maxlength:t.maxlength,disabled:t.disable===!0,readonly:t.readonly===!0};return B.value===!1&&(j.type=t.type),t.autogrow===!0&&(j.rows=1),j});ge(()=>t.type,()=>{h.value&&(h.value.value=t.modelValue)}),ge(()=>t.modelValue,j=>{if(p.value===!0){if(l===!0&&(l=!1,String(j)===o))return;g(j)}else f.value!==j&&(f.value=j,t.type==="number"&&s.hasOwnProperty("value")===!0&&(a===!0?a=!1:delete s.value));t.autogrow===!0&&sn(A)}),ge(()=>t.autogrow,j=>{j===!0?sn(A):h.value!==null&&n.rows>0&&(h.value.style.height="auto")}),ge(()=>t.dense,()=>{t.autogrow===!0&&sn(A)});function V(){Cy(()=>{const j=document.activeElement;h.value!==null&&h.value!==j&&(j===null||j.id!==C.targetUid.value)&&h.value.focus({preventScroll:!0})})}function R(){h.value!==null&&h.value.select()}function X(j){if(p.value===!0&&t.reverseFillMask!==!0){const xe=j.target;m(xe,xe.selectionStart,xe.selectionEnd)}e("paste",j)}function $(j){if(!j||!j.target)return;if(t.type==="file"){e("update:modelValue",j.target.files);return}const xe=j.target.value;if(j.target.qComposing===!0){s.value=xe;return}if(p.value===!0)g(xe,!1,j.inputType);else if(ie(xe),N.value===!0&&j.target===document.activeElement){const{selectionStart:Et,selectionEnd:me}=j.target;Et!==void 0&&me!==void 0&&sn(()=>{j.target===document.activeElement&&xe.indexOf(j.target.value)===0&&j.target.setSelectionRange(Et,me)})}t.autogrow===!0&&A()}function le(j){e("animationend",j),A()}function ie(j,xe){u=()=>{c=null,t.type!=="number"&&s.hasOwnProperty("value")===!0&&delete s.value,t.modelValue!==j&&o!==j&&(o=j,xe===!0&&(l=!0),e("update:modelValue",j),sn(()=>{o===j&&(o=NaN)})),u=void 0},t.type==="number"&&(a=!0,s.value=j),t.debounce!==void 0?(c!==null&&clearTimeout(c),s.value=j,c=setTimeout(u,t.debounce)):u()}function A(){requestAnimationFrame(()=>{const j=h.value;if(j!==null){const xe=j.parentNode.style,{scrollTop:Et}=j,{overflowY:me,maxHeight:pe}=r.platform.is.firefox===!0?{}:window.getComputedStyle(j),L=me!==void 0&&me!=="scroll";L===!0&&(j.style.overflowY="hidden"),xe.marginBottom=j.scrollHeight-1+"px",j.style.height="1px",j.style.height=j.scrollHeight+"px",L===!0&&(j.style.overflowY=parseInt(pe,10)<j.scrollHeight?"auto":"hidden"),xe.marginBottom="",j.scrollTop=Et}})}function Q(j){P(j),c!==null&&(clearTimeout(c),c=null),u!==void 0&&u(),e("change",j.target.value)}function Ce(j){j!==void 0&&Er(j),c!==null&&(clearTimeout(c),c=null),u!==void 0&&u(),a=!1,l=!1,delete s.value,t.type!=="file"&&setTimeout(()=>{h.value!==null&&(h.value.value=f.value!==void 0?f.value:"")})}function ye(){return s.hasOwnProperty("value")===!0?s.value:f.value!==void 0?f.value:""}Xt(()=>{Ce()}),Hn(()=>{t.autogrow===!0&&A()}),Object.assign(C,{innerValue:f,fieldClass:I(()=>`q-${B.value===!0?"textarea":"input"}`+(t.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:I(()=>t.type!=="file"&&typeof t.shadowText=="string"&&t.shadowText.length!==0),inputRef:h,emitValue:ie,hasValue:E,floatingLabel:I(()=>E.value===!0&&(t.type!=="number"||isNaN(f.value)===!1)||ec(t.displayValue)),getControl:()=>M(B.value===!0?"textarea":"input",{ref:h,class:["q-field__native q-placeholder",t.inputClass],style:t.inputStyle,...k.value,...S.value,...t.type!=="file"?{value:ye()}:b.value}),getShadowControl:()=>M("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(B.value===!0?"":" text-no-wrap")},[M("span",{class:"invisible"},ye()),M("span",t.shadowText)])});const ke=jA(C);return Object.assign(i,{focus:V,select:R,getNativeElement:()=>h.value}),eo(i,"nativeEl",()=>h.value),ke}}),AH=Ze({name:"QCardActions",props:{...RA,vertical:Boolean},setup(t,{slots:e}){const n=NA(t),i=I(()=>`q-card__actions ${n.value} q-card__actions--${t.vertical===!0?"vert column":"horiz row"}`);return()=>M("div",{class:i.value},Lt(e.default))}}),RH=Ze({name:"QCard",props:{...to,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(t,{slots:e}){const{proxy:{$q:n}}=je(),i=no(t,n),r=I(()=>"q-card"+(i.value===!0?" q-card--dark q-dark":"")+(t.bordered===!0?" q-card--bordered":"")+(t.square===!0?" q-card--square no-border-radius":"")+(t.flat===!0?" q-card--flat no-shadow":""));return()=>M(t.tag,{class:r.value},Lt(e.default))}}),YA=()=>!0;function NH(t){return typeof t=="string"&&t!==""&&t!=="/"&&t!=="#/"}function DH(t){return t.startsWith("#")===!0&&(t=t.substring(1)),t.startsWith("/")===!1&&(t="/"+t),t.endsWith("/")===!0&&(t=t.substring(0,t.length-1)),"#"+t}function OH(t){if(t.backButtonExit===!1)return()=>!1;if(t.backButtonExit==="*")return YA;const e=["#/"];return Array.isArray(t.backButtonExit)===!0&&e.push(...t.backButtonExit.filter(NH).map(DH)),()=>e.includes(window.location.hash)}const $m={__history:[],add:Fr,remove:Fr,install({$q:t}){if(this.__installed===!0)return;const{cordova:e,capacitor:n}=Je.is;if(e!==!0&&n!==!0)return;const i=t.config[e===!0?"cordova":"capacitor"];if(i!==void 0&&i.backButton===!1||n===!0&&(window.Capacitor===void 0||window.Capacitor.Plugins.App===void 0))return;this.add=o=>{o.condition===void 0&&(o.condition=YA),this.__history.push(o)},this.remove=o=>{const a=this.__history.indexOf(o);a>=0&&this.__history.splice(a,1)};const r=OH(Object.assign({backButtonExit:!0},i)),s=()=>{if(this.__history.length){const o=this.__history[this.__history.length-1];o.condition()===!0&&(this.__history.pop(),o.handler())}else r()===!0?navigator.app.exitApp():window.history.back()};e===!0?document.addEventListener("deviceready",()=>{document.addEventListener("backbutton",s,!1)}):window.Capacitor.Plugins.App.addListener("backButton",s)}};function XA(t,e,n){let i;function r(){i!==void 0&&($m.remove(i),i=void 0)}return Xt(()=>{t.value===!0&&r()}),{removeFromHistory:r,addToHistory(){i={condition:()=>n.value===!0,handler:e},$m.add(i)}}}function JA(){let t=null;const e=je();function n(){t!==null&&(clearTimeout(t),t=null)}return Wh(n),Xt(n),{removeTimeout:n,registerTimeout(i,r){n(),PA(e)===!1&&(t=setTimeout(i,r))}}}function PH(){let t;const e=je();function n(){t=void 0}return Wh(n),Xt(n),{removeTick:n,registerTick(i){t=i,sn(()=>{t===i&&(PA(e)===!1&&t(),t=void 0)})}}}const ZA={modelValue:{type:Boolean,default:null},"onUpdate:modelValue":[Function,Array]},eR=["beforeShow","show","beforeHide","hide"];function tR({showing:t,canShow:e,hideOnRouteChange:n,handleShow:i,handleHide:r,processOnMount:s}){const o=je(),{props:a,emit:l,proxy:c}=o;let u;function h(v){t.value===!0?p(v):d(v)}function d(v){if(a.disable===!0||v!==void 0&&v.qAnchorHandled===!0||e!==void 0&&e(v)!==!0)return;const b=a["onUpdate:modelValue"]!==void 0;b===!0&&(l("update:modelValue",!0),u=v,sn(()=>{u===v&&(u=void 0)})),(a.modelValue===null||b===!1)&&f(v)}function f(v){t.value!==!0&&(t.value=!0,l("beforeShow",v),i!==void 0?i(v):l("show",v))}function p(v){if(a.disable===!0)return;const b=a["onUpdate:modelValue"]!==void 0;b===!0&&(l("update:modelValue",!1),u=v,sn(()=>{u===v&&(u=void 0)})),(a.modelValue===null||b===!1)&&m(v)}function m(v){t.value!==!1&&(t.value=!1,l("beforeHide",v),r!==void 0?r(v):l("hide",v))}function g(v){a.disable===!0&&v===!0?a["onUpdate:modelValue"]!==void 0&&l("update:modelValue",!1):v===!0!==t.value&&(v===!0?f:m)(u)}ge(()=>a.modelValue,g),n!==void 0&&OA(o)===!0&&ge(()=>c.$route.fullPath,()=>{n.value===!0&&t.value===!0&&p()}),s===!0&&Hn(()=>{g(a.modelValue)});const w={show:d,hide:p,toggle:h};return Object.assign(c,w),w}const MH={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function LH(t,e=()=>{},n=()=>{}){return{transitionProps:I(()=>{const i=`q-transition--${t.transitionShow||e()}`,r=`q-transition--${t.transitionHide||n()}`;return{appear:!0,enterFromClass:`${i}-enter-from`,enterActiveClass:`${i}-enter-active`,enterToClass:`${i}-enter-to`,leaveFromClass:`${r}-leave-from`,leaveActiveClass:`${r}-leave-active`,leaveToClass:`${r}-leave-to`}}),transitionStyle:I(()=>`--q-transition-duration: ${t.transitionDuration}ms`)}}const Mh={};let nR=!1;function FH(){nR=!0}let BH=1,$H=document.body;function qH(t,e){const n=document.createElement("div");if(n.id=e!==void 0?`q-portal--${e}--${BH++}`:t,Mh.globalNodes!==void 0){const i=Mh.globalNodes.class;i!==void 0&&(n.className=i)}return $H.appendChild(n),n}function UH(t){t.remove()}const $u=[];function VH(t){return $u.find(e=>e.contentEl!==null&&e.contentEl.contains(t))}function zH(t,e){do{if(t.$options.name==="QMenu"){if(t.hide(e),t.$props.separateClosePopup===!0)return Bu(t)}else if(t.__qPortal===!0){const n=Bu(t);return n!==void 0&&n.$options.name==="QPopupProxy"?(t.hide(e),n):t}t=Bu(t)}while(t!=null)}function jH(t,e,n){for(;n!==0&&t!==void 0&&t!==null;){if(t.__qPortal===!0){if(n--,t.$options.name==="QMenu"){t=zH(t,e);continue}t.hide(e)}t=Bu(t)}}function HH(t){for(t=t.parent;t!=null;){if(t.type.name==="QGlobalDialog")return!0;if(t.type.name==="QDialog"||t.type.name==="QMenu")return!1;t=t.parent}return!1}function KH(t,e,n,i){const r=ae(!1),s=ae(!1);let o=null;const a={},l=i==="dialog"&&HH(t);function c(h){if(h===!0){Nb(a),s.value=!0;return}s.value=!1,r.value===!1&&(l===!1&&o===null&&(o=qH(!1,i)),r.value=!0,$u.push(t.proxy),_H(a))}function u(h){if(s.value=!1,h!==!0)return;Nb(a),r.value=!1;const d=$u.indexOf(t.proxy);d!==-1&&$u.splice(d,1),o!==null&&(UH(o),o=null)}return Qh(()=>{u(!0)}),t.proxy.__qPortal=!0,eo(t.proxy,"contentEl",()=>e.value),{showPortal:c,hidePortal:u,portalIsActive:r,portalIsAccessible:s,renderPortal:()=>l===!0?n():r.value===!0?[M(Z1,{to:o},n())]:void 0}}const WH=[null,document,document.body,document.scrollingElement,document.documentElement];function GH(t,e){let n=R4(e);if(n===void 0){if(t==null)return window;n=t.closest(".scroll,.scroll-y,.overflow-auto")}return WH.includes(n)?window:n}function iR(t){return t===window?window.pageYOffset||window.scrollY||document.body.scrollTop||0:t.scrollTop}function rR(t){return t===window?window.pageXOffset||window.scrollX||document.body.scrollLeft||0:t.scrollLeft}let vu;function Xf(){if(vu!==void 0)return vu;const t=document.createElement("p"),e=document.createElement("div");Lm(t,{width:"100%",height:"200px"}),Lm(e,{position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),e.appendChild(t),document.body.appendChild(e);const n=t.offsetWidth;e.style.overflow="scroll";let i=t.offsetWidth;return n===i&&(i=e.clientWidth),e.remove(),vu=n-i,vu}function QH(t,e=!0){return!t||t.nodeType!==Node.ELEMENT_NODE?!1:e?t.scrollHeight>t.clientHeight&&(t.classList.contains("scroll")||t.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(t)["overflow-y"])):t.scrollWidth>t.clientWidth&&(t.classList.contains("scroll")||t.classList.contains("overflow-auto")||["auto","scroll"].includes(window.getComputedStyle(t)["overflow-x"]))}let za=0,Jf,Zf,Za,ep=!1,Pb,Mb,Lb,Yr=null;function YH(t){XH(t)&&Rn(t)}function XH(t){if(t.target===document.body||t.target.classList.contains("q-layout__backdrop"))return!0;const e=O4(t),n=t.shiftKey&&!t.deltaX,i=!n&&Math.abs(t.deltaX)<=Math.abs(t.deltaY),r=n||i?t.deltaY:t.deltaX;for(let s=0;s<e.length;s++){const o=e[s];if(QH(o,i))return i?r<0&&o.scrollTop===0?!0:r>0&&o.scrollTop+o.clientHeight===o.scrollHeight:r<0&&o.scrollLeft===0?!0:r>0&&o.scrollLeft+o.clientWidth===o.scrollWidth}return!0}function Fb(t){t.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function yu(t){ep!==!0&&(ep=!0,requestAnimationFrame(()=>{ep=!1;const{height:e}=t.target,{clientHeight:n,scrollTop:i}=document.scrollingElement;(Za===void 0||e!==window.innerHeight)&&(Za=n-e,document.scrollingElement.scrollTop=i),i>Za&&(document.scrollingElement.scrollTop-=Math.ceil((i-Za)/8))}))}function Bb(t){const e=document.body,n=window.visualViewport!==void 0;if(t==="add"){const{overflowY:i,overflowX:r}=window.getComputedStyle(e);Jf=rR(window),Zf=iR(window),Pb=e.style.left,Mb=e.style.top,Lb=window.location.href,e.style.left=`-${Jf}px`,e.style.top=`-${Zf}px`,r!=="hidden"&&(r==="scroll"||e.scrollWidth>window.innerWidth)&&e.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||e.scrollHeight>window.innerHeight)&&e.classList.add("q-body--force-scrollbar-y"),e.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,Je.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",yu,Ht.passiveCapture),window.visualViewport.addEventListener("scroll",yu,Ht.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Fb,Ht.passiveCapture))}Je.is.desktop===!0&&Je.is.mac===!0&&window[`${t}EventListener`]("wheel",YH,Ht.notPassive),t==="remove"&&(Je.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",yu,Ht.passiveCapture),window.visualViewport.removeEventListener("scroll",yu,Ht.passiveCapture)):window.removeEventListener("scroll",Fb,Ht.passiveCapture)),e.classList.remove("q-body--prevent-scroll"),e.classList.remove("q-body--force-scrollbar-x"),e.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,e.style.left=Pb,e.style.top=Mb,window.location.href===Lb&&window.scrollTo(Jf,Zf),Za=void 0)}function JH(t){let e="add";if(t===!0){if(za++,Yr!==null){clearTimeout(Yr),Yr=null;return}if(za>1)return}else{if(za===0||(za--,za>0))return;if(e="remove",Je.is.ios===!0&&Je.is.nativeMobile===!0){Yr!==null&&clearTimeout(Yr),Yr=setTimeout(()=>{Bb(e),Yr=null},100);return}}Bb(e)}function sR(){let t;return{preventBodyScroll(e){e!==t&&(t!==void 0||e===!0)&&(t=e,JH(e))}}}const Ts=[];let sa;function ZH(t){sa=t.keyCode===27}function e9(){sa===!0&&(sa=!1)}function t9(t){sa===!0&&(sa=!1,ra(t,27)===!0&&Ts[Ts.length-1](t))}function oR(t){window[t]("keydown",ZH),window[t]("blur",e9),window[t]("keyup",t9),sa=!1}function n9(t){Je.is.desktop===!0&&(Ts.push(t),Ts.length===1&&oR("addEventListener"))}function $b(t){const e=Ts.indexOf(t);e>-1&&(Ts.splice(e,1),Ts.length===0&&oR("removeEventListener"))}const Ss=[];function aR(t){Ss[Ss.length-1](t)}function i9(t){Je.is.desktop===!0&&(Ss.push(t),Ss.length===1&&document.body.addEventListener("focusin",aR))}function qb(t){const e=Ss.indexOf(t);e>-1&&(Ss.splice(e,1),Ss.length===0&&document.body.removeEventListener("focusin",aR))}let _u=0;const r9={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Ub={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},s9=Ze({name:"QDialog",inheritAttrs:!1,props:{...ZA,...MH,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:t=>t==="standard"||["top","bottom","left","right"].includes(t)}},emits:[...eR,"shake","click","escapeKey"],setup(t,{slots:e,emit:n,attrs:i}){const r=je(),s=ae(null),o=ae(!1),a=ae(!1);let l=null,c=null,u,h;const d=I(()=>t.persistent!==!0&&t.noRouteDismiss!==!0&&t.seamless!==!0),{preventBodyScroll:f}=sR(),{registerTimeout:p}=JA(),{registerTick:m,removeTick:g}=PH(),{transitionProps:w,transitionStyle:v}=LH(t,()=>Ub[t.position][0],()=>Ub[t.position][1]),{showPortal:b,hidePortal:E,portalIsAccessible:P,renderPortal:C}=KH(r,s,Et,"dialog"),{hide:B}=tR({showing:o,hideOnRouteChange:d,handleShow:$,handleHide:le,processOnMount:!0}),{addToHistory:N,removeFromHistory:S}=XA(o,B,d),k=I(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${t.maximized===!0?"maximized":"minimized"} q-dialog__inner--${t.position} ${r9[t.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(t.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(t.fullHeight===!0?" q-dialog__inner--fullheight":"")+(t.square===!0?" q-dialog__inner--square":"")),V=I(()=>o.value===!0&&t.seamless!==!0),R=I(()=>t.autoClose===!0?{onClick:ke}:{}),X=I(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${V.value===!0?"modal":"seamless"}`,i.class]);ge(()=>t.maximized,me=>{o.value===!0&&ye(me)}),ge(V,me=>{f(me),me===!0?(i9(xe),n9(Q)):(qb(xe),$b(Q))});function $(me){N(),c=t.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,ye(t.maximized),b(),a.value=!0,t.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),m(ie)):g(),p(()=>{if(r.proxy.$q.platform.is.ios===!0){if(t.seamless!==!0&&document.activeElement){const{top:pe,bottom:L}=document.activeElement.getBoundingClientRect(),{innerHeight:se}=window,J=window.visualViewport!==void 0?window.visualViewport.height:se;pe>0&&L>J/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-J,L>=se?1/0:Math.ceil(document.scrollingElement.scrollTop+L-J/2))),document.activeElement.scrollIntoView()}h=!0,s.value.click(),h=!1}b(!0),a.value=!1,n("show",me)},t.transitionDuration)}function le(me){g(),S(),Ce(!0),a.value=!0,E(),c!==null&&(((me&&me.type.indexOf("key")===0?c.closest('[tabindex]:not([tabindex^="-"])'):void 0)||c).focus(),c=null),p(()=>{E(!0),a.value=!1,n("hide",me)},t.transitionDuration)}function ie(me){Cy(()=>{let pe=s.value;pe===null||pe.contains(document.activeElement)===!0||(pe=(me!==""?pe.querySelector(me):null)||pe.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||pe.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||pe.querySelector("[autofocus], [data-autofocus]")||pe,pe.focus({preventScroll:!0}))})}function A(me){me&&typeof me.focus=="function"?me.focus({preventScroll:!0}):ie(),n("shake");const pe=s.value;pe!==null&&(pe.classList.remove("q-animate--scale"),pe.classList.add("q-animate--scale"),l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,s.value!==null&&(pe.classList.remove("q-animate--scale"),ie())},170))}function Q(){t.seamless!==!0&&(t.persistent===!0||t.noEscDismiss===!0?t.maximized!==!0&&t.noShake!==!0&&A():(n("escapeKey"),B()))}function Ce(me){l!==null&&(clearTimeout(l),l=null),(me===!0||o.value===!0)&&(ye(!1),t.seamless!==!0&&(f(!1),qb(xe),$b(Q))),me!==!0&&(c=null)}function ye(me){me===!0?u!==!0&&(_u<1&&document.body.classList.add("q-body--dialog"),_u++,u=!0):u===!0&&(_u<2&&document.body.classList.remove("q-body--dialog"),_u--,u=!1)}function ke(me){h!==!0&&(B(me),n("click",me))}function j(me){t.persistent!==!0&&t.noBackdropDismiss!==!0?B(me):t.noShake!==!0&&A()}function xe(me){t.allowFocusOutside!==!0&&P.value===!0&&N4(s.value,me.target)!==!0&&ie('[tabindex]:not([tabindex="-1"])')}Object.assign(r.proxy,{focus:ie,shake:A,__updateRefocusTarget(me){c=me||null}}),Xt(Ce);function Et(){return M("div",{role:"dialog","aria-modal":V.value===!0?"true":"false",...i,class:X.value},[M(Cs,{name:"q-transition--fade",appear:!0},()=>V.value===!0?M("div",{class:"q-dialog__backdrop fixed-full",style:v.value,"aria-hidden":"true",tabindex:-1,onClick:j}):null),M(Cs,w.value,()=>o.value===!0?M("div",{ref:s,class:k.value,style:v.value,tabindex:-1,...R.value},Lt(e.default)):null)])}return C}}),ky={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},o9=Object.keys(ky);ky.all=!0;function Vb(t){const e={};for(const n of o9)t[n]===!0&&(e[n]=!0);return Object.keys(e).length===0?ky:(e.horizontal===!0?e.left=e.right=!0:e.left===!0&&e.right===!0&&(e.horizontal=!0),e.vertical===!0?e.up=e.down=!0:e.up===!0&&e.down===!0&&(e.vertical=!0),e.horizontal===!0&&e.vertical===!0&&(e.all=!0),e)}const a9=["INPUT","TEXTAREA"];function zb(t,e){return e.event===void 0&&t.target!==void 0&&t.target.draggable!==!0&&typeof e.handler=="function"&&a9.includes(t.target.nodeName.toUpperCase())===!1&&(t.qClonedBy===void 0||t.qClonedBy.indexOf(e.uid)===-1)}function l9(){if(window.getSelection!==void 0){const t=window.getSelection();t.empty!==void 0?t.empty():t.removeAllRanges!==void 0&&(t.removeAllRanges(),Oh.is.mobile!==!0&&t.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}function tp(t,e,n){const i=Dh(t);let r,s=i.left-e.event.x,o=i.top-e.event.y,a=Math.abs(s),l=Math.abs(o);const c=e.direction;c.horizontal===!0&&c.vertical!==!0?r=s<0?"left":"right":c.horizontal!==!0&&c.vertical===!0?r=o<0?"up":"down":c.up===!0&&o<0?(r="up",a>l&&(c.left===!0&&s<0?r="left":c.right===!0&&s>0&&(r="right"))):c.down===!0&&o>0?(r="down",a>l&&(c.left===!0&&s<0?r="left":c.right===!0&&s>0&&(r="right"))):c.left===!0&&s<0?(r="left",a<l&&(c.up===!0&&o<0?r="up":c.down===!0&&o>0&&(r="down"))):c.right===!0&&s>0&&(r="right",a<l&&(c.up===!0&&o<0?r="up":c.down===!0&&o>0&&(r="down")));let u=!1;if(r===void 0&&n===!1){if(e.event.isFirst===!0||e.event.lastDir===void 0)return{};r=e.event.lastDir,u=!0,r==="left"||r==="right"?(i.left-=s,a=0,s=0):(i.top-=o,l=0,o=0)}return{synthetic:u,payload:{evt:t,touch:e.event.mouse!==!0,mouse:e.event.mouse===!0,position:i,direction:r,isFirst:e.event.isFirst,isFinal:n===!0,duration:Date.now()-e.event.time,distance:{x:a,y:l},offset:{x:s,y:o},delta:{x:i.left-e.event.lastX,y:i.top-e.event.lastY}}}}let c9=0;const np=Ey({name:"touch-pan",beforeMount(t,{value:e,modifiers:n}){if(n.mouse!==!0&&Je.has.touch!==!0)return;function i(s,o){n.mouse===!0&&o===!0?Rn(s):(n.stop===!0&&Er(s),n.prevent===!0&&Jn(s))}const r={uid:"qvtp_"+c9++,handler:e,modifiers:n,direction:Vb(n),noop:Fr,mouseStart(s){zb(s,r)&&D4(s)&&(Ja(r,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),r.start(s,!0))},touchStart(s){if(zb(s,r)){const o=s.target;Ja(r,"temp",[[o,"touchmove","move","notPassiveCapture"],[o,"touchcancel","end","passiveCapture"],[o,"touchend","end","passiveCapture"]]),r.start(s)}},start(s,o){if(Je.is.firefox===!0&&Wf(t,!0),r.lastEvt=s,o===!0||n.stop===!0){if(r.direction.all!==!0&&(o!==!0||r.modifiers.mouseAllDir!==!0&&r.modifiers.mousealldir!==!0)){const c=s.type.indexOf("mouse")>-1?new MouseEvent(s.type,s):new TouchEvent(s.type,s);s.defaultPrevented===!0&&Jn(c),s.cancelBubble===!0&&Er(c),Object.assign(c,{qKeyEvent:s.qKeyEvent,qClickOutside:s.qClickOutside,qAnchorHandled:s.qAnchorHandled,qClonedBy:s.qClonedBy===void 0?[r.uid]:s.qClonedBy.concat(r.uid)}),r.initialEvent={target:s.target,event:c}}Er(s)}const{left:a,top:l}=Dh(s);r.event={x:a,y:l,time:Date.now(),mouse:o===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:a,lastY:l}},move(s){if(r.event===void 0)return;const o=Dh(s),a=o.left-r.event.x,l=o.top-r.event.y;if(a===0&&l===0)return;r.lastEvt=s;const c=r.event.mouse===!0,u=()=>{i(s,c);let f;n.preserveCursor!==!0&&n.preservecursor!==!0&&(f=document.documentElement.style.cursor||"",document.documentElement.style.cursor="grabbing"),c===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),l9(),r.styleCleanup=p=>{if(r.styleCleanup=void 0,f!==void 0&&(document.documentElement.style.cursor=f),document.body.classList.remove("non-selectable"),c===!0){const m=()=>{document.body.classList.remove("no-pointer-events--children")};p!==void 0?setTimeout(()=>{m(),p()},50):m()}else p!==void 0&&p()}};if(r.event.detected===!0){r.event.isFirst!==!0&&i(s,r.event.mouse);const{payload:f,synthetic:p}=tp(s,r,!1);f!==void 0&&(r.handler(f)===!1?r.end(s):(r.styleCleanup===void 0&&r.event.isFirst===!0&&u(),r.event.lastX=f.position.left,r.event.lastY=f.position.top,r.event.lastDir=p===!0?void 0:f.direction,r.event.isFirst=!1));return}if(r.direction.all===!0||c===!0&&(r.modifiers.mouseAllDir===!0||r.modifiers.mousealldir===!0)){u(),r.event.detected=!0,r.move(s);return}const h=Math.abs(a),d=Math.abs(l);h!==d&&(r.direction.horizontal===!0&&h>d||r.direction.vertical===!0&&h<d||r.direction.up===!0&&h<d&&l<0||r.direction.down===!0&&h<d&&l>0||r.direction.left===!0&&h>d&&a<0||r.direction.right===!0&&h>d&&a>0?(r.event.detected=!0,r.move(s)):r.end(s,!0))},end(s,o){if(r.event!==void 0){if(Fu(r,"temp"),Je.is.firefox===!0&&Wf(t,!1),o===!0)r.styleCleanup!==void 0&&r.styleCleanup(),r.event.detected!==!0&&r.initialEvent!==void 0&&r.initialEvent.target.dispatchEvent(r.initialEvent.event);else if(r.event.detected===!0){r.event.isFirst===!0&&r.handler(tp(s===void 0?r.lastEvt:s,r).payload);const{payload:a}=tp(s===void 0?r.lastEvt:s,r,!0),l=()=>{r.handler(a)};r.styleCleanup!==void 0?r.styleCleanup(l):l()}r.event=void 0,r.initialEvent=void 0,r.lastEvt=void 0}}};if(t.__qtouchpan=r,n.mouse===!0){const s=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Ja(r,"main",[[t,"mousedown","mouseStart",`passive${s}`]])}Je.has.touch===!0&&Ja(r,"main",[[t,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[t,"touchmove","noop","notPassiveCapture"]])},updated(t,e){const n=t.__qtouchpan;n!==void 0&&(e.oldValue!==e.value&&(typeof value!="function"&&n.end(),n.handler=e.value),n.direction=Vb(e.modifiers))},beforeUnmount(t){const e=t.__qtouchpan;e!==void 0&&(e.event!==void 0&&e.end(),Fu(e,"main"),Fu(e,"temp"),Je.is.firefox===!0&&Wf(t,!1),e.styleCleanup!==void 0&&e.styleCleanup(),delete t.__qtouchpan)}}),jb=["B","KB","MB","GB","TB","PB"];function u9(t){let e=0;for(;parseInt(t,10)>=1024&&e<jb.length-1;)t/=1024,++e;return`${t.toFixed(1)}${jb[e]}`}function wu(t,e,n){return n<=e?e:Math.min(n,Math.max(e,t))}const Hb=150,h9=Ze({name:"QDrawer",inheritAttrs:!1,props:{...ZA,...to,side:{type:String,default:"left",validator:t=>["left","right"].includes(t)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:t=>["default","desktop","mobile"].includes(t),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...eR,"onLayout","miniState"],setup(t,{slots:e,emit:n,attrs:i}){const r=je(),{proxy:{$q:s}}=r,o=no(t,s),{preventBodyScroll:a}=sR(),{registerTimeout:l,removeTimeout:c}=JA(),u=Ft($c,jn);if(u===jn)return console.error("QDrawer needs to be child of QLayout"),jn;let h,d=null,f;const p=ae(t.behavior==="mobile"||t.behavior!=="desktop"&&u.totalWidth.value<=t.breakpoint),m=I(()=>t.mini===!0&&p.value!==!0),g=I(()=>m.value===!0?t.miniWidth:t.width),w=ae(t.showIfAbove===!0&&p.value===!1?!0:t.modelValue===!0),v=I(()=>t.persistent!==!0&&(p.value===!0||ye.value===!0));function b(O,G){if(B(),O!==!1&&u.animate(),_(0),p.value===!0){const ce=u.instances[ie.value];ce!==void 0&&ce.belowBreakpoint===!0&&ce.hide(!1),T(1),u.isContainer.value!==!0&&a(!0)}else T(0),O!==!1&&F(!1);l(()=>{O!==!1&&F(!0),G!==!0&&n("show",O)},Hb)}function E(O,G){N(),O!==!1&&u.animate(),T(0),_(V.value*g.value),W(),G!==!0?l(()=>{n("hide",O)},Hb):c()}const{show:P,hide:C}=tR({showing:w,hideOnRouteChange:v,handleShow:b,handleHide:E}),{addToHistory:B,removeFromHistory:N}=XA(w,C,v),S={belowBreakpoint:p,hide:C},k=I(()=>t.side==="right"),V=I(()=>(s.lang.rtl===!0?-1:1)*(k.value===!0?1:-1)),R=ae(0),X=ae(!1),$=ae(!1),le=ae(g.value*V.value),ie=I(()=>k.value===!0?"left":"right"),A=I(()=>w.value===!0&&p.value===!1&&t.overlay===!1?t.miniToOverlay===!0?t.miniWidth:g.value:0),Q=I(()=>t.overlay===!0||t.miniToOverlay===!0||u.view.value.indexOf(k.value?"R":"L")>-1||s.platform.is.ios===!0&&u.isContainer.value===!0),Ce=I(()=>t.overlay===!1&&w.value===!0&&p.value===!1),ye=I(()=>t.overlay===!0&&w.value===!0&&p.value===!1),ke=I(()=>"fullscreen q-drawer__backdrop"+(w.value===!1&&X.value===!1?" hidden":"")),j=I(()=>({backgroundColor:`rgba(0,0,0,${R.value*.4})`})),xe=I(()=>k.value===!0?u.rows.value.top[2]==="r":u.rows.value.top[0]==="l"),Et=I(()=>k.value===!0?u.rows.value.bottom[2]==="r":u.rows.value.bottom[0]==="l"),me=I(()=>{const O={};return u.header.space===!0&&xe.value===!1&&(Q.value===!0?O.top=`${u.header.offset}px`:u.header.space===!0&&(O.top=`${u.header.size}px`)),u.footer.space===!0&&Et.value===!1&&(Q.value===!0?O.bottom=`${u.footer.offset}px`:u.footer.space===!0&&(O.bottom=`${u.footer.size}px`)),O}),pe=I(()=>{const O={width:`${g.value}px`,transform:`translateX(${le.value}px)`};return p.value===!0?O:Object.assign(O,me.value)}),L=I(()=>"q-drawer__content fit "+(u.isContainer.value!==!0?"scroll":"overflow-auto")),se=I(()=>`q-drawer q-drawer--${t.side}`+($.value===!0?" q-drawer--mini-animate":"")+(t.bordered===!0?" q-drawer--bordered":"")+(o.value===!0?" q-drawer--dark q-dark":"")+(X.value===!0?" no-transition":w.value===!0?"":" q-layout--prevent-focus")+(p.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${m.value===!0?"mini":"standard"}`+(Q.value===!0||Ce.value!==!0?" fixed":"")+(t.overlay===!0||t.miniToOverlay===!0?" q-drawer--on-top":"")+(xe.value===!0?" q-drawer--top-padding":""))),J=I(()=>{const O=s.lang.rtl===!0?t.side:ie.value;return[[np,H,void 0,{[O]:!0,mouse:!0}]]}),de=I(()=>{const O=s.lang.rtl===!0?ie.value:t.side;return[[np,re,void 0,{[O]:!0,mouse:!0}]]}),$e=I(()=>{const O=s.lang.rtl===!0?ie.value:t.side;return[[np,re,void 0,{[O]:!0,mouse:!0,mouseAllDir:!0}]]});function y(){K(p,t.behavior==="mobile"||t.behavior!=="desktop"&&u.totalWidth.value<=t.breakpoint)}ge(p,O=>{O===!0?(h=w.value,w.value===!0&&C(!1)):t.overlay===!1&&t.behavior!=="mobile"&&h!==!1&&(w.value===!0?(_(0),T(0),W()):P(!1))}),ge(()=>t.side,(O,G)=>{u.instances[G]===S&&(u.instances[G]=void 0,u[G].space=!1,u[G].offset=0),u.instances[O]=S,u[O].size=g.value,u[O].space=Ce.value,u[O].offset=A.value}),ge(u.totalWidth,()=>{(u.isContainer.value===!0||document.qScrollPrevented!==!0)&&y()}),ge(()=>t.behavior+t.breakpoint,y),ge(u.isContainer,O=>{w.value===!0&&a(O!==!0),O===!0&&y()}),ge(u.scrollbarWidth,()=>{_(w.value===!0?0:void 0)}),ge(A,O=>{Y("offset",O)}),ge(Ce,O=>{n("onLayout",O),Y("space",O)}),ge(k,()=>{_()}),ge(g,O=>{_(),fe(t.miniToOverlay,O)}),ge(()=>t.miniToOverlay,O=>{fe(O,g.value)}),ge(()=>s.lang.rtl,()=>{_()}),ge(()=>t.mini,()=>{t.noMiniAnimation||t.modelValue===!0&&(q(),u.animate())}),ge(m,O=>{n("miniState",O)});function _(O){O===void 0?sn(()=>{O=w.value===!0?0:g.value,_(V.value*O)}):(u.isContainer.value===!0&&k.value===!0&&(p.value===!0||Math.abs(O)===g.value)&&(O+=V.value*u.scrollbarWidth.value),le.value=O)}function T(O){R.value=O}function F(O){const G=O===!0?"remove":u.isContainer.value!==!0?"add":"";G!==""&&document.body.classList[G]("q-body--drawer-toggle")}function q(){d!==null&&clearTimeout(d),r.proxy&&r.proxy.$el&&r.proxy.$el.classList.add("q-drawer--mini-animate"),$.value=!0,d=setTimeout(()=>{d=null,$.value=!1,r&&r.proxy&&r.proxy.$el&&r.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function H(O){if(w.value!==!1)return;const G=g.value,ce=wu(O.distance.x,0,G);if(O.isFinal===!0){ce>=Math.min(75,G)===!0?P():(u.animate(),T(0),_(V.value*G)),X.value=!1;return}_((s.lang.rtl===!0?k.value!==!0:k.value)?Math.max(G-ce,0):Math.min(0,ce-G)),T(wu(ce/G,0,1)),O.isFirst===!0&&(X.value=!0)}function re(O){if(w.value!==!0)return;const G=g.value,ce=O.direction===t.side,Te=(s.lang.rtl===!0?ce!==!0:ce)?wu(O.distance.x,0,G):0;if(O.isFinal===!0){Math.abs(Te)<Math.min(75,G)===!0?(u.animate(),T(1),_(0)):C(),X.value=!1;return}_(V.value*Te),T(wu(1-Te/G,0,1)),O.isFirst===!0&&(X.value=!0)}function W(){a(!1),F(!0)}function Y(O,G){u.update(t.side,O,G)}function K(O,G){O.value!==G&&(O.value=G)}function fe(O,G){Y("size",O===!0?t.miniWidth:G)}return u.instances[t.side]=S,fe(t.miniToOverlay,g.value),Y("space",Ce.value),Y("offset",A.value),t.showIfAbove===!0&&t.modelValue!==!0&&w.value===!0&&t["onUpdate:modelValue"]!==void 0&&n("update:modelValue",!0),Hn(()=>{n("onLayout",Ce.value),n("miniState",m.value),h=t.showIfAbove===!0;const O=()=>{(w.value===!0?b:E)(!1,!0)};if(u.totalWidth.value!==0){sn(O);return}f=ge(u.totalWidth,()=>{f(),f=void 0,w.value===!1&&t.showIfAbove===!0&&p.value===!1?P(!1):O()})}),Xt(()=>{f!==void 0&&f(),d!==null&&(clearTimeout(d),d=null),w.value===!0&&W(),u.instances[t.side]===S&&(u.instances[t.side]=void 0,Y("size",0),Y("offset",0),Y("space",!1))}),()=>{const O=[];p.value===!0&&(t.noSwipeOpen===!1&&O.push(Bo(M("div",{key:"open",class:`q-drawer__opener fixed-${t.side}`,"aria-hidden":"true"}),J.value)),O.push(Mm("div",{ref:"backdrop",class:ke.value,style:j.value,"aria-hidden":"true",onClick:C},void 0,"backdrop",t.noSwipeBackdrop!==!0&&w.value===!0,()=>$e.value)));const G=m.value===!0&&e.mini!==void 0,ce=[M("div",{...i,key:""+G,class:[L.value,i.class]},G===!0?e.mini():Lt(e.default))];return t.elevated===!0&&w.value===!0&&ce.push(M("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),O.push(Mm("aside",{ref:"content",class:se.value,style:pe.value},ce,"contentclose",t.noSwipeClose!==!0&&p.value===!0,()=>de.value)),M("div",{class:"q-drawer-container"},O)}}}),d9=Ze({name:"QPageContainer",setup(t,{slots:e}){const{proxy:{$q:n}}=je(),i=Ft($c,jn);if(i===jn)return console.error("QPageContainer needs to be child of QLayout"),jn;ko(iH,!0);const r=I(()=>{const s={};return i.header.space===!0&&(s.paddingTop=`${i.header.size}px`),i.right.space===!0&&(s[`padding${n.lang.rtl===!0?"Left":"Right"}`]=`${i.right.size}px`),i.footer.space===!0&&(s.paddingBottom=`${i.footer.size}px`),i.left.space===!0&&(s[`padding${n.lang.rtl===!0?"Right":"Left"}`]=`${i.left.size}px`),s});return()=>M("div",{class:"q-page-container",style:r.value},Lt(e.default))}}),{passive:Kb}=Ht,f9=["both","horizontal","vertical"],p9=Ze({name:"QScrollObserver",props:{axis:{type:String,validator:t=>f9.includes(t),default:"vertical"},debounce:[String,Number],scrollTarget:{default:void 0}},emits:["scroll"],setup(t,{emit:e}){const n={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let i=null,r,s;ge(()=>t.scrollTarget,()=>{l(),a()});function o(){i!==null&&i();const h=Math.max(0,iR(r)),d=rR(r),f={top:h-n.position.top,left:d-n.position.left};if(t.axis==="vertical"&&f.top===0||t.axis==="horizontal"&&f.left===0)return;const p=Math.abs(f.top)>=Math.abs(f.left)?f.top<0?"up":"down":f.left<0?"left":"right";n.position={top:h,left:d},n.directionChanged=n.direction!==p,n.delta=f,n.directionChanged===!0&&(n.direction=p,n.inflectionPoint=n.position),e("scroll",{...n})}function a(){r=GH(s,t.scrollTarget),r.addEventListener("scroll",c,Kb),c(!0)}function l(){r!==void 0&&(r.removeEventListener("scroll",c,Kb),r=void 0)}function c(h){if(h===!0||t.debounce===0||t.debounce==="0")o();else if(i===null){const[d,f]=t.debounce?[setTimeout(o,t.debounce),clearTimeout]:[requestAnimationFrame(o),cancelAnimationFrame];i=()=>{f(d),i=null}}}const{proxy:u}=je();return ge(()=>u.$q.lang.rtl,o),Hn(()=>{s=u.$el.parentNode,a()}),Xt(()=>{i!==null&&i(),l()}),Object.assign(u,{trigger:c,getPosition:()=>n}),Fr}}),m9=Ze({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:t=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(t.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=je(),r=ae(null),s=ae(i.screen.height),o=ae(t.container===!0?0:i.screen.width),a=ae({position:0,direction:"down",inflectionPoint:0}),l=ae(0),c=ae(Di.value===!0?0:Xf()),u=I(()=>"q-layout q-layout--"+(t.container===!0?"containerized":"standard")),h=I(()=>t.container===!1?{minHeight:i.screen.height+"px"}:null),d=I(()=>c.value!==0?{[i.lang.rtl===!0?"left":"right"]:`${c.value}px`}:null),f=I(()=>c.value!==0?{[i.lang.rtl===!0?"right":"left"]:0,[i.lang.rtl===!0?"left":"right"]:`-${c.value}px`,width:`calc(100% + ${c.value}px)`}:null);function p(E){if(t.container===!0||document.qScrollPrevented!==!0){const P={position:E.position.top,direction:E.direction,directionChanged:E.directionChanged,inflectionPoint:E.inflectionPoint.top,delta:E.delta.top};a.value=P,t.onScroll!==void 0&&n("scroll",P)}}function m(E){const{height:P,width:C}=E;let B=!1;s.value!==P&&(B=!0,s.value=P,t.onScrollHeight!==void 0&&n("scrollHeight",P),w()),o.value!==C&&(B=!0,o.value=C),B===!0&&t.onResize!==void 0&&n("resize",E)}function g({height:E}){l.value!==E&&(l.value=E,w())}function w(){if(t.container===!0){const E=s.value>l.value?Xf():0;c.value!==E&&(c.value=E)}}let v=null;const b={instances:{},view:I(()=>t.view),isContainer:I(()=>t.container),rootRef:r,height:s,containerHeight:l,scrollbarWidth:c,totalWidth:I(()=>o.value+c.value),rows:I(()=>{const E=t.view.toLowerCase().split(" ");return{top:E[0].split(""),middle:E[1].split(""),bottom:E[2].split("")}}),header:qn({size:0,offset:0,space:!1}),right:qn({size:300,offset:0,space:!1}),footer:qn({size:0,offset:0,space:!1}),left:qn({size:300,offset:0,space:!1}),scroll:a,animate(){v!==null?clearTimeout(v):document.body.classList.add("q-body--layout-animate"),v=setTimeout(()=>{v=null,document.body.classList.remove("q-body--layout-animate")},155)},update(E,P,C){b[E][P]=C}};if(ko($c,b),Xf()>0){let C=function(){E=null,P.classList.remove("hide-scrollbar")},B=function(){if(E===null){if(P.scrollHeight>i.screen.height)return;P.classList.add("hide-scrollbar")}else clearTimeout(E);E=setTimeout(C,300)},N=function(S){E!==null&&S==="remove"&&(clearTimeout(E),C()),window[`${S}EventListener`]("resize",B)},E=null;const P=document.body;ge(()=>t.container!==!0?"add":"remove",N),t.container!==!0&&N("add"),Qh(()=>{N("remove")})}return()=>{const E=Eo(e.default,[M(p9,{onScroll:p}),M(Fm,{onResize:m})]),P=M("div",{class:u.value,style:h.value,ref:t.container===!0?void 0:r,tabindex:-1},E);return t.container===!0?M("div",{class:"q-layout-container overflow-hidden",ref:r},[M(Fm,{onResize:g}),M("div",{class:"absolute-full",style:d.value},[M("div",{class:"scroll",style:f.value},[P])])]):P}}});function Wb(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const e=parseInt(t,10);return isNaN(e)?0:e}const Gb=Ey({name:"close-popup",beforeMount(t,{value:e}){const n={depth:Wb(e),handler(i){n.depth!==0&&setTimeout(()=>{const r=VH(t);r!==void 0&&jH(r,i,n.depth)})},handlerKey(i){ra(i,13)===!0&&n.handler(i)}};t.__qclosepopup=n,t.addEventListener("click",n.handler),t.addEventListener("keyup",n.handlerKey)},updated(t,{value:e,oldValue:n}){e!==n&&(t.__qclosepopup.depth=Wb(e))},beforeUnmount(t){const e=t.__qclosepopup;t.removeEventListener("click",e.handler),t.removeEventListener("keyup",e.handlerKey),delete t.__qclosepopup}}),g9="/assets/logo-c892da48.png",ip=Ze({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(t,{slots:e}){const n=I(()=>`q-item__section column q-item__section--${t.avatar===!0||t.side===!0||t.thumbnail===!0?"side":"main"}`+(t.top===!0?" q-item__section--top justify-start":" justify-center")+(t.avatar===!0?" q-item__section--avatar":"")+(t.thumbnail===!0?" q-item__section--thumbnail":"")+(t.noWrap===!0?" q-item__section--nowrap":""));return()=>M("div",{class:n.value},Lt(e.default))}}),rp=Ze({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(t,{slots:e}){const n=I(()=>parseInt(t.lines,10)),i=I(()=>"q-item__label"+(t.overline===!0?" q-item__label--overline text-overline":"")+(t.caption===!0?" q-item__label--caption text-caption":"")+(t.header===!0?" q-item__label--header":"")+(n.value===1?" ellipsis":"")),r=I(()=>t.lines!==void 0&&n.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":n.value}:null);return()=>M("div",{style:r.value,class:i.value},Lt(e.default))}}),v9=Ze({name:"QItem",props:{...to,...MA,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=je(),r=no(t,i),{hasLink:s,linkAttrs:o,linkClass:a,linkTag:l,navigateOnClick:c}=LA(),u=ae(null),h=ae(null),d=I(()=>t.clickable===!0||s.value===!0||t.tag==="label"),f=I(()=>t.disable!==!0&&d.value===!0),p=I(()=>"q-item q-item-type row no-wrap"+(t.dense===!0?" q-item--dense":"")+(r.value===!0?" q-item--dark":"")+(s.value===!0&&t.active===null?a.value:t.active===!0?` q-item--active${t.activeClass!==void 0?` ${t.activeClass}`:""}`:"")+(t.disable===!0?" disabled":"")+(f.value===!0?" q-item--clickable q-link cursor-pointer "+(t.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(t.focused===!0?" q-manual-focusable--focused":""):"")),m=I(()=>t.insetLevel===void 0?null:{["padding"+(i.lang.rtl===!0?"Right":"Left")]:16+t.insetLevel*56+"px"});function g(b){f.value===!0&&(h.value!==null&&(b.qKeyEvent!==!0&&document.activeElement===u.value?h.value.focus():document.activeElement===h.value&&u.value.focus()),c(b))}function w(b){if(f.value===!0&&ra(b,13)===!0){Rn(b),b.qKeyEvent=!0;const E=new MouseEvent("click",b);E.qKeyEvent=!0,u.value.dispatchEvent(E)}n("keyup",b)}function v(){const b=EA(e.default,[]);return f.value===!0&&b.unshift(M("div",{class:"q-focus-helper",tabindex:-1,ref:h})),b}return()=>{const b={ref:u,class:p.value,style:m.value,role:"listitem",onClick:g,onKeyup:w};return f.value===!0?(b.tabindex=t.tabindex||"0",Object.assign(b,o.value)):d.value===!0&&(b["aria-disabled"]="true"),M(l.value,b,v())}}}),y9=["src"],_9={__name:"Profile",props:{email:String},setup(t){const e=t,i=Tg()._rawValue;let r=ae(""),s=qn({}),o;const a=async()=>{const c=xn(or,Lo("email","==",e.email));r.value=(await zi(c)).docs[0].data(),o=(await zi(c)).docs[0].id,l()},l=async()=>{let c=mn(Xl,`${i.providerData[0].uid+o}`);(await Lc(c)).exists()||(c=mn(Xl,`${o+i.providerData[0].uid}`)),s.value=lA(Us(c,"messages"))};return a(),(c,u)=>{const h=KE("router-link");return Ke(),vt(h,{to:"/chat/"+t.email},{default:qe(()=>[Bo((Ke(),vt(v9,{clickable:""},{default:qe(()=>[Ee(ip,{avatar:""},{default:qe(()=>[Ee(Sy,null,{default:qe(()=>[Ae(r)?(Ke(),mr("img",{key:0,src:Ae(r).photoURL},null,8,y9)):At("",!0)]),_:1})]),_:1}),Ee(ip,null,{default:qe(()=>[Ee(rp,null,{default:qe(()=>[_r(el(Ae(r).name),1)]),_:1}),Ae(s).value&&Ae(s).value.length>0?(Ke(),vt(rp,{key:0,caption:""},{default:qe(()=>[_r(el(Ae(s).value.at(-1).message?Ae(s).value.at(-1).message:"Image"),1)]),_:1})):At("",!0)]),_:1}),Ee(ip,null,{default:qe(()=>[Ae(s).value&&Ae(s).value.length>0?(Ke(),vt(rp,{key:0,caption:""},{default:qe(()=>[_r(el(new Date(Ae(s).value.at(-1).time.seconds*1e3).toLocaleString().split(",")[1]),1)]),_:1})):At("",!0)]),_:1})]),_:1})),[[Ty]])]),_:1},8,["to"])}}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(e,n){this._delegate=e,this.firebase=n,Qu(e,new Pn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),CI(this._delegate)))}_getService(e,n=Sr){var i;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((i=r.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Sr){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Qu(this._delegate,e)}_addOrOverwriteComponent(e){SI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b9={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Qb=new Br("app-compat","Firebase",b9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E9(t){const e={},n={__esModule:!0,initializeApp:s,app:r,registerVersion:an,setLogLevel:xI,onLog:kI,apps:null,SDK_VERSION:Oi,INTERNAL:{registerComponent:a,removeApp:i,useAsService:l,modularAPIs:_O}};n.default=n,Object.defineProperty(n,"apps",{get:o});function i(c){delete e[c]}function r(c){if(c=c||Sr,!si(e,c))throw Qb.create("no-app",{appName:c});return e[c]}r.App=t;function s(c,u={}){const h=nd(c,u);if(si(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const u=c.name,h=u.replace("-compat","");if(Kn(c)&&c.type==="PUBLIC"){const d=(f=r())=>{if(typeof f[h]!="function")throw Qb.create("invalid-app-argument",{appName:u});return f[h]()};c.serviceProps!==void 0&&Tl(d,c.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,c.multipleInstances?f:[])}}return c.type==="PUBLIC"?n[h]:null}function l(c,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(){const t=E9(w9);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:lR,extendNamespace:e,createSubscribe:bI,ErrorFactory:Br,deepExtend:Tl});function e(n){Tl(t,n)}return t}const I9=lR();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new ha("@firebase/app-compat"),T9="@firebase/app-compat",S9="0.2.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C9(t){an(T9,S9,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(YN()&&self.firebase!==void 0){Yb.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Yb.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const xy=I9;C9();var k9="firebase",x9="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xy.registerVersion(k9,x9,"app-compat");const A9="@firebase/firestore-compat",R9="0.3.12";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new U("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(){if(typeof Uint8Array>"u")throw new U("unimplemented","Uint8Arrays are not available in this environment.")}function Jb(){if(!Cq())throw new U("unimplemented","Blobs are unavailable in Firestore in this environment.")}let cR=class qm{constructor(e){this._delegate=e}static fromBase64String(e){return Jb(),new qm(Ni.fromBase64String(e))}static fromUint8Array(e){return Xb(),new qm(Ni.fromUint8Array(e))}toBase64(){return Jb(),this._delegate.toBase64()}toUint8Array(){return Xb(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t){return N9(t,["next","error","complete"])}function N9(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const i of e)if(i in n&&typeof n[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D9{enableIndexedDbPersistence(e,n){return e2(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return t2(e._delegate)}clearIndexedDbPersistence(e){return n2(e._delegate)}}class uR{constructor(e,n,i){this._delegate=n,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Nr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&li("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,i={}){Sx(this._delegate,e,n,i)}enableNetwork(){return r2(this._delegate)}disableNetwork(){return s2(this._delegate)}enablePersistence(e){let n=!1,i=!1;return e&&(n=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Ix("synchronizeTabs",n,"experimentalForceOwningTab",i)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return i2(this._delegate)}onSnapshotsInSync(e){return N2(this._delegate,e)}get app(){if(!this._appCompat)throw new U("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new oa(this,Us(this._delegate,e))}catch(n){throw fn(n,"collection()","Firestore.collection()")}}doc(e){try{return new Vn(this,mn(this._delegate,e))}catch(n){throw fn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new dn(this,QV(this._delegate,e))}catch(n){throw fn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return M2(this._delegate,n=>e(new hR(this,n)))}batch(){return Vt(this._delegate),new dR(new O2(this._delegate,e=>Bc(this._delegate,e)))}loadBundle(e){return o2(this._delegate,e)}namedQuery(e){return a2(this._delegate,e).then(n=>n?new dn(this,n):null)}}class Jd extends hy{constructor(e){super(),this.firestore=e}convertBytes(e){return new cR(new Ni(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Vn.forKey(n,this.firestore,null)}}function O9(t){K$(t)}class hR{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Jd(e)}get(e){const n=ms(e);return this._delegate.get(n).then(i=>new tc(this._firestore,new Wi(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,n.converter)))}set(e,n,i){const r=ms(e);return i?(Ay("Transaction.set",i),this._delegate.set(r,n,i)):this._delegate.set(r,n),this}update(e,n,i,...r){const s=ms(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,i,...r),this}delete(e){const n=ms(e);return this._delegate.delete(n),this}}class dR{constructor(e){this._delegate=e}set(e,n,i){const r=ms(e);return i?(Ay("WriteBatch.set",i),this._delegate.set(r,n,i)):this._delegate.set(r,n),this}update(e,n,i,...r){const s=ms(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,i,...r),this}delete(e){const n=ms(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class zs{constructor(e,n,i){this._firestore=e,this._userDataWriter=n,this._delegate=i}fromFirestore(e,n){const i=new pl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new nc(this._firestore,i),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const i=zs.INSTANCES;let r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(n);return s||(s=new zs(e,new Jd(e),n),r.set(n,s)),s}}zs.INSTANCES=new WeakMap;class Vn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Jd(e)}static forPath(e,n,i){if(e.length%2!==0)throw new U("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Vn(n,new lt(n._delegate,i,new Z(e)))}static forKey(e,n,i){return new Vn(n,new lt(n._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new oa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new oa(this.firestore,Us(this._delegate,e))}catch(n){throw fn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ve(e),e instanceof lt?Cx(this._delegate,e):!1}set(e,n){n=Ay("DocumentReference.set",n);try{return n?Es(this._delegate,e,n):Es(this._delegate,e)}catch(i){throw fn(i,"setDoc()","DocumentReference.set()")}}update(e,n,...i){try{return arguments.length===1?Ah(this._delegate,e):Ah(this._delegate,e,n,...i)}catch(r){throw fn(r,"updateDoc()","DocumentReference.update()")}}delete(){return A2(this._delegate)}onSnapshot(...e){const n=fR(e),i=pR(e,r=>new tc(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Fc(this._delegate,n,i)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=S2(this._delegate):(e==null?void 0:e.source)==="server"?n=C2(this._delegate):n=Lc(this._delegate),n.then(i=>new tc(this.firestore,new Wi(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new Vn(this.firestore,e?this._delegate.withConverter(zs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function fn(t,e,n){return t.message=t.message.replace(e,n),t}function fR(t){for(const e of t)if(typeof e=="object"&&!Um(e))return e;return{}}function pR(t,e){var n,i;let r;return Um(t[0])?r=t[0]:Um(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:s=>{r.next&&r.next(e(s))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}class tc{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Vn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Vx(this._delegate,e._delegate)}}class nc extends tc{data(e){const n=this._delegate.data(e);return W$(n!==void 0),n}}class dn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Jd(e)}where(e,n,i){try{return new dn(this.firestore,xn(this._delegate,Lo(e,n,i)))}catch(r){throw fn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new dn(this.firestore,xn(this._delegate,g2(e,n)))}catch(i){throw fn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new dn(this.firestore,xn(this._delegate,v2(e)))}catch(n){throw fn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new dn(this.firestore,xn(this._delegate,y2(e)))}catch(n){throw fn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new dn(this.firestore,xn(this._delegate,_2(...e)))}catch(n){throw fn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new dn(this.firestore,xn(this._delegate,w2(...e)))}catch(n){throw fn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new dn(this.firestore,xn(this._delegate,b2(...e)))}catch(n){throw fn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new dn(this.firestore,xn(this._delegate,E2(...e)))}catch(n){throw fn(n,"endAt()","Query.endAt()")}}isEqual(e){return kx(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=k2(this._delegate):(e==null?void 0:e.source)==="server"?n=x2(this._delegate):n=zi(this._delegate),n.then(i=>new Vm(this.firestore,new Lr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const n=fR(e),i=pR(e,r=>new Vm(this.firestore,new Lr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Fc(this._delegate,n,i)}withConverter(e){return new dn(this.firestore,e?this._delegate.withConverter(zs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class P9{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new nc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Vm{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new dn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new nc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new P9(this._firestore,n))}forEach(e,n){this._delegate.forEach(i=>{e.call(n,new nc(this._firestore,i))})}isEqual(e){return Vx(this._delegate,e._delegate)}}class oa extends dn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Vn(this.firestore,e):null}doc(e){try{return e===void 0?new Vn(this.firestore,mn(this._delegate)):new Vn(this.firestore,mn(this._delegate,e))}catch(n){throw fn(n,"doc()","CollectionReference.doc()")}}add(e){return R2(this._delegate,e).then(n=>new Vn(this.firestore,n))}isEqual(e){return Cx(this._delegate,e._delegate)}withConverter(e){return new oa(this.firestore,e?this._delegate.withConverter(zs.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ms(t){return Be(t,lt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(...e){this._delegate=new Mr(...e)}static documentId(){return new Ry(_t.keyField().canonicalString())}isEqual(e){return e=Ve(e),e instanceof Mr?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this._delegate=e}static serverTimestamp(){const e=Lu();return e._methodName="FieldValue.serverTimestamp",new ls(e)}static delete(){const e=L2();return e._methodName="FieldValue.delete",new ls(e)}static arrayUnion(...e){const n=F2(...e);return n._methodName="FieldValue.arrayUnion",new ls(n)}static arrayRemove(...e){const n=B2(...e);return n._methodName="FieldValue.arrayRemove",new ls(n)}static increment(e){const n=$2(e);return n._methodName="FieldValue.increment",new ls(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9={Firestore:uR,GeoPoint:Oc,Timestamp:ot,Blob:cR,Transaction:hR,WriteBatch:dR,DocumentReference:Vn,DocumentSnapshot:tc,Query:dn,QueryDocumentSnapshot:nc,QuerySnapshot:Vm,CollectionReference:oa,FieldPath:Ry,FieldValue:ls,setLogLevel:O9,CACHE_SIZE_UNLIMITED:JV};function L9(t,e){t.INTERNAL.registerComponent(new Pn("firestore-compat",n=>{const i=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},M9)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9(t){L9(t,(e,n)=>new uR(e,n,new D9)),t.registerVersion(A9,R9)}F9(xy);const B9=pn("img",{src:g9},null,-1),$9={key:10,class:"bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4",role:"alert"},q9=pn("p",{class:"font-bold"},"Be Warned!",-1),U9=pn("div",{class:"text-h6"},"Enter your friend's email address to chat with him/her.",-1),V9={__name:"HomeView",setup(t){Hn(async()=>{const p=await yf();setTimeout(()=>{p?o.value.length==0&&(c.value=!0):l.value="You should Log in to chat."},5e3),await Es(mn(or,p.providerData[0].uid),{name:p.providerData[0].displayName,email:p.providerData[0].email,photoURL:p.providerData[0].photoURL},{merge:!0}),f()});const e=Tg(),n=ae(!0),i=ae(!1),r=ae(""),s=pT(),o=ae([]),a=_4(),l=ae(""),c=ae(!1),u=()=>{aP(s),a.push("/login")},h=()=>{n.value=!n.value},d=async p=>{const m=await yf(),g=xy.firestore.FieldValue.arrayUnion,w=xn(or,Lo("email","==",p)),v=(await zi(w)).docs;v.length!=0&&(await Ah(mn(or,m.providerData[0].uid),{chatWith:g(p)}),await Ah(mn(or,v[0].id),{chatWith:g(m.providerData[0].email)}),await Es(mn(Xl,m.providerData[0].uid+v[0].id),{name:m.providerData[0].displayName+v[0].data().name},{merge:!0}))},f=async()=>{const p=await yf(),m=xn(or,Lo("email","==",p.providerData[0].email)),w=await(await zi(m)).docs[0].data().chatWith;o.value=[],w.forEach(async v=>{const b=xn(or,Lo("email","==",v)),E=(await zi(b)).docs[0].data();o.value.push(E)})};return(p,m)=>(Ke(),vt(m9,{view:"hHh lpR fFf",class:"bg-green-100"},{default:qe(()=>[Ee(sH,{elevated:"",class:"bg-positive text-white"},{default:qe(()=>[Ee(Q4,null,{default:qe(()=>[Ee(es,{dense:"",flat:"",round:"",icon:"menu",onClick:h}),Ee(G4,null,{default:qe(()=>[Ee(Sy,{square:""},{default:qe(()=>[B9]),_:1}),_r(" ChitChat ")]),_:1}),Ae(e)?(Ke(),vt(es,{key:0,color:"red",onClick:u},{default:qe(()=>[_r("Sign Out")]),_:1})):(Ke(),vt(es,{key:1,color:"red",onClick:m[0]||(m[0]=()=>Ae(a).push("/login"))},{default:qe(()=>[_r("Sign In")]),_:1}))]),_:1})]),_:1}),Ee(h9,{"show-if-above":"",modelValue:n.value,"onUpdate:modelValue":m[6]||(m[6]=g=>n.value=g),side:"left",behavior:"desktop",bordered:"",class:"bg-green-200"},{default:qe(()=>[o.value?(Ke(!0),mr(An,{key:0},WE(o.value,g=>(Ke(),vt(_9,{key:g.email,email:g.email},null,8,["email"]))),128)):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(Va,{key:1,type:"circle",height:"50px"})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(fu,{key:2})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(Va,{key:3,type:"circle",height:"50px"})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(fu,{key:4})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(Va,{key:5,type:"circle",height:"50px"})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(fu,{key:6})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(Va,{key:7,type:"circle",height:"50px"})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(fu,{key:8})):At("",!0),!c.value&&o.value.length==0&&!l.value?(Ke(),vt(Va,{key:9,type:"circle",height:"50px"})):At("",!0),l.value?(Ke(),mr("div",$9,[q9,pn("p",null,el(l.value),1)])):At("",!0),Ee(hH,{position:"bottom-right",offset:[18,18]},{default:qe(()=>[Ee(es,{fab:"",icon:"add",color:"positive",onClick:m[1]||(m[1]=g=>i.value=!0)})]),_:1}),Ee(s9,{modelValue:i.value,"onUpdate:modelValue":m[5]||(m[5]=g=>i.value=g),persistent:""},{default:qe(()=>[Ee(RH,{style:{"min-width":"350px"}},{default:qe(()=>[Ee(Sb,null,{default:qe(()=>[U9]),_:1}),Ee(Sb,{class:"q-pt-none"},{default:qe(()=>[Ee(QA,{dense:"",autofocus:"",modelValue:r.value,"onUpdate:modelValue":m[2]||(m[2]=g=>r.value=g),onKeyup:m[3]||(m[3]=lI(g=>i.value=!1,["enter"]))},null,8,["modelValue"])]),_:1}),Ee(AH,{align:"right",class:"text-primary"},{default:qe(()=>[Bo(Ee(es,{flat:"",label:"Cancel"},null,512),[[Gb]]),Bo(Ee(es,{flat:"",label:"Add",onClick:m[4]||(m[4]=g=>{d(r.value),f()})},null,512),[[Gb]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),Ee(d9,null,{default:qe(()=>[Ee(Ae(bA),{drawerOpen:n.value},null,8,["drawerOpen"])]),_:1})]),_:1}))}},z9={ratio:[String,Number]};function j9(t,e){return I(()=>{const n=Number(t.ratio||(e!==void 0?e.value:void 0));return isNaN(n)!==!0&&n>0?{paddingBottom:`${100/n}%`}:null})}const H9=16/9,K9=Ze({name:"QImg",props:{...z9,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:H9},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(t,{slots:e,emit:n}){const i=ae(t.initialRatio),r=j9(t,i);let s=null,o=!1;const a=[ae(null),ae(g())],l=ae(0),c=ae(!1),u=ae(!1),h=I(()=>`q-img q-img--${t.noNativeMenu===!0?"no-":""}menu`),d=I(()=>({width:t.width,height:t.height})),f=I(()=>`q-img__image ${t.imgClass!==void 0?t.imgClass+" ":""}q-img__image--with${t.noTransition===!0?"out":""}-transition`),p=I(()=>({...t.imgStyle,objectFit:t.fit,objectPosition:t.position}));ge(()=>m(),w);function m(){return t.src||t.srcset||t.sizes?{src:t.src,srcset:t.srcset,sizes:t.sizes}:null}function g(){return t.placeholderSrc!==void 0?{src:t.placeholderSrc}:null}function w(N){s!==null&&(clearTimeout(s),s=null),u.value=!1,N===null?(c.value=!1,a[l.value^1].value=g()):c.value=!0,a[l.value].value=N}function v({target:N}){o!==!0&&(s!==null&&(clearTimeout(s),s=null),i.value=N.naturalHeight===0?.5:N.naturalWidth/N.naturalHeight,b(N,1))}function b(N,S){o===!0||S===1e3||(N.complete===!0?E(N):s=setTimeout(()=>{s=null,b(N,S+1)},50))}function E(N){o!==!0&&(l.value=l.value^1,a[l.value].value=null,c.value=!1,u.value=!1,n("load",N.currentSrc||N.src))}function P(N){s!==null&&(clearTimeout(s),s=null),c.value=!1,u.value=!0,a[l.value].value=null,a[l.value^1].value=g(),n("error",N)}function C(N){const S=a[N].value,k={key:"img_"+N,class:f.value,style:p.value,crossorigin:t.crossorigin,decoding:t.decoding,referrerpolicy:t.referrerpolicy,height:t.height,width:t.width,loading:t.loading,fetchpriority:t.fetchpriority,"aria-hidden":"true",draggable:t.draggable,...S};return l.value===N?(k.class+=" q-img__image--waiting",Object.assign(k,{onLoad:v,onError:P})):k.class+=" q-img__image--loaded",M("div",{class:"q-img__container absolute-full",key:"img"+N},M("img",k))}function B(){return c.value!==!0?M("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Lt(e[u.value===!0?"error":"default"])):M("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},e.loading!==void 0?e.loading():t.noSpinner===!0?void 0:[M(Iy,{color:t.spinnerColor,size:t.spinnerSize})])}return w(m()),Xt(()=>{o=!0,s!==null&&(clearTimeout(s),s=null)}),()=>{const N=[];return r.value!==null&&N.push(M("div",{key:"filler",style:r.value})),u.value!==!0&&(a[0].value!==null&&N.push(C(0)),a[1].value!==null&&N.push(C(1))),N.push(M(Cs,{name:"q-transition--fade"},B)),M("div",{class:h.value,style:d.value,role:"img","aria-label":t.alt},N)}}}),W9="/assets/hero-1fcc0bd7.png",G9={},Q9=pn("div",{class:"bg-green-200 border-t border-b border-green-500 text-green-700 px-4 py-3",role:"alert"},[pn("p",{class:"font-bold"},"Tip:"),pn("p",{class:"text-sm"},"Open the Drawer on the left and tap plus sign to add friends")],-1);function Y9(t,e){return Ke(),mr(An,null,[Ee(K9,{src:W9,ratio:16/9}),Q9],64)}const X9=cA(G9,[["render",Y9]]),J9=Ze({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(t,{slots:e}){const n=I(()=>t.sent===!0?"sent":"received"),i=I(()=>`q-message-text-content q-message-text-content--${n.value}`+(t.textColor!==void 0?` text-${t.textColor}`:"")),r=I(()=>`q-message-text q-message-text--${n.value}`+(t.bgColor!==void 0?` text-${t.bgColor}`:"")),s=I(()=>"q-message-container row items-end no-wrap"+(t.sent===!0?" reverse":"")),o=I(()=>t.size!==void 0?`col-${t.size}`:""),a=I(()=>({msg:t.textHtml===!0?"innerHTML":"textContent",stamp:t.stampHtml===!0?"innerHTML":"textContent",name:t.nameHtml===!0?"innerHTML":"textContent",label:t.labelHtml===!0?"innerHTML":"textContent"}));function l(u){return e.stamp!==void 0?[u,M("div",{class:"q-message-stamp"},e.stamp())]:t.stamp?[u,M("div",{class:"q-message-stamp",[a.value.stamp]:t.stamp})]:[u]}function c(u,h){const d=h===!0?u.length>1?f=>f:f=>M("div",[f]):f=>M("div",{[a.value.msg]:f});return u.map((f,p)=>M("div",{key:p,class:r.value},[M("div",{class:i.value},l(d(f)))]))}return()=>{const u=[];e.avatar!==void 0?u.push(e.avatar()):t.avatar!==void 0&&u.push(M("img",{class:`q-message-avatar q-message-avatar--${n.value}`,src:t.avatar,"aria-hidden":"true"}));const h=[];e.name!==void 0?h.push(M("div",{class:`q-message-name q-message-name--${n.value}`},e.name())):t.name!==void 0&&h.push(M("div",{class:`q-message-name q-message-name--${n.value}`,[a.value.name]:t.name})),e.default!==void 0?h.push(c(F4(e.default()),!0)):t.text!==void 0&&h.push(c(t.text)),u.push(M("div",{class:o.value},h));const d=[];return e.label!==void 0?d.push(M("div",{class:"q-message-label"},e.label())):t.label!==void 0&&d.push(M("div",{class:"q-message-label",[a.value.label]:t.label})),d.push(M("div",{class:s.value},u)),M("div",{class:`q-message q-message-${n.value}`},d)}}}),Z9={xs:8,sm:10,md:14,lg:20,xl:24},eK=Ze({name:"QChip",props:{...to,...Qd,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(t,{slots:e,emit:n}){const{proxy:{$q:i}}=je(),r=no(t,i),s=Yd(t,Z9),o=I(()=>t.selected===!0||t.icon!==void 0),a=I(()=>t.selected===!0?t.iconSelected||i.iconSet.chip.selected:t.icon),l=I(()=>t.iconRemove||i.iconSet.chip.remove),c=I(()=>t.disable===!1&&(t.clickable===!0||t.selected!==null)),u=I(()=>{const g=t.outline===!0&&t.color||t.textColor;return"q-chip row inline no-wrap items-center"+(t.outline===!1&&t.color!==void 0?` bg-${t.color}`:"")+(g?` text-${g} q-chip--colored`:"")+(t.disable===!0?" disabled":"")+(t.dense===!0?" q-chip--dense":"")+(t.outline===!0?" q-chip--outline":"")+(t.selected===!0?" q-chip--selected":"")+(c.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(t.square===!0?" q-chip--square":"")+(r.value===!0?" q-chip--dark q-dark":"")}),h=I(()=>{const g=t.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:t.tabindex||0},w={...g,role:"button","aria-hidden":"false","aria-label":t.removeAriaLabel||i.lang.label.remove};return{chip:g,remove:w}});function d(g){g.keyCode===13&&f(g)}function f(g){t.disable||(n("update:selected",!t.selected),n("click",g))}function p(g){(g.keyCode===void 0||g.keyCode===13)&&(Rn(g),t.disable===!1&&(n("update:modelValue",!1),n("remove")))}function m(){const g=[];c.value===!0&&g.push(M("div",{class:"q-focus-helper"})),o.value===!0&&g.push(M(ki,{class:"q-chip__icon q-chip__icon--left",name:a.value}));const w=t.label!==void 0?[M("div",{class:"ellipsis"},[t.label])]:void 0;return g.push(M("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},IA(e.default,w))),t.iconRight&&g.push(M(ki,{class:"q-chip__icon q-chip__icon--right",name:t.iconRight})),t.removable===!0&&g.push(M(ki,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...h.value.remove,onClick:p,onKeyup:p})),g}return()=>{if(t.modelValue===!1)return;const g={class:u.value,style:s.value};return c.value===!0&&Object.assign(g,h.value.chip,{onClick:f,onKeyup:d}),Mm("div",g,m(),"ripple",t.ripple!==!1&&t.disable!==!0,()=>[[Ty,t.ripple]])}}});function fo(t,e,n,i){const r=[];return t.forEach(s=>{i(s)===!0?r.push(s):e.push({failedPropValidation:n,file:s})}),r}function bu(t){t&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),Rn(t)}const tK={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},nK=["rejected"];function iK({editable:t,dnd:e,getFileInput:n,addFilesToQueue:i}){const{props:r,emit:s,proxy:o}=je(),a=ae(null),l=I(()=>r.accept!==void 0?r.accept.split(",").map(v=>(v=v.trim(),v==="*"?"*/":(v.endsWith("/*")&&(v=v.slice(0,v.length-1)),v.toUpperCase()))):null),c=I(()=>parseInt(r.maxFiles,10)),u=I(()=>parseInt(r.maxTotalSize,10));function h(v){if(t.value)if(v!==Object(v)&&(v={target:null}),v.target!==null&&v.target.matches('input[type="file"]')===!0)v.clientX===0&&v.clientY===0&&Er(v);else{const b=n();b&&b!==v.target&&b.click(v)}}function d(v){t.value&&v&&i(null,v)}function f(v,b,E,P){let C=Array.from(b||v.target.files);const B=[],N=()=>{B.length!==0&&s("rejected",B)};if(r.accept!==void 0&&l.value.indexOf("*/")===-1&&(C=fo(C,B,"accept",S=>l.value.some(k=>S.type.toUpperCase().startsWith(k)||S.name.toUpperCase().endsWith(k))),C.length===0))return N();if(r.maxFileSize!==void 0){const S=parseInt(r.maxFileSize,10);if(C=fo(C,B,"max-file-size",k=>k.size<=S),C.length===0)return N()}if(r.multiple!==!0&&C.length!==0&&(C=[C[0]]),C.forEach(S=>{S.__key=S.webkitRelativePath+S.lastModified+S.name+S.size}),P===!0){const S=E.map(k=>k.__key);C=fo(C,B,"duplicate",k=>S.includes(k.__key)===!1)}if(C.length===0)return N();if(r.maxTotalSize!==void 0){let S=P===!0?E.reduce((k,V)=>k+V.size,0):0;if(C=fo(C,B,"max-total-size",k=>(S+=k.size,S<=u.value)),C.length===0)return N()}if(typeof r.filter=="function"){const S=r.filter(C);C=fo(C,B,"filter",k=>S.includes(k))}if(r.maxFiles!==void 0){let S=P===!0?E.length:0;if(C=fo(C,B,"max-files",()=>(S++,S<=c.value)),C.length===0)return N()}if(N(),C.length!==0)return C}function p(v){bu(v),e.value!==!0&&(e.value=!0)}function m(v){Rn(v),(v.relatedTarget!==null||Je.is.safari!==!0?v.relatedTarget!==a.value:document.elementsFromPoint(v.clientX,v.clientY).includes(a.value)===!1)===!0&&(e.value=!1)}function g(v){bu(v);const b=v.dataTransfer.files;b.length!==0&&i(null,b),e.value=!1}function w(v){if(e.value===!0)return M("div",{ref:a,class:`q-${v}__dnd absolute-full`,onDragenter:bu,onDragover:bu,onDragleave:m,onDrop:g})}return Object.assign(o,{pickFiles:h,addFiles:d}),{pickFiles:h,addFiles:d,onDragover:p,onDragleave:m,processFiles:f,getDndNode:w,maxFilesNumber:c,maxTotalSizeNumber:u}}const rK=Ze({name:"QFile",inheritAttrs:!1,props:{...UA,...KA,...tK,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...VA,...nK],setup(t,{slots:e,emit:n,attrs:i}){const{proxy:r}=je(),s=zA(),o=ae(null),a=ae(!1),l=WA(t),{pickFiles:c,onDragover:u,onDragleave:h,processFiles:d,getDndNode:f}=iK({editable:s.editable,dnd:a,getFileInput:R,addFilesToQueue:X}),p=GA(t),m=I(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),g=I(()=>ec(m.value)),w=I(()=>m.value.map(A=>A.name).join(", ")),v=I(()=>u9(m.value.reduce((A,Q)=>A+Q.size,0))),b=I(()=>({totalSize:v.value,filesNumber:m.value.length,maxFiles:t.maxFiles})),E=I(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:l.value,...i,id:s.targetUid.value,disabled:s.editable.value!==!0})),P=I(()=>"q-file q-field--auto-height"+(a.value===!0?" q-file--dnd":"")),C=I(()=>t.multiple===!0&&t.append===!0);function B(A){const Q=m.value.slice();Q.splice(A,1),S(Q)}function N(A){const Q=m.value.indexOf(A);Q>-1&&B(Q)}function S(A){n("update:modelValue",t.multiple===!0?A:A[0])}function k(A){A.keyCode===13&&Jn(A)}function V(A){(A.keyCode===13||A.keyCode===32)&&c(A)}function R(){return o.value}function X(A,Q){const Ce=d(A,Q,m.value,C.value),ye=R();ye!=null&&(ye.value=""),Ce!==void 0&&((t.multiple===!0?t.modelValue&&Ce.every(ke=>m.value.includes(ke)):t.modelValue===Ce[0])||S(C.value===!0?m.value.concat(Ce):Ce))}function $(){return[M("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function le(){if(e.file!==void 0)return m.value.length===0?$():m.value.map((Q,Ce)=>e.file({index:Ce,file:Q,ref:this}));if(e.selected!==void 0)return m.value.length===0?$():e.selected({files:m.value,ref:this});if(t.useChips===!0)return m.value.length===0?$():m.value.map((Q,Ce)=>M(eK,{key:"file-"+Ce,removable:s.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{B(Ce)}},()=>M("span",{class:"ellipsis",textContent:Q.name})));const A=t.displayValue!==void 0?t.displayValue:w.value;return A.length!==0?[M("div",{class:t.inputClass,style:t.inputStyle,textContent:A})]:$()}function ie(){const A={ref:o,...E.value,...p.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:X};return t.multiple===!0&&(A.multiple=!0),M("input",A)}return Object.assign(s,{fieldClass:P,emitValue:S,hasValue:g,inputRef:o,innerValue:m,floatingLabel:I(()=>g.value===!0||ec(t.displayValue)),computedCounter:I(()=>{if(t.counterLabel!==void 0)return t.counterLabel(b.value);const A=t.maxFiles;return`${m.value.length}${A!==void 0?" / "+A:""} (${v.value})`}),getControlChild:()=>f("file"),getControl:()=>{const A={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return s.editable.value===!0&&Object.assign(A,{onDragover:u,onDragleave:h,onKeydown:k,onKeyup:V}),M("div",A,[ie()].concat(le()))}}),Object.assign(r,{removeAtIndex:B,removeFile:N,getNativeElement:()=>o.value}),eo(r,"nativeEl",()=>o.value),jA(s)}}),sK={class:"h-[calc(100vh-145px)] overflow-scroll overflow-x-hidden"},oK={class:"q-pa-md row justify-center"},aK={style:{width:"100%"}},lK={key:0},cK={key:1},uK=["src"],hK=["src"],dK={__name:"ChatView",props:{drawerOpen:Boolean},setup(t){const e=t,n=ae(""),i=ae(""),s=Tg()._rawValue;let o=ae(""),a=ae([]),l,c;const u=w4(),h=async()=>{const p=xn(or,Lo("email","==",u.params.chat));o.value=(await zi(p)).docs[0].data(),l=(await zi(p)).docs[0].id,d()},d=async()=>{let p=mn(Xl,`${s.providerData[0].uid+l}`);(await Lc(p)).exists()||(p=mn(Xl,`${l+s.providerData[0].uid}`)),c=Us(p,"messages"),a.value=lA(Us(p,"messages"))};h();const f=async()=>{if(i.value==""){if(n.value=="")return;await Es(mn(c,`${Date.now()}`),{from:s.providerData[0].displayName,time:Lu(),message:n.value})}else{const p=Date.now().toString();await Wz(km(Y0,i.value.name+p),i.value);const m=await Gz(km(Y0,i.value.name+p));console.log(m),n.value!=""?await Es(mn(c,`${Date.now()}`),{from:s.providerData[0].displayName,time:Lu(),message:n.value,img:m}):await Es(mn(c,`${Date.now()}`),{from:s.providerData[0].displayName,time:Lu(),img:m})}n.value="",i.value=""};return ge(()=>u.path,p=>{h()},{flush:"pre",immediate:!0,deep:!0}),(p,m)=>(Ke(),mr("div",null,[pn("div",sK,[pn("div",oK,[pn("div",aK,[Ae(a).value?(Ke(!0),mr(An,{key:0},WE(Ae(a).value,g=>(Ke(),vt(J9,{name:g.from,avatar:g.from==Ae(s).providerData[0].displayName?Ae(s).providerData[0].photoURL:Ae(o).photoURL,sent:g.from==Ae(s).providerData[0].displayName,stamp:g.time?new Date(g.time.seconds*1e3).toLocaleString().split(",")[1]:"none"},{default:qe(()=>[g.message?(Ke(),mr("div",lK,el(g.message),1)):At("",!0),g.img?(Ke(),mr("div",cK,[pn("img",{src:g.img,alt:"Image"},null,8,uK)])):At("",!0)]),_:2},1032,["name","avatar","sent","stamp"]))),256)):At("",!0)])])]),pn("div",{class:Uh(["fixed-bottom w-full right-0 sm:mx-auto sm:w-[60%] flex flex-row",{"!ml-[40%]":e.drawerOpen}])},[Ee(rK,{outlined:"",modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=g=>i.value=g),class:"max-w-[300px]",label:"Attach image...",accept:".jpg, image/*",onRejected:m[1]||(m[1]=g=>p.alert("Only images are allowed!"))},{prepend:qe(()=>[Ee(ki,{name:"attach_file"})]),_:1},8,["modelValue"]),Ee(QA,{filled:"","bottom-slots":"",modelValue:n.value,"onUpdate:modelValue":m[4]||(m[4]=g=>n.value=g),label:"Label",counter:"",dense:!1,onKeyup:m[5]||(m[5]=lI(g=>f(),["enter"])),class:"w-full"},{before:qe(()=>[Ee(Sy,null,{default:qe(()=>[pn("img",{src:Ae(s).providerData[0].photoURL},null,8,hK)]),_:1})]),append:qe(()=>[n.value!==""?(Ke(),vt(ki,{key:0,name:"close",onClick:m[2]||(m[2]=g=>n.value=""),class:"cursor-pointer"})):At("",!0)]),hint:qe(()=>[_r(" Smile) ")]),after:qe(()=>[Ee(es,{round:"",dense:"",flat:"",icon:"send",onClick:m[3]||(m[3]=g=>f())})]),_:1},8,["modelValue"])],2)]))}},fK=v4({history:Pj("/"),routes:[{title:"Login Page",path:"/login",name:"Login",component:()=>gj(()=>import("./LoginView-e86f83c2.js"),[])},{path:"/",component:V9,children:[{title:"Home",path:"/",name:"home",props:{default:!0},component:X9},{title:"Chat",path:"/chat/:chat",name:"chat",props:{default:!0},component:dK}]}]}),Zd=(t,e)=>{const n=qn(t);for(const i in t)eo(e,i,()=>n[i],r=>{n[i]=r});return e},sp=["sm","md","lg","xl"],{passive:Zb}=Ht,pK=Zd({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:Fr,setDebounce:Fr,install({$q:t,onSSRHydrated:e}){if(t.screen=this,this.__installed===!0){t.config.screen!==void 0&&(t.config.screen.bodyClasses===!1?document.body.classList.remove(`screen--${this.name}`):this.__update(!0));return}const{visualViewport:n}=window,i=n||window,r=document.scrollingElement||document.documentElement,s=n===void 0||Je.is.mobile===!0?()=>[Math.max(window.innerWidth,r.clientWidth),Math.max(window.innerHeight,r.clientHeight)]:()=>[n.width*n.scale+window.innerWidth-r.clientWidth,n.height*n.scale+window.innerHeight-r.clientHeight],o=t.config.screen!==void 0&&t.config.screen.bodyClasses===!0;this.__update=h=>{const[d,f]=s();if(f!==this.height&&(this.height=f),d!==this.width)this.width=d;else if(h!==!0)return;let p=this.sizes;this.gt.xs=d>=p.sm,this.gt.sm=d>=p.md,this.gt.md=d>=p.lg,this.gt.lg=d>=p.xl,this.lt.sm=d<p.sm,this.lt.md=d<p.md,this.lt.lg=d<p.lg,this.lt.xl=d<p.xl,this.xs=this.lt.sm,this.sm=this.gt.xs===!0&&this.lt.md===!0,this.md=this.gt.sm===!0&&this.lt.lg===!0,this.lg=this.gt.md===!0&&this.lt.xl===!0,this.xl=this.gt.lg,p=this.xs===!0&&"xs"||this.sm===!0&&"sm"||this.md===!0&&"md"||this.lg===!0&&"lg"||"xl",p!==this.name&&(o===!0&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${p}`)),this.name=p)};let a,l={},c=16;this.setSizes=h=>{sp.forEach(d=>{h[d]!==void 0&&(l[d]=h[d])})},this.setDebounce=h=>{c=h};const u=()=>{const h=getComputedStyle(document.body);h.getPropertyValue("--q-size-sm")&&sp.forEach(d=>{this.sizes[d]=parseInt(h.getPropertyValue(`--q-size-${d}`),10)}),this.setSizes=d=>{sp.forEach(f=>{d[f]&&(this.sizes[f]=d[f])}),this.__update(!0)},this.setDebounce=d=>{a!==void 0&&i.removeEventListener("resize",a,Zb),a=d>0?$A(this.__update,d):this.__update,i.addEventListener("resize",a,Zb)},this.setDebounce(c),Object.keys(l).length!==0?(this.setSizes(l),l=void 0):this.__update(),o===!0&&this.name==="xs"&&document.body.classList.add("screen--xs")};Di.value===!0?e.push(u):u()}}),en=Zd({isActive:!1,mode:!1},{__media:void 0,set(t){en.mode=t,t==="auto"?(en.__media===void 0&&(en.__media=window.matchMedia("(prefers-color-scheme: dark)"),en.__updateMedia=()=>{en.set("auto")},en.__media.addListener(en.__updateMedia)),t=en.__media.matches):en.__media!==void 0&&(en.__media.removeListener(en.__updateMedia),en.__media=void 0),en.isActive=t===!0,document.body.classList.remove(`body--${t===!0?"light":"dark"}`),document.body.classList.add(`body--${t===!0?"dark":"light"}`)},toggle(){en.set(en.isActive===!1)},install({$q:t,onSSRHydrated:e,ssrContext:n}){const{dark:i}=t.config;if(t.dark=this,this.__installed===!0&&i===void 0)return;this.isActive=i===!0;const r=i!==void 0?i:!1;if(Di.value===!0){const s=a=>{this.__fromSSR=a},o=this.set;this.set=s,s(r),e.push(()=>{this.set=o,this.set(this.__fromSSR)})}else this.set(r)}}),eE={isoName:"en-US",nativeName:"English (US)",label:{clear:"Clear",ok:"OK",cancel:"Cancel",close:"Close",set:"Set",select:"Select",reset:"Reset",remove:"Remove",update:"Update",create:"Create",search:"Search",filter:"Filter",refresh:"Refresh",expand:t=>t?`Expand "${t}"`:"Expand",collapse:t=>t?`Collapse "${t}"`:"Collapse"},date:{days:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),daysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),firstDayOfWeek:0,format24h:!1,pluralDay:"days"},table:{noData:"No data available",noResults:"No matching records found",loading:"Loading...",selectedRecords:t=>t===1?"1 record selected.":(t===0?"No":t)+" records selected.",recordsPerPage:"Records per page:",allRows:"All",pagination:(t,e,n)=>t+"-"+e+" of "+n,columns:"Columns"},editor:{url:"URL",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",unorderedList:"Unordered List",orderedList:"Ordered List",subscript:"Subscript",superscript:"Superscript",hyperlink:"Hyperlink",toggleFullscreen:"Toggle Fullscreen",quote:"Quote",left:"Left align",center:"Center align",right:"Right align",justify:"Justify align",print:"Print",outdent:"Decrease indentation",indent:"Increase indentation",removeFormat:"Remove formatting",formatting:"Formatting",fontSize:"Font Size",align:"Align",hr:"Insert Horizontal Rule",undo:"Undo",redo:"Redo",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",paragraph:"Paragraph",code:"Code",size1:"Very small",size2:"A bit small",size3:"Normal",size4:"Medium-large",size5:"Big",size6:"Very big",size7:"Maximum",defaultFont:"Default Font",viewSource:"View Source"},tree:{noNodes:"No nodes available",noResults:"No matching nodes found"}};function tE(){const t=Array.isArray(navigator.languages)===!0&&navigator.languages.length!==0?navigator.languages[0]:navigator.language;if(typeof t=="string")return t.split(/[-_]/).map((e,n)=>n===0?e.toLowerCase():n>1||e.length<4?e.toUpperCase():e[0].toUpperCase()+e.slice(1).toLowerCase()).join("-")}const Qn=Zd({__langPack:{}},{getLocale:tE,set(t=eE,e){const n={...t,rtl:t.rtl===!0,getLocale:tE};{if(n.set=Qn.set,Qn.__langConfig===void 0||Qn.__langConfig.noHtmlAttrs!==!0){const i=document.documentElement;i.setAttribute("dir",n.rtl===!0?"rtl":"ltr"),i.setAttribute("lang",n.isoName)}Object.assign(Qn.__langPack,n),Qn.props=n,Qn.isoName=n.isoName,Qn.nativeName=n.nativeName}},install({$q:t,lang:e,ssrContext:n}){t.lang=Qn.__langPack,Qn.__langConfig=t.config.lang,this.__installed===!0?e!==void 0&&this.set(e):this.set(e||eE)}});function mK(t,e,n=document.body){if(typeof t!="string")throw new TypeError("Expected a string as propName");if(typeof e!="string")throw new TypeError("Expected a string as value");if(!(n instanceof Element))throw new TypeError("Expected a DOM element");n.style.setProperty(`--q-${t}`,e)}function mR(t){if(t.ios===!0)return"ios";if(t.android===!0)return"android"}function gK({is:t,has:e,within:n},i){const r=[t.desktop===!0?"desktop":"mobile",`${e.touch===!1?"no-":""}touch`];if(t.mobile===!0){const s=mR(t);s!==void 0&&r.push("platform-"+s)}if(t.nativeMobile===!0){const s=t.nativeMobileWrapper;r.push(s),r.push("native-mobile"),t.ios===!0&&(i[s]===void 0||i[s].iosStatusBarPadding!==!1)&&r.push("q-ios-padding")}else t.electron===!0?r.push("electron"):t.bex===!0&&r.push("bex");return n.iframe===!0&&r.push("within-iframe"),r}function vK(){const{is:t}=Je,e=document.body.className,n=new Set(e.replace(/ {2}/g," ").split(" "));if(Xd!==void 0)n.delete("desktop"),n.add("platform-ios"),n.add("mobile");else if(t.nativeMobile!==!0&&t.electron!==!0&&t.bex!==!0){if(t.desktop===!0)n.delete("mobile"),n.delete("platform-ios"),n.delete("platform-android"),n.add("desktop");else if(t.mobile===!0){n.delete("desktop"),n.add("mobile");const r=mR(t);r!==void 0?(n.add(`platform-${r}`),n.delete(`platform-${r==="ios"?"android":"ios"}`)):(n.delete("platform-ios"),n.delete("platform-android"))}}Je.has.touch===!0&&(n.delete("no-touch"),n.add("touch")),Je.within.iframe===!0&&n.add("within-iframe");const i=Array.from(n).join(" ");e!==i&&(document.body.className=i)}function yK(t){for(const e in t)mK(e,t[e])}const _K={install(t){if(this.__installed!==!0){if(Di.value===!0)vK();else{const{$q:e}=t;e.config.brand!==void 0&&yK(e.config.brand);const n=gK(Je,e.config);document.body.classList.add.apply(document.body.classList,n)}Je.is.ios===!0&&document.body.addEventListener("touchstart",Fr),window.addEventListener("keydown",P4,!0)}}},wK={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}},Lh=Zd({iconMapFn:null,__icons:{}},{set(t,e){const n={...t,rtl:t.rtl===!0};n.set=Lh.set,Object.assign(Lh.__icons,n)},install({$q:t,iconSet:e,ssrContext:n}){t.config.iconMapFn!==void 0&&(this.iconMapFn=t.config.iconMapFn),t.iconSet=this.__icons,eo(t,"iconMapFn",()=>this.iconMapFn,i=>{this.iconMapFn=i}),this.__installed===!0?e!==void 0&&this.set(e):this.set(e||wK)}});function nE(t){return t!==null&&typeof t=="object"&&Array.isArray(t)!==!0}const iE=[Oh,_K,en,pK,$m,Qn,Lh];function rE(t,e){e.forEach(n=>{n.install(t),n.__installed=!0})}function bK(t,e,n){t.config.globalProperties.$q=n.$q,t.provide(nH,n.$q),rE(n,iE),e.components!==void 0&&Object.values(e.components).forEach(i=>{nE(i)===!0&&i.name!==void 0&&t.component(i.name,i)}),e.directives!==void 0&&Object.values(e.directives).forEach(i=>{nE(i)===!0&&i.name!==void 0&&t.directive(i.name,i)}),e.plugins!==void 0&&rE(n,Object.values(e.plugins).filter(i=>typeof i.install=="function"&&iE.includes(i)===!1)),Di.value===!0&&(n.$q.onSSRHydrated=()=>{n.onSSRHydrated.forEach(i=>{i()}),n.$q.onSSRHydrated=()=>{}})}const EK=function(t,e={}){const n={version:"2.12.1"};nR===!1?(e.config!==void 0&&Object.assign(Mh,e.config),n.config={...Mh},FH()):n.config=e.config||{},bK(t,e,{parentApp:t,$q:n,lang:e.lang,iconSet:e.iconSet,onSSRHydrated:[]})},IK={version:"2.12.1",install:EK,lang:Qn,iconSet:Lh};const ef=qN(dj);ef.use(IK,{plugins:{}});ef.use(fK);ef.use(cj,{firebaseApp:_y,modules:[lj()]});ef.mount("#app");export{cr as G,es as Q,Ee as a,pn as b,mr as c,_r as d,pT as g,Ke as o,SK as s,_4 as u,qe as w};
